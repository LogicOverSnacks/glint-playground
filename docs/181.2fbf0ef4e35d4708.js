"use strict";(self.webpackChunkgit_glint=self.webpackChunkgit_glint||[]).push([[181],{98181:(Vt,k,l)=>{l.r(k),l.d(k,{BlameLayoutModule:()=>U});var N=l(43144),J=l(15671),E=l(84385),W=l(33179),q=l(51572),dt=l(37072),t=l(94650),F=(0,N.Z)(function d(){(0,J.Z)(this,d)});F.\u0275fac=function(p){return new(p||F)},F.\u0275mod=t.oAB({type:F}),F.\u0275inj=t.cJS({imports:[q.Cq,W.I,dt.m]});var Q=l(2367),Z=l(97685),gt=l(37762),_=l(60136),tt=l(18486),pt=l(70655),y=l(37340),K=l(24006),$=l(89867),z=l(67717),T=l(61135),C=l(39646),I=l(62843),nt=l(39841),H=l(4128),w=l(54004),R=l(70262),A=l(82722),D=l(71884),et=l(18505),V=l(63900),x=l(82270),ot=l(78926),it=l(9967),G=l(32120),j=l(36966),X=l(64889),vt=l(20790),ht=l(10127),ft=l(61672),lt=l(59549),Ct=l(3238),b=l(36895),Pt=l(4859),at=l(97392),st=l(10266),ct=l(53051),Mt=l(29131),Ot=l(3061),Y=l(4883),xt=l(4326),Zt=l(95698),yt=l(82771),Tt=l(10315),wt=l(53178),At=l(30744),ut=l(8329),rt=l(74442),Bt=l(81899),It=l(21453);function bt(d,p){1&d&&(t.TgZ(0,"div",7),t._UZ(1,"mat-spinner"),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&d&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"Loading..."),"\n"))}function Ft(d,p){if(1&d&&(t.TgZ(0,"span",13)(1,"span",14),t._uU(2),t.qZA(),t._UZ(3,"app-avatar",15),t.ALo(4,"async"),t.TgZ(5,"span",16),t._uU(6),t.qZA(),t.TgZ(7,"span",17),t._uU(8),t.ALo(9,"translateDate"),t.qZA()()),2&d){var i=p.ngIf,s=t.oxw(2),u=t.MAs(11);t.Udp("left",-s.lineNumberMargin-26-400,"px"),t.Q6J("appContextMenu",u)("appContextMenuData",i),t.xp6(1),t.Q6J("matTooltip",i.commitId),t.xp6(1),t.Oqu(i.commitId),t.xp6(1),t.Q6J("matTooltip",i.name+" ("+i.email+")")("remotes",t.lcZ(4,12,s.remotes))("email",i.email),t.xp6(2),t.Q6J("matTooltip",i.message),t.xp6(1),t.Oqu(i.message),t.xp6(2),t.Oqu(t.xi3(9,14,i.date,"mediumDate"))}}function Lt(d,p){if(1&d&&(t.TgZ(0,"span",19),t._uU(1),t.qZA()),2&d){var i=p.$implicit;t.Q6J("ngClass",i.class),t.xp6(1),t.Oqu(i.text)}}function Ut(d,p){if(1&d&&(t.ynx(0),t.YNc(1,Lt,2,2,"span",18),t.ALo(2,"tokens"),t.ALo(3,"searchToken"),t.ALo(4,"async"),t.BQk()),2&d){var i=p.ngIf,s=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,t.Dn7(3,4,i.tokens,i.text,t.lcZ(4,8,s.search)),i.text))}}function Nt(d,p){if(1&d&&(t.TgZ(0,"li",8),t.YNc(1,Ft,10,17,"span",9),t.ALo(2,"async"),t.TgZ(3,"span",10),t._uU(4),t.qZA(),t.TgZ(5,"span",11),t._uU(6),t.qZA(),t.YNc(7,Ut,5,10,"ng-container",12),t.qZA()),2&d){var u,i=p.$implicit,s=t.oxw();t.Q6J("ngClass","line-"+i.status),t.xp6(1),t.Q6J("ngIf",null==(u=t.lcZ(2,11,s.blameLines$))?null:u[null==i.newLine?null:i.newLine.lineNumber]),t.xp6(2),t.Udp("right","calc(100% + 26px + "+(s.lineNumberMargin/2).toString()+"px)")("width",s.lineNumberMargin/2-5,"px"),t.xp6(1),t.Oqu(null==i.oldLine?null:i.oldLine.lineNumber),t.xp6(1),t.Udp("width",s.lineNumberMargin/2-5,"px"),t.xp6(1),t.Oqu(null==i.newLine?null:i.newLine.lineNumber),t.xp6(1),t.Q6J("ngIf",s.getLineView(i))}}function Jt(d,p){if(1&d){var i=t.EpF();t.TgZ(0,"div",20)(1,"button",21),t.NdJ("click",function(){var n=t.CHM(i).data,e=t.oxw();return t.KtG(e.copyToClipboard(n.commitId))}),t.TgZ(2,"mat-icon"),t._uU(3,"content_copy"),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"button",21),t.NdJ("click",function(){var n=t.CHM(i).data,e=t.oxw();return t.KtG(e.selectCommit(n.commitId))}),t.TgZ(8,"mat-icon"),t._uU(9,"document_scanner"),t.qZA(),t.TgZ(10,"span"),t._uU(11),t.ALo(12,"translate"),t.qZA()(),t.TgZ(13,"button",21),t.NdJ("click",function(){var n=t.CHM(i).data,e=t.oxw();return t.KtG(e.jumpToCommit(n.commitId))}),t.TgZ(14,"mat-icon"),t._uU(15,"launch"),t.qZA(),t.TgZ(16,"span"),t._uU(17),t.ALo(18,"translate"),t.qZA()()()}if(2&d){var s=p.data;t.xp6(1),t.Q6J("matTooltip",s.commitId),t.xp6(4),t.Oqu(t.lcZ(6,6,"Copy Commit ID")),t.xp6(2),t.Q6J("matTooltip",s.commitId),t.xp6(4),t.Oqu(t.lcZ(12,8,"Blame from this Commit")),t.xp6(2),t.Q6J("matTooltip",s.commitId),t.xp6(4),t.Oqu(t.lcZ(18,10,"Jump to Commit"))}}var S=function(d){(0,_.Z)(i,d);var p=(0,tt.Z)(i);function i(s,u,o){var n;return(0,J.Z)(this,i),(n=p.call(this)).router=s,n.store=u,n.diffService=o,n.commitChanged=new t.vpe,n.lineNumberMargin=0,n.lines$=new T.X([]),n.blameLines$=new T.X({}),n}return(0,N.Z)(i,[{key:"ngOnInit",value:function(){var u=this;this.remotes=this.repository.pipe((0,w.U)(function(o){var n;return null!==(n=o?.remotes)&&void 0!==n?n:[]})),this.blame.pipe((0,A.R)(this.destroyed$)).subscribe(function(o){if(o){var n=o.hunks.map(function(e){return[e.startLineNo,{name:e.authorName,email:e.authorEmail,commitId:e.commitId,message:e.commitMessage,date:e.commitDate}]});u.blameLines$.next(Object.fromEntries(n))}else u.blameLines$.next({})}),this.diffLines.pipe((0,xt.g)(0),(0,A.R)(this.destroyed$)).subscribe(function(o){if(o){var n,e=null!==(n=Math.max(o.oldLines.length,o.newLines.length))&&void 0!==n?n:0;u.lineNumberMargin=u.diffService.calculateMargin(e.toString().length),u.diffService.calculateInlineLines(o.oldLines,o.newLines,o.hunks).pipe((0,A.R)(u.destroyed$)).subscribe(function(g){u.lines$.next(g)})}else u.lineNumberMargin=0,u.lines$.next([])})}},{key:"getLineView",value:function(u){var o;return"added"===u.status?u.newLine:"removed"===u.status?u.oldLine:"unchanged"===u.status?null!==(o=u.newLine)&&void 0!==o?o:u.oldLine:null}},{key:"trackByDiffLine",value:function(u,o){return u}},{key:"copyToClipboard",value:function(u){navigator.clipboard.writeText(u??"")}},{key:"selectCommit",value:function(u){this.commitChanged.next(u)}},{key:"jumpToCommit",value:function(u){var o=this;this.repository.pipe((0,Zt.q)(1),(0,A.R)(this.destroyed$)).subscribe(function(n){if(!n)throw new x.Ys;o.store.dispatch([new X.jQ(n.path,u),new X.BK(n.path,u)]).subscribe(function(){o.router.navigate(["/standard/default"])})})}}]),i}((0,ot.j)(it.A,yt.P));function Qt(d,p){if(1&d&&(t.TgZ(0,"span"),t._UZ(1,"app-avatar",9),t.ALo(2,"async"),t.TgZ(3,"span",10),t._uU(4),t.qZA()()),2&d){var i=p.ngIf,s=t.oxw();t.xp6(1),t.Q6J("matTooltip",i.name+" ("+i.email+")")("remotes",t.lcZ(2,4,s.remotes))("email",i.email),t.xp6(3),t.Oqu(i.message)}}function Rt(d,p){if(1&d&&(t.TgZ(0,"mat-option",11)(1,"div",12),t._UZ(2,"app-avatar",9),t.ALo(3,"async"),t.TgZ(4,"span",13),t._uU(5),t.qZA(),t.TgZ(6,"span",14),t._uU(7),t.ALo(8,"translateDate"),t.qZA()()()),2&d){var i=p.$implicit,s=t.oxw();t.Q6J("value",i.id),t.xp6(2),t.Q6J("matTooltip",i.name+" ("+i.email+")")("remotes",t.lcZ(3,7,s.remotes))("email",i.email),t.xp6(2),t.Q6J("matTooltip",i.message),t.xp6(1),t.Oqu(i.message),t.xp6(2),t.Oqu(t.xi3(8,9,i.date,"mediumDate"))}}S.\u0275fac=function(p){return new(p||S)(t.Y36(Q.F0),t.Y36($.yh),t.Y36(Tt.S))},S.\u0275cmp=t.Xpm({type:S,selectors:[["app-blame-view"]],viewQuery:function(p,i){var s;1&p&&t.Gf(Y.N7,5),2&p&&t.iGM(s=t.CRH())&&(i.viewports=s)},inputs:{repository:"repository",blame:"blame",diffLines:"diffLines",search:"search"},outputs:{commitChanged:"commitChanged"},features:[t.qOj],decls:12,vars:14,consts:[["class","loading",4,"ngIf"],[1,"viewport",3,"itemSize","maxBufferPx","minBufferPx"],["scrollContainer",""],["tabindex","0",1,"vs-code-theme"],["code",""],["class","line",3,"ngClass",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["contextMenu",""],[1,"loading"],[1,"line",3,"ngClass"],["class","blame",3,"left","appContextMenu","appContextMenuData",4,"ngIf"],[1,"old-line-number"],[1,"new-line-number"],[4,"ngIf"],[1,"blame",3,"appContextMenu","appContextMenuData"],[1,"commit-id",3,"matTooltip"],[3,"matTooltip","remotes","email"],[1,"message",3,"matTooltip"],[1,"date"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"menu-panel"],[1,"menu-item",3,"matTooltip","click"]],template:function(p,i){1&p&&(t.YNc(0,bt,4,3,"div",0),t.ALo(1,"nullEmpty"),t.ALo(2,"async"),t.TgZ(3,"cdk-virtual-scroll-viewport",1,2)(5,"code",3,4)(7,"ul"),t.YNc(8,Nt,8,13,"li",5),t.ALo(9,"async"),t.qZA()()(),t.YNc(10,Jt,19,12,"ng-template",null,6,t.W1O)),2&p&&(t.Q6J("ngIf",!t.lcZ(1,8,t.lcZ(2,10,i.lines$))),t.xp6(3),t.Q6J("itemSize",19)("maxBufferPx",1e3)("minBufferPx",200),t.xp6(4),t.Udp("margin-left",i.lineNumberMargin+26+400+10,"px"),t.xp6(1),t.Q6J("cdkVirtualForOf",t.lcZ(9,12,i.lines$))("cdkVirtualForTrackBy",i.trackByDiffLine))},dependencies:[q.Ou,Y.xd,Y.x0,Y.N7,b.mk,b.sg,b.O5,at.Hw,st.gM,ct.A,wt.l,b.Ov,At.x,ut.v,rt.X,Bt.y,It.U],styles:[".loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px;margin:20px;width:100px}code[_ngcontent-%COMP%]{display:block;white-space:pre}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .blame[_ngcontent-%COMP%]{position:absolute;width:400px;overflow:hidden;user-select:none;font-size:0;display:flex;justify-content:space-between;align-items:center;gap:5px}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .blame[_ngcontent-%COMP%]   app-avatar[_ngcontent-%COMP%]{width:16px;height:16px;flex:0 0 auto}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .blame[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%], code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .blame[_ngcontent-%COMP%]   .commit-id[_ngcontent-%COMP%], code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .blame[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .blame[_ngcontent-%COMP%]   .commit-id[_ngcontent-%COMP%]{flex:0 0 50px}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .blame[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{flex:1 1 auto}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .blame[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{flex:0 0 auto}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{position:absolute;text-align:right;user-select:none}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{right:calc(100% + 26px)}.viewport[_ngcontent-%COMP%]{height:100%;width:100%}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .blame[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .blame[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{color:#90a4ae}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{color:#858585}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .blame[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .blame[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{color:#90a4ae}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{color:#5e5e5e}"],changeDetection:0});var St=[{path:"",component:function(){var d=function(p){(0,_.Z)(s,p);var i=(0,tt.Z)(s);function s(u,o,n,e,g,m){var r;return(0,J.Z)(this,s),(r=i.call(this)).route=u,r.router=o,r.store=n,r.commitsApi=e,r.highlightApi=g,r.repositoriesApi=m,r.blame=new T.X(null),r.headBlame=new T.X(null),r.commits=new T.X([]),r.diffLines=new T.X(null),r.search$=new T.X(null),r.selectedCommitControl=new K.NI(null),r.selectedCommit=new T.X(null),r.selectedPath=new T.X(null),r.jumpToSelectedCommit=function(){var h=r.store.selectSnapshot(j.E.selectedRepositoryPath),v=r.selectedCommitControl.value;if(!h)throw new x.Ys;if(!v)throw new x.j8;r.store.dispatch([new X.jQ(h,v),new X.BK(h,v)]).subscribe(function(){r.router.navigate(["/standard/default"])})},r.close=function(){history.back()},r.getPatch=function(h,v,B,O){if("head"===B){var f="staged"===O?h.stagedChanges:"unstaged"===O?h.unstagedChanges:void 0;return null!=f&&f.find(function(a){return a.newFilePath===v})?("staged"===O?r.repositoriesApi.getStagedPatch(h.path,void 0,v):r.repositoriesApi.getUnstagedPatch(h.path,void 0,v)).pipe((0,w.U)(function(a){return{repositoryPath:h.path,patch:a,isUnstaged:"unstaged"===O}}),(0,R.K)(function(a){return x.vE.matches(a)?(0,I._)(function(){return new G.ZR(a)}):(0,I._)(function(){return a})})):(0,C.of)(null)}return"commit"!==O?(0,C.of)(null):r.commitsApi.getPatch(h.path,B,void 0,v).pipe((0,w.U)(function(a){return{repositoryPath:h.path,patch:a,isUnstaged:!1}}),(0,R.K)(function(a){return x.ik.matches(a)||x.vE.matches(a)?(0,I._)(function(){return new G.ZR(a)}):(0,I._)(function(){return a})}))},r}return(0,N.Z)(s,[{key:"ngOnInit",value:function(){var o=this;this.remotes=this.selectedRepository.pipe((0,w.U)(function(n){var e;return null!==(e=n?.remotes)&&void 0!==e?e:[]})),this.headBlame.pipe((0,w.U)(function(n){if(!n)return[];var m,e={},g=(0,gt.Z)(n.hunks);try{for(g.s();!(m=g.n()).done;){var r=m.value;e[r.commitId]||(e[r.commitId]={id:r.commitId,date:r.commitDate,email:r.authorEmail,name:r.authorName,message:r.commitMessage,path:r.path})}}catch(h){g.e(h)}finally{g.f()}return Object.values(e).sort(function(h,v){return v.date.getTime()-h.date.getTime()})}),(0,A.R)(this.destroyed$)).subscribe(function(n){var e;o.commits.next(n);var g=o.selectedCommitControl.value;o.selectedCommit.next(null!==(e=n.find(function(m){return m.id===g}))&&void 0!==e?e:null)}),this.selectedCommitControl.valueChanges.pipe((0,D.x)(),(0,A.R)(this.destroyed$)).subscribe(function(n){var e,g=null!==(e=o.commits.value.find(function(m){return m.id===n}))&&void 0!==e?e:null;g&&(o.selectedCommit.next(g),o.router.navigate([],{relativeTo:o.route,queryParams:{area:"commit","commit-id":n??"head",path:g.path}}))}),this.store.select(j.E.selectedRepository).pipe((0,A.R)(this.destroyed$)).subscribe(function(n){n||o.router.navigate(["/standard/open-repository"])}),(0,nt.a)([this.store.select(j.E.selectedRepository).pipe((0,D.x)(function(n,e){return n?.path===e?.path})),this.route.queryParamMap]).pipe((0,w.U)(function(n){var e=(0,Z.Z)(n,2),m=e[1];return{repository:e[0],area:m.get("area"),commitId:m.get("commit-id"),path:m.get("path")}}),(0,et.b)(function(n){var e=n.commitId,g=n.path;o.selectedCommitControl.setValue("head"===e?null:e,{emitEvent:!0}),o.selectedPath.next(g)}),(0,V.w)(function(n){var e=n.repository,g=n.path,m=n.commitId;return e&&g&&m?(0,H.D)([o.getPatch(e,g,m,n.area),o.repositoriesApi.blameFile(e.path,g,"head"===m?void 0:m)]):(0,C.of)(null)}),(0,D.x)(function(n,e){if(!n||!e)return!n&&!e;var g=(0,Z.Z)(n,2),m=g[0],r=g[1],h=(0,Z.Z)(e,2),v=h[0],B=h[1];return m&&v?!(m.repositoryPath!==v.repositoryPath||m.isUnstaged!==v.isUnstaged||m.patch.newFileId!==v.patch.newFileId||m.patch.newFileIsDir!==v.patch.newFileIsDir||m.patch.newFileIsSubmodule!==v.patch.newFileIsSubmodule||m.patch.newFilePath!==v.patch.newFilePath||m.patch.oldFileId!==v.patch.oldFileId||m.patch.oldFileIsDir!==v.patch.oldFileIsDir||m.patch.oldFileIsSubmodule!==v.patch.oldFileIsSubmodule||m.patch.oldFilePath!==v.patch.oldFilePath||m.patch.status!==v.patch.status||m.patch.hunks.length!==v.patch.hunks.length||(0,z.Z)(m.patch.hunks,v.patch.hunks).some(function(O){var f=(0,Z.Z)(O,2),c=f[0],a=f[1];return c?.lines.length!==a?.lines.length||c?.newStart!==a?.newStart||c?.oldStart!==a?.oldStart||c?.header!==a?.header||c&&a&&(0,z.Z)(c.lines,a.lines).some(function(Dt){var mt=(0,Z.Z)(Dt,2),P=mt[0],M=mt[1];return P?.content.length!==M?.content.length||P?.newLineNo!==M?.newLineNo||P?.oldLineNo!==M?.oldLineNo||P?.origin!==M?.origin||P?.content!==M?.content})})||(0,z.Z)(r.hunks,B.hunks).some(function(O){var f=(0,Z.Z)(O,2),c=f[0],a=f[1];return c?.startLineNo!==a?.startLineNo||c?.endLineNo!==a?.endLineNo||c?.authorName!==a?.authorName||c?.authorEmail!==a?.authorEmail||c?.commitId!==a?.commitId||c?.commitMessage!==a?.commitMessage||c?.commitDate!==a?.commitDate||c?.path!==a?.path})):!m&&!v}),(0,V.w)(function(n){return n&&n[0]?(0,H.D)(o.getLines(n[0].repositoryPath,n[0].patch,n[0].isUnstaged,!1)).pipe((0,R.K)(function(e){return x.OZ.matches(e)||x.hK.matches(e)?(0,C.of)(null):(0,I._)(function(){return e})}),(0,w.U)(function(e){return e?[n[0],n[1],e]:null})):(0,C.of)(null)}),(0,et.b)(function(n){if(n&&n[0]){var e=(0,Z.Z)(n,3),g=e[0],r=e[2];o.blame.next(e[1]),o.diffLines.next({hunks:g.patch.hunks,oldLines:r[0],newLines:r[1],oldFilePath:g.patch.oldFilePath,newFilePath:g.patch.newFilePath,highlighted:!1})}else o.blame.next(null),o.diffLines.next(null)}),(0,V.w)(function(n){return n&&n[0]?(0,H.D)(o.getLines(n[0].repositoryPath,n[0].patch,n[0].isUnstaged,!0)).pipe((0,R.K)(function(e){return x.OZ.matches(e)||x.hK.matches(e)?(0,C.of)(null):(0,I._)(function(){return e})}),(0,w.U)(function(e){return e?[n[0],e]:null})):(0,C.of)(null)}),(0,A.R)(this.destroyed$)).subscribe(function(n){if(n&&n[0]){var e=(0,Z.Z)(n,2),g=e[0],m=e[1];o.diffLines.next({hunks:g.patch.hunks,oldLines:m[0],newLines:m[1],oldFilePath:g.patch.oldFilePath,newFilePath:g.patch.newFilePath,highlighted:!1})}else o.blame.next(null),o.diffLines.next(null)}),(0,nt.a)([this.store.select(j.E.selectedRepository),this.route.queryParamMap.pipe((0,w.U)(function(n){return n.get("path")}),(0,D.x)())]).pipe((0,V.w)(function(n){var e=(0,Z.Z)(n,2),g=e[0],m=e[1];return g&&m?o.repositoriesApi.blameFile(g.path,m):(0,C.of)(null)}),(0,R.K)(function(){return(0,C.of)(null)}),(0,A.R)(this.destroyed$)).subscribe(function(n){n&&o.headBlame.next(n)})}},{key:"getLines",value:function(o,n,e,g){if(n.oldFileIsSubmodule||n.newFileIsSubmodule){var m,r,h,v,B,O,f=null===(m=n.hunks[0])||void 0===m?void 0:m.lines.find(function(a){return a.oldLineNo>0}),c=null===(r=n.hunks[0])||void 0===r?void 0:r.lines.find(function(a){return a.newLineNo>0});return[(0,C.of)([{lineNumber:1,text:null!==(h=f?.content)&&void 0!==h?h:"",tokens:[{startIndex:0,endIndex:null!==(v=f?.content.length)&&void 0!==v?v:0,scopes:["normal"]}]}]),(0,C.of)([{lineNumber:1,text:null!==(B=c?.content)&&void 0!==B?B:"",tokens:[{startIndex:0,endIndex:null!==(O=c?.content.length)&&void 0!==O?O:0,scopes:["normal"]}]}])]}return[n.oldFileId?this.highlightApi.getHighlightedFile(o,n.oldFileId,n.oldFilePath,g):(0,C.of)([]),e?this.highlightApi.getHighlightedFile(o,null,n.newFilePath,g):n.newFileId?this.highlightApi.getHighlightedFile(o,n.newFileId,n.newFilePath,g):(0,C.of)([])]}}]),s}((0,ot.j)(it.A));return d.\u0275fac=function(i){return new(i||d)(t.Y36(Q.gz),t.Y36(Q.F0),t.Y36($.yh),t.Y36(vt.T),t.Y36(ht.m),t.Y36(ft.a))},d.\u0275cmp=t.Xpm({type:d,selectors:[["ng-component"]],features:[t.qOj],decls:23,vars:20,consts:[[3,"searched"],[3,"path"],["type","button","mat-icon-button","",1,"jump-to-commit-button","app-icon-button-md",3,"matTooltip","click"],[1,"commit-selector"],["panelClass","commit-select-list",3,"formControl"],[4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["type","button","mat-icon-button","",1,"close-button","app-icon-button-md",3,"click"],[3,"repository","blame","diffLines","search","commitChanged"],[3,"matTooltip","remotes","email"],[1,"message"],[3,"value"],[1,"commit-select-option"],[1,"message",3,"matTooltip"],[1,"date"]],template:function(i,s){1&i&&(t.TgZ(0,"header")(1,"app-find-control",0),t.NdJ("searched",function(o){return s.search$.next(o)}),t.qZA(),t._UZ(2,"app-condensed-path",1),t.ALo(3,"async"),t.TgZ(4,"button",2),t.NdJ("click",function(){return s.jumpToSelectedCommit()}),t.ALo(5,"translate"),t.TgZ(6,"mat-icon"),t._uU(7,"launch"),t.qZA()(),t.TgZ(8,"mat-form-field",3)(9,"mat-label"),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"mat-select",4)(13,"mat-select-trigger"),t.YNc(14,Qt,5,6,"span",5),t.ALo(15,"async"),t.qZA(),t.YNc(16,Rt,9,12,"mat-option",6),t.ALo(17,"async"),t.qZA()(),t.TgZ(18,"button",7),t.NdJ("click",function(){return s.close()}),t.TgZ(19,"mat-icon"),t._uU(20,"close"),t.qZA()()(),t.TgZ(21,"main")(22,"app-blame-view",8),t.NdJ("commitChanged",function(o){return s.selectedCommitControl.setValue(o)}),t.qZA()()),2&i&&(t.xp6(2),t.Q6J("path",t.lcZ(3,10,s.selectedPath)),t.xp6(2),t.Q6J("matTooltip",t.lcZ(5,12,"Jump to the selected commit")),t.xp6(6),t.Oqu(t.lcZ(11,14,"Select Commit")),t.xp6(2),t.Q6J("formControl",s.selectedCommitControl),t.xp6(2),t.Q6J("ngIf",t.lcZ(15,16,s.selectedCommit)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(17,18,s.commits)),t.xp6(6),t.Q6J("repository",s.selectedRepository)("blame",s.blame)("diffLines",s.diffLines)("search",s.search$))},dependencies:[lt.KE,lt.hX,E.gD,E.$L,Ct.ey,b.sg,b.O5,K.JJ,K.oH,Pt.RK,at.Hw,st.gM,ct.A,Mt.j,Ot.T,S,b.Ov,ut.v,rt.X],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding-top:10px}header[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:baseline;justify-content:space-between;margin-bottom:5px;outline:none;padding:0 10px}header[_ngcontent-%COMP%]   app-condensed-path[_ngcontent-%COMP%]{flex:1 1 auto;min-width:200px}header[_ngcontent-%COMP%]   .commit-selector[_ngcontent-%COMP%]{width:500px;margin-right:12px}header[_ngcontent-%COMP%]   .commit-selector[_ngcontent-%COMP%]   mat-select-trigger[_ngcontent-%COMP%]   app-avatar[_ngcontent-%COMP%]{height:19px;vertical-align:middle;margin-right:5px}header[_ngcontent-%COMP%]   .jump-to-commit-button[_ngcontent-%COMP%], header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{top:-8px}main[_ngcontent-%COMP%]{flex:1 0 auto;outline:none;overflow-x:auto;overflow-y:auto}"],data:{animation:[(0,y.X$)("slideLeft",[(0,y.eR)(":enter",[(0,y.oB)({position:"absolute",top:0,left:0,transform:"translateX(100%)"}),(0,y.jt)("200ms",(0,y.oB)({transform:"translateX(0)"}))]),(0,y.eR)(":leave",[(0,y.oB)({position:"absolute",top:0,left:0,transform:"translateX(0)"}),(0,y.jt)("200ms",(0,y.oB)({transform:"translateX(100%)"}))])])]},changeDetection:0}),(0,pt.gn)([(0,$.Ph)(j.E.selectedRepository)],d.prototype,"selectedRepository",void 0),d}()}],L=(0,N.Z)(function d(){(0,J.Z)(this,d)});L.\u0275fac=function(p){return new(p||L)},L.\u0275mod=t.oAB({type:L}),L.\u0275inj=t.cJS({imports:[Q.Bz.forChild(St),Q.Bz]});var U=(0,N.Z)(function d(){(0,J.Z)(this,d)});U.\u0275fac=function(p){return new(p||U)},U.\u0275mod=t.oAB({type:U}),U.\u0275inj=t.cJS({imports:[E.LD,W.I,F,L]})}}]);