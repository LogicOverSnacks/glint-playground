"use strict";(self.webpackChunkgit_glint=self.webpackChunkgit_glint||[]).push([[995],{1995:(L,K,m)=>{m.d(K,{$:()=>ht});var E=m(655),V=m(9867),o=m(2843),Z=m(515),I=m(9646),v=m(262),w=m(3900),d=m(2435),p=m(2120),f=m(8523),e=m(4889),$=m(1129),O=m(9077),B=m(7274),N=m(1135),G=m(2722),H=m(8926),S=m(9967),t=m(4650),j=m(5219),y=m(6895),F=m(4859),W=m(7392),X=m(266),z=m(744);function k(u,g){1&u&&(t.ynx(0),t._uU(1,"Loading..."),t.BQk())}function q(u,g){1&u&&(t.TgZ(0,"div",5)(1,"mat-icon",6),t._uU(2,"warning"),t.qZA(),t._uU(3," There are changes to the working copy that will be lost. "),t.qZA())}function P(u,g){if(1&u&&(t.TgZ(0,"li",9),t._uU(1),t.qZA()),2&u){const l=g.$implicit;t.Q6J("matTooltip",l.id),t.xp6(1),t.AsE(" ",l.message," - ",l.id," ")}}function _(u,g){if(1&u&&(t.TgZ(0,"div",5)(1,"mat-icon",6),t._uU(2,"warning"),t.qZA(),t._uU(3," The following commits will no longer be reachable by any branch or tag and may be lost: "),t.TgZ(4,"ul",7),t.YNc(5,P,2,3,"li",8),t.ALo(6,"async"),t.qZA()()),2&u){const l=t.oxw(2);t.xp6(5),t.Q6J("ngForOf",t.lcZ(6,1,l.atRiskCommits))}}function tt(u,g){if(1&u&&(t.ynx(0),t.YNc(1,q,4,0,"div",4),t.ALo(2,"async"),t.YNc(3,_,7,3,"div",4),t.ALo(4,"nullEmpty"),t.ALo(5,"async"),t.BQk()),2&u){const l=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,l.workingCopyAtRisk)),t.xp6(2),t.Q6J("ngIf",t.lcZ(4,4,t.lcZ(5,6,l.atRiskCommits)))}}function et(u,g){1&u&&(t.TgZ(0,"button",10),t._uU(1,"Cancel"),t.qZA()),2&u&&t.Q6J("mat-dialog-close",void 0)}function nt(u,g){1&u&&(t.TgZ(0,"button",11),t._uU(1,"Confirm"),t.qZA()),2&u&&t.Q6J("mat-dialog-close",!0)}class T extends((0,H.j)(S.A)){constructor(g,l,r){super(),this.data=g,this.dialogRef=l,this.graphSharedService=r,this.loading=!0,this.atRiskCommits=new N.X([]),this.workingCopyAtRisk=new N.X(!1)}ngOnInit(){this.graphSharedService.getCommits().pipe((0,G.R)(this.destroyed$)).subscribe(g=>{const l=this.data.branchName.startsWith("refs/heads/")?this.data.branchName:`refs/heads/${this.data.branchName}`,r={...g},Q=Object.values(g).filter(A=>A.commit.references.length>0&&A.commit.references.some(n=>n!==l)).map(A=>A.id);r.head&&delete r.head;const b=this.data.toCommitId?[...Q,this.data.toCommitId]:Q;let U=0;for(;U<b.length;){const A=b[U],n=r[A];n&&(delete r[A],b.push(...n.commit.parentIds)),U++}const J=Object.values(r).map(A=>A.commit);this.atRiskCommits.next(J),this.loading&&0===J.length&&!this.workingCopyAtRisk.value?setTimeout(()=>this.dialogRef.close(!0),0):this.loading=!1})}static{this.\u0275fac=function(l){return new(l||T)(t.Y36(B.WI),t.Y36(B.so),t.Y36(j.p))}}static{this.\u0275cmp=t.Xpm({type:T,selectors:[["ng-component"]],features:[t.qOj],decls:8,vars:5,consts:[["mat-dialog-title",""],[4,"ngIf"],["type","button","mat-button","",3,"mat-dialog-close",4,"ngIf"],["type","button","mat-button","","color","warn",3,"mat-dialog-close",4,"ngIf"],["class","text-block",4,"ngIf"],[1,"text-block"],[1,"warning-icon"],[1,"commit-list"],[3,"matTooltip",4,"ngFor","ngForOf"],[3,"matTooltip"],["type","button","mat-button","",3,"mat-dialog-close"],["type","button","mat-button","","color","warn",3,"mat-dialog-close"]],template:function(l,r){1&l&&(t.TgZ(0,"div",0),t._uU(1),t.qZA(),t.TgZ(2,"mat-dialog-content"),t.YNc(3,k,2,0,"ng-container",1),t.YNc(4,tt,6,8,"ng-container",1),t.qZA(),t.TgZ(5,"mat-dialog-actions"),t.YNc(6,et,2,1,"button",2),t.YNc(7,nt,2,1,"button",3),t.qZA()),2&l&&(t.xp6(1),t.Oqu(r.data.title),t.xp6(2),t.Q6J("ngIf",r.loading),t.xp6(1),t.Q6J("ngIf",!r.loading),t.xp6(2),t.Q6J("ngIf",!r.loading),t.xp6(1),t.Q6J("ngIf",!r.loading))},dependencies:[B.ZT,B.uh,B.xY,B.H8,y.sg,y.O5,F.lW,W.Hw,X.gM,y.Ov,z.x],styles:[".text-block[_ngcontent-%COMP%]{margin-bottom:10px}.warning-icon[_ngcontent-%COMP%]{margin-right:5px}.commit-list[_ngcontent-%COMP%]{list-style:inside;padding-left:20px;margin-top:10px;overflow-x:hidden}.commit-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{height:26px;line-height:26px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-size:16px}"],changeDetection:0})}}var C=m(4006),D=m(9549),Y=m(284);class x{constructor(g){this.data=g,this.form=new C.cw({name:new C.NI(null,C.kI.required)})}static{this.\u0275fac=function(l){return new(l||x)(t.Y36(B.WI))}}static{this.\u0275cmp=t.Xpm({type:x,selectors:[["ng-component"]],decls:13,vars:5,consts:[["mat-dialog-title",""],[3,"formGroup"],["subscriptSizing","dynamic"],["type","text","matInput","","required","","formControlName","name"],["mat-button","",3,"mat-dialog-close"],["mat-flat-button","","type","submit","color","primary",3,"mat-dialog-close","disabled"]],template:function(l,r){1&l&&(t.TgZ(0,"div",0),t._uU(1),t.qZA(),t.TgZ(2,"form",1)(3,"mat-dialog-content")(4,"mat-form-field",2)(5,"mat-label"),t._uU(6,"Name"),t.qZA(),t._UZ(7,"input",3),t.qZA()(),t.TgZ(8,"mat-dialog-actions")(9,"button",4),t._uU(10,"Cancel"),t.qZA(),t.TgZ(11,"button",5),t._uU(12,"Save"),t.qZA()()()),2&l&&(t.xp6(1),t.hij("Create ",r.data.title,""),t.xp6(1),t.Q6J("formGroup",r.form),t.xp6(7),t.Q6J("mat-dialog-close",void 0),t.xp6(2),t.Q6J("mat-dialog-close",r.form.value)("disabled",r.form.invalid))},dependencies:[B.ZT,B.uh,B.xY,B.H8,D.KE,D.hX,Y.Nt,C._Y,C.Fj,C.JJ,C.JL,C.Q7,C.sg,C.u,F.lW],encapsulation:2,changeDetection:0})}}var st=m(7093);class M{constructor(g){this.data=g,this.form=new C.cw({name:new C.NI(this.data.name,{nonNullable:!0,validators:C.kI.required})})}static{this.\u0275fac=function(l){return new(l||M)(t.Y36(B.WI))}}static{this.\u0275cmp=t.Xpm({type:M,selectors:[["ng-component"]],decls:13,vars:5,consts:[["mat-dialog-title",""],[3,"formGroup"],["subscriptSizing","dynamic"],["type","text","matInput","","required","","formControlName","name"],["mat-button","",3,"mat-dialog-close"],["mat-flat-button","","type","submit","color","primary",3,"mat-dialog-close","disabled"]],template:function(l,r){1&l&&(t.TgZ(0,"div",0),t._uU(1),t.qZA(),t.TgZ(2,"form",1)(3,"mat-dialog-content")(4,"mat-form-field",2)(5,"mat-label"),t._uU(6,"Name"),t.qZA(),t._UZ(7,"input",3),t.qZA()(),t.TgZ(8,"mat-dialog-actions")(9,"button",4),t._uU(10,"Cancel"),t.qZA(),t.TgZ(11,"button",5),t._uU(12,"Save"),t.qZA()()()),2&l&&(t.xp6(1),t.hij("Rename ",r.data.title,""),t.xp6(1),t.Q6J("formGroup",r.form),t.xp6(7),t.Q6J("mat-dialog-close",void 0),t.xp6(2),t.Q6J("mat-dialog-close",r.form.value.name)("disabled",r.form.invalid))},dependencies:[B.ZT,B.uh,B.xY,B.H8,D.KE,D.hX,Y.Nt,C._Y,C.Fj,C.JJ,C.JL,C.Q7,C.sg,C.u,F.lW],encapsulation:2,changeDetection:0})}}var it=m(790),at=m(9160),ot=m(3983),ct=m(3058),mt=m(4614);let ht=(()=>{class u{constructor(l,r,Q,b,U,J,A){this.dialog=l,this.store=r,this.commitsApi=Q,this.remotesApi=b,this.mergesApi=U,this.repositoriesApi=J,this.submodulesApi=A,this.fetchFromRemote=(n,i,c=null)=>(c?this.remotesApi.fetch(n,c,i):this.remotesApi.fetchAll(n,i)).pipe((0,v.K)(a=>d.Ay.matches(a)||d.T0.matches(a)||d.OV.matches(a)?(0,o._)(()=>new p.ZR(a.message)):(0,o._)(()=>a)),(0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.references])))),this.push=(n,i,c,a,h=!1)=>(i?this.remotesApi.push(n,c,i,a,h):this.remotesApi.pushToAllRemotes(n,c,a,h)).pipe((0,v.K)(s=>d.Ay.matches(s)?(0,o._)(()=>new p.ZR(s.message)):d.a9.matches(s)?(0,o._)(()=>new p.ZR(s.message,s.isHtml)):d.T0.matches(s)?(0,o._)(()=>new p.ZR(s.message)):(0,o._)(()=>s)),(0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranchCommitId,e.nh.headCommitId,e.nh.references])))),this.pull=(n,i,c,a)=>this.fetchFromRemote(n,c,i).pipe((0,w.w)(()=>this.commitsApi.getBranchUpstreamCommitId(n,`refs/heads/${a}`)),(0,w.w)(h=>{if(h)return this.updateBranch(n,`refs/heads/${a}`,h);const s=new d.aK(a);return(0,o._)(()=>new p.ZR(s.message))})),this.checkoutBranch=(n,i)=>this.repositoriesApi.checkoutBranch(n,i).pipe((0,v.K)(c=>d.Nu.matches(c)?(0,o._)(()=>new p.ZR(c.message,c.isHtml)):(0,o._)(()=>c)),(0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.headCommitId,e.nh.references])))),this.checkoutRemoteBranch=(n,i,c,a,h)=>{const s=(/^refs\/remotes\/([^\/]+)\//.exec(c)??[])[1],R=c.replace(/^refs\/remotes\/[^\/]+\//,"");if(!s)throw new Error(`Reference '${c}' is not a remote branch`);if(!R)throw new Error("Cannot checkout branch when no branch is selected");return a?this.pull(n,s,i,R).pipe((0,w.w)(()=>this.checkoutBranch(n,a))):h?this.createBranchWithDetails(n,h,R,`${s}/${R}`,!0):Z.E},this.createBranch=(n,i,c=!0)=>this.dialog.open(x,{data:{title:"Branch"}}).afterClosed().pipe((0,w.w)(h=>h?this.repositoriesApi.createBranch(n,i,h.name).pipe((0,v.K)(s=>d.vV.matches(s)?(0,o._)(()=>new p.ZR(s.message)):(0,o._)(()=>s)),(0,w.w)(()=>c?this.repositoriesApi.checkoutBranch(n,h.name):Z.E),(0,v.K)(s=>d.Nu.matches(s)?Z.E:d.bG.matches(s)||d.OV.matches(s)?(0,o._)(()=>new p.ZR(s.message)):(0,o._)(()=>s)),(0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.headCommitId,e.nh.references])))):Z.E)),this.createBranchWithDetails=(n,i,c,a=null,h=!0)=>this.repositoriesApi.createBranch(n,i,c).pipe((0,v.K)(s=>d.vV.matches(s)?(0,o._)(()=>new p.ZR(s.message)):(0,o._)(()=>s)),(0,w.w)(()=>h?this.repositoriesApi.checkoutBranch(n,c):Z.E),(0,v.K)(s=>d.Nu.matches(s)?Z.E:(0,o._)(()=>s)),(0,w.w)(()=>a?this.repositoriesApi.setUpstreamBranch(n,c,a):Z.E),(0,v.K)(s=>d.bG.matches(s)||d.OV.matches(s)?(0,o._)(()=>new p.ZR(s.message)):(0,o._)(()=>s)),(0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.headCommitId,e.nh.references])))),this.createTag=(n,i,c="")=>this.dialog.open(x,{data:{title:"Tag"}}).afterClosed().pipe((0,w.w)(h=>h?this.repositoriesApi.createTag(n,i,h.name,c).pipe((0,v.K)(s=>d.OV.matches(s)?(0,o._)(()=>new p.ZR(s.message)):(0,o._)(()=>s)),(0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.references])))):Z.E)),this.renameBranch=(n,i)=>this.dialog.open(M,{data:{title:"Branch",name:i}}).afterClosed().pipe((0,w.w)(a=>a?this.repositoriesApi.renameBranch(n,i,`refs/heads/${a}`).pipe((0,v.K)(h=>d.bG.matches(h)||d.OV.matches(h)?(0,o._)(()=>new p.ZR(h.message)):(0,o._)(()=>h)),(0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.references])))):Z.E)),this.deleteBranch=(n,i)=>this.dialog.open(T,{data:{title:"Delete Branch",branchName:i,toCommitId:null}}).afterClosed().pipe((0,w.w)(a=>a?this.repositoriesApi.deleteBranch(n,i).pipe((0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.references])))):Z.E)),this.deleteTag=(n,i)=>this.repositoriesApi.deleteTag(n,i).pipe((0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.references])))),this.createMerge=(n,i,c,a)=>{const h=this.store.selectSnapshot(O.$.selectedProfile);return this.mergesApi.createMerge(n,c,a,h?.name??null,h?.email??null,`merge: ${i??c} into ${a}`).pipe((0,w.w)(s=>this.store.dispatch("string"==typeof s?new e.jQ(n,s):new e.hb(n,{fromId:s.fromCommitId,toId:s.toCommitId}))),(0,v.K)(s=>d.Nu.matches(s)?(0,o._)(()=>new p.ZR(s.message,s.isHtml)):(0,o._)(()=>s)),(0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranchCommitId,e.nh.headCommitId,e.nh.mergeHeads,e.nh.merges]))))},this.commitMerge=(n,i,c,a,h)=>{const s=this.store.selectSnapshot(O.$.selectedProfile);return this.mergesApi.commitMerge(n,i,c,h,s?.name??null,s?.email??null,a).pipe((0,w.w)(R=>this.store.dispatch(new e.jQ(n,R))),(0,v.K)(R=>d.Nu.matches(R)?(0,o._)(()=>new p.ZR(R.message,R.isHtml)):(0,o._)(()=>R)),(0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranchCommitId,e.nh.headCommitId,e.nh.mergeHeads,e.nh.merges,e.nh.references]))))},this.updateBranch=(n,i,c)=>this.dialog.open(T,{data:{title:"Move Branch",branchName:i,toCommitId:c}}).afterClosed().pipe((0,w.w)(h=>h?this.repositoriesApi.updateBranch(n,i,c).pipe((0,v.K)(s=>d.Nu.matches(s)?(0,o._)(()=>new p.ZR(s.message,s.isHtml)):(0,o._)(()=>s)),(0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.headCommitId,e.nh.references])))):Z.E)),this.setUpstreamBranch=(n,i,c)=>this.repositoriesApi.setUpstreamBranch(n,i,c).pipe((0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.currentBranchUpstreamBranch,e.nh.references])))),this.startEdit=(n,i)=>this.store.dispatch(new $.LF(n,i)),this.discardEdit=n=>this.commitsApi.discardCommitEditing(n),this.revertCommit=(n,i)=>{const c=this.store.selectSnapshot(O.$.selectedProfile);return this.commitsApi.revertCommit(n,i,c?.name??null,c?.email??null).pipe((0,w.w)(a=>this.store.dispatch(new e.jQ(n,a))),(0,v.K)(a=>d.fD.matches(a)?(0,o._)(()=>new p.ZR(a.message)):d.Nu.matches(a)?(0,o._)(()=>new p.ZR(a.message,a.isHtml)):(0,o._)(()=>a)),(0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranchCommitId,e.nh.headCommitId,e.nh.references]))))},this.undoHeadCommit=n=>this.commitsApi.undoHeadCommit(n).pipe((0,v.K)(i=>d.OV.matches(i)?(0,o._)(()=>new p.ZR(i.message)):(0,o._)(()=>i)),(0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranchCommitId,e.nh.headCommitId,e.nh.references,e.nh.stagedChanges,e.nh.submodules])))),this.addSubmodule=(n,i,c,a)=>this.submodulesApi.addSubmodule(n,i,c,a).pipe((0,v.K)(h=>d.vV.matches(h)?(0,o._)(()=>new p.ZR(h.message)):(0,o._)(()=>h)),(0,f.C)(h=>this.store.dispatch(new e.Vu(n,[e.nh.stagedChanges,e.nh.submodules,e.nh.unstagedChanges])).pipe((0,w.w)(()=>h?(0,I.of)(h):Z.E)))),this.editSubmodule=(n,i,c)=>this.submodulesApi.editSubmodule(n,i,c).pipe((0,v.K)(a=>d.vV.matches(a)?(0,o._)(()=>new p.ZR(a.message)):(0,o._)(()=>a)),(0,f.C)(a=>this.store.dispatch(new e.Vu(n,[e.nh.stagedChanges,e.nh.submodules,e.nh.unstagedChanges])).pipe((0,w.w)(()=>a?(0,I.of)(a):Z.E)))),this.addRemote=(n,i,c)=>this.remotesApi.addRemote(n,i,c).pipe((0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranchUpstreamBranch,e.nh.merges,e.nh.references,e.nh.remotes])))),this.deleteRemote=(n,i)=>this.remotesApi.deleteRemote(n,i).pipe((0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranchUpstreamBranch,e.nh.merges,e.nh.references,e.nh.remotes])))),this.updateRemoteUrl=(n,i,c)=>this.remotesApi.updateRemoteUrl(n,i,c).pipe((0,f.C)(()=>this.store.dispatch(new e.Vu(n,[e.nh.commits,e.nh.currentBranchUpstreamBranch,e.nh.merges,e.nh.references,e.nh.remotes]))))}static{this.\u0275fac=function(r){return new(r||u)(t.LFG(B.uw),t.LFG(V.yh),t.LFG(it.T),t.LFG(at.G),t.LFG(ot.Z),t.LFG(ct.a),t.LFG(mt.N))}}static{this.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac,providedIn:st.v})}}return(0,E.gn)([(0,V.Ph)(O.$.selectedProfile)],u.prototype,"selectedProfile",void 0),u})()},5219:(L,K,m)=>{m.d(K,{p:()=>o});var E=m(1135),V=m(4650);class o{constructor(){this.colorsByCommitId=new E.X({}),this.commitDetailsByCommitId=new E.X({})}getColors(){return this.colorsByCommitId.asObservable()}setColors(I){this.colorsByCommitId.next(I)}getCommits(){return this.commitDetailsByCommitId.asObservable()}setCommits(I){this.commitDetailsByCommitId.next(I)}static{this.\u0275fac=function(v){return new(v||o)}}static{this.\u0275prov=V.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}}}}]);