import{d as F,e as Me,f as Oe,g as Re}from"./chunk-EILJVLD3.js";import{a as xe,b as we}from"./chunk-XAEFNQ4I.js";import{D as v,d as Pe,h as ke,i as L}from"./chunk-XFRRWCWM.js";import{$ as X,$i as ye,Aa as T,Bb as ie,Fi as ue,G as j,Ga as J,Hb as ne,I as Q,Ia as S,Ib as oe,La as _,Li as Ce,Mb as ae,Na as B,P as W,Ph as he,Qg as ce,Rh as fe,S as z,T as E,Th as _e,Ua as l,Va as b,Wa as U,Zf as pe,_a as D,ab as y,bb as m,cd as se,da as q,dh as de,ea as G,gb as Y,hb as Z,hh as me,ia as g,ib as ee,ig as le,ih as ge,j as V,ja as h,jb as te,kb as u,lb as $,mg as N,n as I,s as O,sc as re,t as R,ub as c,vb as d,ya as K,yi as be,za as f}from"./chunk-LQ6WPIKI.js";function Se(r,w){r&1&&(l(0,"mat-icon",10),u(1,"folder"),b())}function Be(r,w){r&1&&U(0,"mat-spinner",11)}function De(r,w){if(r&1){let e=D();l(0,"a",5),c(1,"async"),c(2,"async"),c(3,"async"),y("mouseup",function(t){let o=g(e).$implicit,i=m();return h(i.tabClicked(t,o))})("dragstart",function(t){let o=g(e),i=o.$implicit,a=o.index,s=m();return h(s.dragstartListener(t,i,a))})("dragleave",function(){g(e);let t=m();return h(t.dragOverRepositoryIndex.next(null))})("dragover",function(t){let o=g(e).index,i=m();return h(i.dragoverListener(t,o))})("drop",function(t){let o=g(e).index,i=m();return h(i.dropListener(t,o))}),S(4,Se,2,0,"mat-icon",6)(5,Be,1,0,"mat-spinner",7),l(6,"span",8),u(7),b(),l(8,"mat-icon",9),y("click",function(){let t=g(e).$implicit,o=m();return h(o.closeRepository(t.path))}),u(9,"close"),b()()}if(r&2){let e=w.$implicit,n=w.index,t=m();B("border-left",d(1,11,t.hasLeftBorder(n)))("border-right",d(2,13,t.hasRightBorder(n))),_("matTooltip",e.path)("active",d(3,15,t.selectedRepositoryPath)===e.path),f(4),_("ngIf",e.loaded),f(),_("ngIf",!e.loaded),f(),B("disabled",!e.loaded),f(),$(e.name)}}function Ne(r,w){if(r&1){let e=D();l(0,"a",12),c(1,"translate"),c(2,"async"),y("mouseup",function(t){g(e);let o=m();return h(o.changelogClicked(t))}),l(3,"mat-icon",10),u(4,"auto_awesome"),b(),l(5,"span",8),u(6),c(7,"translate"),b(),l(8,"mat-icon",13),y("mouseup",function(t){g(e);let o=m();return h(o.closeChangelogClicked(t))}),u(9,"close"),b()()}if(r&2){let e=m();_("matTooltip",d(1,3,"See whats new! !release notes!"))("active",e.isChangelogUrl()&&d(2,5,e.selectedRepositoryPath)===null),f(6),$(d(7,7,"Release Notes"))}}var ot=(()=>{class r extends me(ge){documentKeydown(e){if(!e.isComposing&&(ue?e.metaKey:e.ctrlKey)&&!e.altKey&&!e.metaKey)switch(e.key){case"W":case"w":{if(!e.shiftKey){let n=this.store.selectSnapshot(v.selectedRepositoryPath);n&&this.closeRepository(n)}break}case"T":case"t":{e.shiftKey||this.openNewRepository();break}case"Tab":{let n=this.store.selectSnapshot(v.selectedRepositoryPath);this.visibleRepositories.pipe(j(1)).subscribe(t=>{let o=n?t.findIndex(a=>a.path===n):t.length;if(o<0)throw new se(n??"");let i=o+(e.shiftKey?-1:1);i>=t.length?i=0:i<0&&(i=t.length-1),this.changeRepository(t[i]?.path??null)});break}}}documentMouseDown(e){e.button===1&&e.preventDefault()}constructor(e,n,t,o){super(),this.cdr=e,this.router=n,this.store=t,this.updatesApiService=o,this.inkBarAnimationDisabled=new V(!1),this.dragRepositoryIndex=null,this.dragOverRepositoryIndex=new V(null),this.dragPosition=new V(null),this.dragstartListener=(i,a,s)=>{i.dataTransfer&&(i.dataTransfer.setData("app/repository",a.path),i.dataTransfer.setData("app/repository-tab",a.path),i.dataTransfer.effectAllowed="move",this.dragRepositoryIndex=s)},this.dragoverListener=(i,a)=>{if(i.dataTransfer&&i.dataTransfer.types.includes("app/repository")){i.preventDefault(),i.dataTransfer.dropEffect="move",this.dragOverRepositoryIndex.value!==a&&this.dragOverRepositoryIndex.next(a);let s=i.target;if(s.draggable){let p=this.getDragoverPosition(i.offsetX,s.clientWidth);this.dragPosition.value!==p&&this.dragPosition.next(p)}}},this.dropListener=(i,a)=>{if(i.dataTransfer&&i.dataTransfer.types.includes("app/repository-tab")){this.dragOverRepositoryIndex.value!==a&&this.dragOverRepositoryIndex.next(a);let s=i.target;if(s.draggable){let p=this.getDragoverPosition(i.offsetX,s.clientWidth);this.dragPosition.value!==p&&this.dragPosition.next(p)}i.preventDefault(),R([this.openOrLoadingRepositories,this.visibleRepositories]).pipe(E(this.destroyed$),j(1)).subscribe(([p,M])=>{let P=a+(this.dragPosition.value==="right"?1:0);if(this.dragRepositoryIndex!==null&&P>=0){let Te=M[this.dragRepositoryIndex]?.path,H=M[P]?.path,k=p.findIndex(C=>C.path===Te),x=H?p.findIndex(C=>C.path===H):p.length,ve=k>x?[...p.slice(0,x),p[k],...p.filter((C,A)=>A!==k).slice(x)]:k<x?[...p.slice(0,x).filter((C,A)=>A!==k),p[k],...p.slice(x)]:p;this.inkBarAnimationDisabled.next(!0);let Ve=ve.map(C=>C?.path).filter(ce);this.store.dispatch(new ke(Ve)).pipe(Q(250)).subscribe(()=>this.inkBarAnimationDisabled.next(!1))}})}this.dragRepositoryIndex=null,this.dragOverRepositoryIndex.next(null),this.dragPosition.next(null)},this.hasLeftBorder=i=>R([this.dragOverRepositoryIndex,this.dragPosition]).pipe(O(([a,s])=>a===i&&s==="left"||a===i-1&&s==="right")),this.hasRightBorder=i=>R([this.dragOverRepositoryIndex,this.dragPosition]).pipe(O(([a,s])=>a===i&&s==="right"||a===i+1&&s==="left")),this.getDragoverPosition=(i,a)=>i/a<.5?"left":"right"}ngOnInit(){this.visibleRepositories=R([this.openOrLoadingRepositories,this.profile]).pipe(O(([e,n])=>n&&n.allowedRepositories!=="all"?e.filter(t=>n.allowedRepositories.includes(t.path)):e),E(this.destroyed$),W(1)),this.hasUnreadChangelog=this.store.select(fe.changelogReadUpto).pipe(z(e=>this.updatesApiService.getVersion().pipe(O(n=>{if(!e)return!1;let[t,o,i]=n.replace(/-.*$/,"").split(".").map(P=>+P),[a,s,p]=e.replace(/-.*$/,"").split(".").map(P=>+P),M=t===void 0||o===void 0||a===void 0||s===void 0||a<t||s<o;return M&&this.openChangelog(),M}))))}ngAfterViewInit(){setTimeout(()=>{this.matTabNav._alignInkBarToSelectedTab(),this.cdr.markForCheck()},100),setTimeout(()=>{this.matTabNav._alignInkBarToSelectedTab(),this.cdr.markForCheck()},1e3)}trackRepository(e,n){return n.path}tabClicked(e,n){switch(e.button){case 0:n.loaded&&this.changeRepository(n.path);break;case 1:this.closeRepository(n.path);break}}changeRepository(e){this.store.dispatch(new L(e)).subscribe(()=>{this.router.navigate(["/standard/default"])})}closeRepository(e){this.store.dispatch(new Pe(e))}isChangelogUrl(){return this.router.url==="/standard/changelog"}changelogClicked(e){switch(e.button){case 0:this.openChangelog();break;case 1:this.closeChangelog();break}}closeChangelogClicked(e){e.button===0&&(this.closeChangelog(),e.preventDefault(),e.stopPropagation())}openChangelog(){this.store.dispatch(new L(null)).subscribe(()=>{this.router.navigate(["/standard/changelog"])})}closeChangelog(){this.updatesApiService.getVersion().subscribe(e=>{this.store.dispatch(new he(e)).subscribe(()=>{this.router.navigate(["/standard/default"])})})}openNewRepository(){this.store.dispatch(new L(null)).subscribe(()=>{this.router.navigate(["/standard/open-repository"])})}static{this.\u0275fac=function(n){return new(n||r)(T(ie),T(re),T(le),T(de))}}static{this.\u0275cmp=q({type:r,selectors:[["app-repository-tabs-view"]],viewQuery:function(n,t){if(n&1&&Y(F,5),n&2){let o;Z(o=ee())&&(t.matTabNav=o.first)}},hostBindings:function(n,t){n&1&&y("keydown",function(i){return t.documentKeydown(i)},!1,K)("mousedown",function(i){return t.documentMouseDown(i)},!1,K)},features:[J],decls:13,vars:20,consts:[["tabPanel",""],["mat-tab-nav-bar","",3,"tabPanel","mat-stretch-tabs","disablePagination"],["mat-tab-link","","draggable","true",3,"border-left","border-right","matTooltip","active","mouseup","dragstart","dragleave","dragover","drop",4,"ngFor","ngForOf","ngForTrackBy"],["mat-tab-link","","class","changelog-link",3,"matTooltip","active","mouseup",4,"ngIf"],["mat-tab-link","",1,"new-tab-link",3,"click","matTooltip","active"],["mat-tab-link","","draggable","true",3,"mouseup","dragstart","dragleave","dragover","drop","matTooltip","active"],["class","prefix",4,"ngIf"],["class","prefix disabled","diameter","18",4,"ngIf"],[1,"name"],["draggable","false",1,"suffix",3,"click"],[1,"prefix"],["diameter","18",1,"prefix","disabled"],["mat-tab-link","",1,"changelog-link",3,"mouseup","matTooltip","active"],[1,"suffix",3,"mouseup"]],template:function(n,t){if(n&1){let o=D();l(0,"nav",1),c(1,"async"),S(2,De,10,17,"a",2),c(3,"async"),S(4,Ne,10,9,"a",3),c(5,"async"),l(6,"a",4),c(7,"translate"),c(8,"async"),y("click",function(){return g(o),h(t.openNewRepository())}),l(9,"mat-icon"),u(10,"add"),b()()(),U(11,"mat-tab-nav-panel",null,0)}if(n&2){let o=te(12);B("ink-bar-animation-disabled",d(1,10,t.inkBarAnimationDisabled)),_("tabPanel",o)("mat-stretch-tabs",!1)("disablePagination",!0),f(2),_("ngForOf",d(3,12,t.visibleRepositories))("ngForTrackBy",t.trackRepository),f(2),_("ngIf",t.isChangelogUrl()||d(5,14,t.hasUnreadChangelog)),f(2),_("matTooltip",d(7,16,"Open a new repository"))("active",!t.isChangelogUrl()&&d(8,18,t.selectedRepositoryPath)===null)}},dependencies:[ne,oe,be,pe,xe,F,Oe,Me,ae,Ce],styles:['nav.ink-bar-animation-disabled[_ngcontent-%COMP%]     .mat-ink-bar{transition:none!important}.mat-mdc-tab-link[_ngcontent-%COMP%]{position:relative;padding:0 18px;min-width:120px}.mat-mdc-tab-link[_ngcontent-%COMP%]     .mdc-tab__content{pointer-events:initial}.mat-mdc-tab-link[_ngcontent-%COMP%]:before, .mat-mdc-tab-link[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;height:100%;width:1px;margin:0;padding:0;border:none;background-color:transparent;top:0}.mat-mdc-tab-link[_ngcontent-%COMP%]:before{left:0}.mat-mdc-tab-link[_ngcontent-%COMP%]:after{right:0}.mat-mdc-tab-link[_ngcontent-%COMP%]:first-child:before{width:2px}.mat-mdc-tab-link[_ngcontent-%COMP%]:nth-last-child(2):after{width:2px}.mat-mdc-tab-link[_ngcontent-%COMP%]   .prefix[_ngcontent-%COMP%]{margin-right:10px}.mat-mdc-tab-link[_ngcontent-%COMP%]   .prefix[_ngcontent-%COMP%], .mat-mdc-tab-link[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{pointer-events:none}.mat-mdc-tab-link[_ngcontent-%COMP%]   .suffix[_ngcontent-%COMP%]{margin-left:5px;z-index:1}.mat-mdc-tab-link[_ngcontent-%COMP%]   .prefix[_ngcontent-%COMP%], .mat-mdc-tab-link[_ngcontent-%COMP%]   .suffix[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem}.new-tab-link[_ngcontent-%COMP%]{min-width:48px}.dark-theme[_nghost-%COMP%]   .mat-mdc-tab-link.border-left[_ngcontent-%COMP%]:before, .dark-theme   [_nghost-%COMP%]   .mat-mdc-tab-link.border-left[_ngcontent-%COMP%]:before{background-color:#78909c}.dark-theme[_nghost-%COMP%]   .mat-mdc-tab-link.border-right[_ngcontent-%COMP%]:after, .dark-theme   [_nghost-%COMP%]   .mat-mdc-tab-link.border-right[_ngcontent-%COMP%]:after{background-color:#78909c}.dark-theme[_nghost-%COMP%]   .mat-mdc-tab-link[_ngcontent-%COMP%]   .prefix.disabled[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .mat-mdc-tab-link[_ngcontent-%COMP%]   .prefix.disabled[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   .mat-mdc-tab-link[_ngcontent-%COMP%]   .name.disabled[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .mat-mdc-tab-link[_ngcontent-%COMP%]   .name.disabled[_ngcontent-%COMP%]{color:#ffffff80}.light-theme[_nghost-%COMP%]   .mat-mdc-tab-link.border-left[_ngcontent-%COMP%]:before, .light-theme   [_nghost-%COMP%]   .mat-mdc-tab-link.border-left[_ngcontent-%COMP%]:before{background-color:#78909c}.light-theme[_nghost-%COMP%]   .mat-mdc-tab-link.border-right[_ngcontent-%COMP%]:after, .light-theme   [_nghost-%COMP%]   .mat-mdc-tab-link.border-right[_ngcontent-%COMP%]:after{background-color:#78909c}.light-theme[_nghost-%COMP%]   .mat-mdc-tab-link[_ngcontent-%COMP%]   .prefix.disabled[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .mat-mdc-tab-link[_ngcontent-%COMP%]   .prefix.disabled[_ngcontent-%COMP%], .light-theme[_nghost-%COMP%]   .mat-mdc-tab-link[_ngcontent-%COMP%]   .name.disabled[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   .mat-mdc-tab-link[_ngcontent-%COMP%]   .name.disabled[_ngcontent-%COMP%]{color:#00000061}'],changeDetection:0})}}return I([N(v.selectedRepositoryPath)],r.prototype,"selectedRepositoryPath",void 0),I([N(v.openOrLoadingRepositories)],r.prototype,"openOrLoadingRepositories",void 0),I([N(_e.selectedProfile)],r.prototype,"profile",void 0),r})();var lt=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=G({type:r})}static{this.\u0275inj=X({imports:[ye,we,Re]})}}return r})();export{ot as a,lt as b};
