"use strict";(self.webpackChunkgit_glint=self.webpackChunkgit_glint||[]).push([[1839],{51839:(oe,E,s)=>{s.r(E),s.d(E,{RebaseLayoutModule:()=>te});var W=s(42663),G=s(16400),Y=s(1869),tt=s(76769),et=s(85918),nt=s(61913),_=s(15304),N=s(28167),H=s(10138),ot=s(83530),t=s(83668);let it=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[Y.I,_.Is,N.lN,H.c,ot.Tx]]}),o})();var ct=s(327),D=s(31818),$=s(61855),P=s(69814),Z=s(52324),M=s(37810),O=s(40452),at=s(82429),p=s(7060),B=s(41510),V=s(98771),A=s(35634),k=s(62879),R=s(53542),st=s(1653),rt=s(80032),Q=s(42155),I=s(95332),x=s(43334),u=s(63303),C=s(50439),F=s(67254),f=s(66196),lt=s(83664),L=s(44496),mt=s(20373),w=s(49133),q=s(90086);let S=(()=>{class o{constructor(e){this.data=e,this.form=new L.CN({message:new L.rV(this.data.message??null,mt.Y$.required)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["ng-component"]],decls:13,vars:4,consts:[["mat-dialog-title",""],[3,"formGroup"],["matInput","","required","","formControlName","message"],["mat-button","",3,"mat-dialog-close"],["mat-flat-button","","type","submit","color","primary",3,"mat-dialog-close","disabled"]],template:function(e,n){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Edit Message"),t.qZA(),t.TgZ(2,"form",1),t.TgZ(3,"mat-dialog-content"),t.TgZ(4,"mat-form-field"),t.TgZ(5,"mat-label"),t._uU(6,"Message"),t.qZA(),t._UZ(7,"textarea",2),t.qZA(),t.qZA(),t.TgZ(8,"mat-dialog-actions"),t.TgZ(9,"button",3),t._uU(10,"Cancel"),t.qZA(),t.TgZ(11,"button",4),t._uU(12,"Save"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("formGroup",n.form.ng),t.xp6(7),t.Q6J("mat-dialog-close",void 0),t.xp6(2),t.Q6J("mat-dialog-close",n.form.value)("disabled",n.form.invalid))},directives:[_.uh,w._Y,w.JL,w.sg,_.xY,N.KE,N.hX,H.Nt,w.Fj,w.Q7,w.JJ,w.u,_.H8,q.lW,_.ZT],styles:["mat-dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}","mat-form-field[_ngcontent-%COMP%]{width:400px}","textarea[_ngcontent-%COMP%]{min-height:100px}"],changeDetection:0}),o})();var y=s(59112);let gt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["ng-component"]],decls:12,vars:2,consts:[["mat-dialog-title",""],[1,"text-block"],[1,"warning-icon"],["mat-button","",3,"mat-dialog-close"],["mat-button","","color","warn",3,"mat-dialog-close"]],template:function(e,n){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Overwrite Commits"),t.qZA(),t.TgZ(2,"mat-dialog-content"),t.TgZ(3,"div",1),t.TgZ(4,"mat-icon",2),t._uU(5,"warning"),t.qZA(),t._uU(6," The original commits will be lost. Overwrite the commits that have been edited? "),t.qZA(),t.qZA(),t.TgZ(7,"mat-dialog-actions"),t.TgZ(8,"button",3),t._uU(9,"Cancel"),t.qZA(),t.TgZ(10,"button",4),t._uU(11,"Confirm"),t.qZA(),t.qZA()),2&e&&(t.xp6(8),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.Q6J("mat-dialog-close",!0))},directives:[_.uh,_.xY,y.Hw,_.H8,q.lW,_.ZT],styles:[".text-block[_ngcontent-%COMP%]{margin-bottom:10px}",".warning-icon[_ngcontent-%COMP%]{margin-right:5px}"],changeDetection:0}),o})();var J=s(83052),v=s(35956),h=s(86019);let pt=(()=>{class o extends((0,k.j)(R.A)){constructor(e,n,i,a){super(),this.router=e,this.dialog=n,this.store=i,this.commitsApi=a,this.changeCommit=new t.vpe,this.editMessage=()=>{(0,O.aj)([this.repository,this.selectedCommit]).pipe((0,u.q)(1),(0,C.h)(f.Ej),(0,p.w)(([r,l])=>this.dialog.open(S,{data:{message:l?.message}}).afterClosed().pipe((0,C.h)(f.$K),(0,p.w)(({message:b})=>this.commitsApi.editCommitDetails(r.path,l.id,b))))).subscribe(r=>{this.changeCommit.next(r)})},this.squash=r=>{(0,O.aj)([this.repository,this.selectedCommit]).pipe((0,u.q)(1),(0,C.h)(f.Ej),(0,p.w)(([l,b])=>this.commitsApi.squashCommit(l.path,b.id,r)),(0,F.K)(l=>J.B.matches(l)?this.store.dispatch(new v.NN("error",l.message)).pipe((0,p.w)(()=>(0,x._)(l))):this.store.dispatch(new v.NN("unhandled",`${l}`)).pipe((0,p.w)(()=>(0,x._)(l))))).subscribe(l=>{this.changeCommit.next(l)})},this.insert=r=>{(0,O.aj)([this.repository,this.selectedCommit]).pipe((0,u.q)(1),(0,C.h)(f.Ej),(0,p.w)(([l,b])=>this.commitsApi.insertCommit(l.path,b.id,r)),(0,F.K)(l=>J.B.matches(l)?this.store.dispatch(new v.NN("error",l.message)).pipe((0,p.w)(()=>(0,x._)(l))):this.store.dispatch(new v.NN("unhandled",`${l}`)).pipe((0,p.w)(()=>(0,x._)(l))))).subscribe(l=>{this.changeCommit.next(l)})},this.complete=()=>{this.repository.pipe((0,u.q)(1),(0,C.h)(f.$K),(0,p.w)(r=>this.dialog.open(gt).afterClosed().pipe((0,C.h)(l=>!!l),(0,p.w)(()=>this.commitsApi.completeCommitEditing(r.path)),(0,p.w)(()=>this.store.dispatch(new lt.Vu(r.path)))))).subscribe(()=>this.router.navigate(["/standard/default"]))},this.discard=()=>{this.repository.pipe((0,u.q)(1),(0,C.h)(f.$K),(0,p.w)(r=>this.commitsApi.discardCommitEditing(r.path))).subscribe(()=>this.router.navigate(["/standard/default"]))}}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(D.F0),t.Y36(_.uw),t.Y36(Z.yh),t.Y36(I.T))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-rebase-action-view"]],inputs:{repository:"repository",selectedCommit:"selectedCommit",selectedCommitHasChild:"selectedCommitHasChild",selectedCommitHasParent:"selectedCommitHasParent"},outputs:{changeCommit:"changeCommit"},features:[t.qOj],decls:30,vars:15,consts:[[1,"items","items-left"],["title","Currently editing commits",1,"title"],[1,"items"],["type","button","mat-stroked-button","","title","Edit commit message",1,"item",3,"disabled","click"],[1,"edit-icon"],["type","button","mat-stroked-button","","title","Squash this commit into the next one",1,"item",3,"disabled","click"],["type","button","mat-stroked-button","","title","Squash this commit into the previous one",1,"item",3,"disabled","click"],["type","button","mat-stroked-button","","title","Insert a new commit above this one",1,"item",3,"disabled","click"],["type","button","mat-stroked-button","","title","Insert a new commit below this one",1,"item",3,"disabled","click"],["type","button","mat-stroked-button","","title","Save Changes",1,"item",3,"click"],["type","button","mat-stroked-button","","title","Discard Changes",1,"item",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t._uU(2,"Editing commits..."),t.qZA(),t.qZA(),t.TgZ(3,"div",2),t.TgZ(4,"button",3),t.NdJ("click",function(){return n.editMessage()}),t.ALo(5,"async"),t.TgZ(6,"mat-icon",4),t._uU(7,"create"),t.qZA(),t.qZA(),t.TgZ(8,"button",5),t.NdJ("click",function(){return n.squash("up")}),t.ALo(9,"async"),t.TgZ(10,"mat-icon",4),t._uU(11,"vertical_align_top"),t.qZA(),t.qZA(),t.TgZ(12,"button",6),t.NdJ("click",function(){return n.squash("down")}),t.ALo(13,"async"),t.TgZ(14,"mat-icon",4),t._uU(15,"vertical_align_bottom"),t.qZA(),t.qZA(),t.TgZ(16,"button",7),t.NdJ("click",function(){return n.insert("above")}),t.ALo(17,"async"),t.TgZ(18,"mat-icon",4),t._uU(19,"move_up"),t.qZA(),t.qZA(),t.TgZ(20,"button",8),t.NdJ("click",function(){return n.insert("below")}),t.ALo(21,"async"),t.TgZ(22,"mat-icon",4),t._uU(23,"move_down"),t.qZA(),t.qZA(),t.TgZ(24,"button",9),t.NdJ("click",function(){return n.complete()}),t.TgZ(25,"mat-icon",4),t._uU(26,"save"),t.qZA(),t.qZA(),t.TgZ(27,"button",10),t.NdJ("click",function(){return n.discard()}),t.TgZ(28,"mat-icon",4),t._uU(29,"clear"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(4),t.Q6J("disabled",null===t.lcZ(5,5,n.selectedCommit)),t.xp6(4),t.Q6J("disabled",!1===t.lcZ(9,7,n.selectedCommitHasChild)),t.xp6(4),t.Q6J("disabled",!1===t.lcZ(13,9,n.selectedCommitHasParent)),t.xp6(4),t.Q6J("disabled",null===t.lcZ(17,11,n.selectedCommit)),t.xp6(4),t.Q6J("disabled",null===t.lcZ(21,13,n.selectedCommit)))},directives:[q.lW,y.Hw],pipes:[h.Ov],styles:["[_nghost-%COMP%]{position:relative;display:block}.title[_ngcontent-%COMP%]{margin-left:10px;font-size:18px;color:#e57373}.items-left[_ngcontent-%COMP%]{position:absolute;left:0;top:0;padding:0 10px}.items[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100%}.item[_ngcontent-%COMP%]{cursor:pointer;font-size:0;margin-right:5px;min-width:45px;padding:0 10px}.item[_ngcontent-%COMP%]:last-child{margin-right:0}"],changeDetection:0}),o})();var j=s(6939),X=s(33116),ht=s(5711),U=s(10257),dt=s(74580),T=s(13358),Ct=s(55106),_t=s(3404),ut=s(16702),z=s(85339),K=s(51552);function ft(o,c){if(1&o&&(t.TgZ(0,"mat-icon",9),t._uU(1),t.qZA()),2&o){const e=c.$implicit;t.Q6J("title",e.name),t.xp6(1),t.Oqu(e.icon)}}function Mt(o,c){1&o&&(t.TgZ(0,"span",10),t.TgZ(1,"mat-icon"),t._uU(2,"expand_more"),t.qZA(),t.qZA())}function Pt(o,c){if(1&o&&(t.TgZ(0,"li",4),t.TgZ(1,"span",5),t.YNc(2,ft,2,2,"mat-icon",6),t.qZA(),t.TgZ(3,"span",7),t.ALo(4,"async"),t._uU(5),t.qZA(),t.YNc(6,Mt,3,0,"span",8),t.qZA()),2&o){const e=c.$implicit,n=c.first,i=t.oxw(2);t.Q6J("ngClass","color-"+i.color),t.xp6(1),t.Q6J("ngClass","color-"+i.color),t.xp6(1),t.Q6J("ngForOf",e.sources)("ngForTrackBy",i.trackBranchSource),t.xp6(1),t.ekj("current",i.branchMatches(t.lcZ(4,9,i.currentBranch),e)),t.Q6J("title",e.name),t.xp6(2),t.Oqu(e.name),t.xp6(1),t.Q6J("ngIf",n&&(i.branches.length>1||i.branches[0].sources.length>2))}}function Ot(o,c){if(1&o&&(t.TgZ(0,"ul",2),t.YNc(1,Pt,7,11,"li",3),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.branches)("ngForTrackBy",e.trackBranch)}}function bt(o,c){if(1&o&&(t.TgZ(0,"mat-icon"),t._uU(1),t.qZA()),2&o){const e=c.$implicit;t.xp6(1),t.Oqu(e.icon)}}function xt(o,c){1&o&&(t.TgZ(0,"span",10),t.TgZ(1,"mat-icon"),t._uU(2,"expand_more"),t.qZA(),t.qZA())}function vt(o,c){if(1&o&&(t.TgZ(0,"div",11),t.TgZ(1,"span",12),t.YNc(2,bt,2,1,"mat-icon",13),t.qZA(),t.TgZ(3,"span",14),t._uU(4),t.qZA(),t.YNc(5,xt,3,0,"span",8),t.qZA()),2&o){const e=c.ngIf,n=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.sources)("ngForTrackBy",n.trackBranchSource),t.xp6(2),t.Oqu(e.name),t.xp6(1),t.Q6J("ngIf",n.branches.length>1||n.branches[0].sources.length>2)}}let wt=(()=>{class o{constructor(e){this.cdr=e,this.branchMatches=(n,i)=>i.sources.some(a=>"local"===a.type)&&`refs/heads/${i.name}`===n,this.trackBranch=(n,i)=>i.name+i.sources.reduce((a,r,l)=>`${a},${this.trackBranchSource(l,r)}`,""),this.trackBranchSource=(n,i)=>`${i.type}:${i.name}`}ngOnChanges(e){!e.branches||!e.branches.currentValue||this.cdr.detectChanges()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-rebase-branches"]],inputs:{branches:"branches",color:"color"},features:[t.TTD],decls:3,vars:4,consts:[["class","branches",4,"ngIf"],["class","spacer branch",4,"ngIf"],[1,"branches"],["class","branch",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"branch",3,"ngClass"],[1,"icons",3,"ngClass"],[3,"title",4,"ngFor","ngForOf","ngForTrackBy"],[1,"name",3,"title"],["class","expandable",4,"ngIf"],[3,"title"],[1,"expandable"],[1,"spacer","branch"],[1,"icons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"name"]],template:function(e,n){1&e&&(t.YNc(0,Ot,2,2,"ul",0),t.ALo(1,"nullEmpty"),t.YNc(2,vt,6,4,"div",1)),2&e&&(t.Q6J("ngIf",t.lcZ(1,2,n.branches)),t.xp6(2),t.Q6J("ngIf",n.branches.length>0&&n.branches[0]))},directives:[h.O5,h.sg,h.mk,y.Hw],pipes:[K.x,h.Ov],styles:["[_nghost-%COMP%]{display:block;position:relative}.branches[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:auto;max-width:250px;border:1px solid #616161;border-radius:6px;background:#3c3c3c}.branches[_ngcontent-%COMP%]:hover{width:fit-content;max-width:max-content;z-index:100}.branches[_ngcontent-%COMP%]:hover   .branch[_ngcontent-%COMP%]{display:flex}.branches[_ngcontent-%COMP%]:hover   .branch[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]{max-width:none;border-radius:0}.branches[_ngcontent-%COMP%]:hover   .branch[_ngcontent-%COMP%]:first-child   .icons[_ngcontent-%COMP%]{border-top-left-radius:6px}.branches[_ngcontent-%COMP%]:hover   .branch[_ngcontent-%COMP%]:last-child   .icons[_ngcontent-%COMP%]{border-bottom-left-radius:6px}.branches[_ngcontent-%COMP%]:hover   .branch[_ngcontent-%COMP%]   .expandable[_ngcontent-%COMP%]{visibility:hidden}.branch[_ngcontent-%COMP%]{display:none;height:24px;line-height:24px}.branch[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-right:5px}.branch[_ngcontent-%COMP%]   .name.current[_ngcontent-%COMP%]{font-weight:600}.branch[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]{max-width:67px;flex-shrink:0;overflow:hidden;padding:0 5px;border-radius:6px 0 0 6px;margin-right:5px}.branch[_ngcontent-%COMP%]   .icons.color-0[_ngcontent-%COMP%]{background:#4363d8}.branch[_ngcontent-%COMP%]   .icons.color-1[_ngcontent-%COMP%]{background:#469990}.branch[_ngcontent-%COMP%]   .icons.color-2[_ngcontent-%COMP%]{background:#fabed4}.branch[_ngcontent-%COMP%]   .icons.color-3[_ngcontent-%COMP%]{background:#e6194B}.branch[_ngcontent-%COMP%]   .icons.color-4[_ngcontent-%COMP%]{background:#42d4f4}.branch[_ngcontent-%COMP%]   .icons.color-5[_ngcontent-%COMP%]{background:#f58231}.branch[_ngcontent-%COMP%]   .icons.color-6[_ngcontent-%COMP%]{background:#ffe119}.branch[_ngcontent-%COMP%]   .icons.color-7[_ngcontent-%COMP%]{background:#3cb44b}.branch[_ngcontent-%COMP%]   .icons.color-8[_ngcontent-%COMP%]{background:#f032e6}.branch[_ngcontent-%COMP%]   .icons.color-9[_ngcontent-%COMP%]{background:#ffffff}.branch[_ngcontent-%COMP%]   .icons.color-10[_ngcontent-%COMP%]{background:#800000}.branch[_ngcontent-%COMP%]   .icons.color-11[_ngcontent-%COMP%]{background:#9A6324}.branch[_ngcontent-%COMP%]   .icons.color-12[_ngcontent-%COMP%]{background:#fffac8}.branch[_ngcontent-%COMP%]   .icons.color-13[_ngcontent-%COMP%]{background:#aaffc3}.branch[_ngcontent-%COMP%]   .icons.color-14[_ngcontent-%COMP%]{background:#dcbeff}.branch[_ngcontent-%COMP%]   .icons.color-0[_ngcontent-%COMP%]{color:#eee}.branch[_ngcontent-%COMP%]   .icons.color-1[_ngcontent-%COMP%]{color:#1e1e1e}.branch[_ngcontent-%COMP%]   .icons.color-2[_ngcontent-%COMP%]{color:#1e1e1e}.branch[_ngcontent-%COMP%]   .icons.color-3[_ngcontent-%COMP%]{color:#eee}.branch[_ngcontent-%COMP%]   .icons.color-4[_ngcontent-%COMP%]{color:#1e1e1e}.branch[_ngcontent-%COMP%]   .icons.color-5[_ngcontent-%COMP%]{color:#1e1e1e}.branch[_ngcontent-%COMP%]   .icons.color-6[_ngcontent-%COMP%]{color:#1e1e1e}.branch[_ngcontent-%COMP%]   .icons.color-7[_ngcontent-%COMP%]{color:#1e1e1e}.branch[_ngcontent-%COMP%]   .icons.color-8[_ngcontent-%COMP%]{color:#eee}.branch[_ngcontent-%COMP%]   .icons.color-9[_ngcontent-%COMP%]{color:#1e1e1e}.branch[_ngcontent-%COMP%]   .icons.color-10[_ngcontent-%COMP%]{color:#eee}.branch[_ngcontent-%COMP%]   .icons.color-11[_ngcontent-%COMP%]{color:#eee}.branch[_ngcontent-%COMP%]   .icons.color-12[_ngcontent-%COMP%]{color:#1e1e1e}.branch[_ngcontent-%COMP%]   .icons.color-13[_ngcontent-%COMP%]{color:#1e1e1e}.branch[_ngcontent-%COMP%]   .icons.color-14[_ngcontent-%COMP%]{color:#1e1e1e}.branch[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-left:5px;padding-left:1px;width:26px}.branch[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:first-child{margin-left:0}.branch[_ngcontent-%COMP%]   .expandable[_ngcontent-%COMP%]{margin-right:5px}.branch[_ngcontent-%COMP%]:first-child{display:flex}.branch.spacer[_ngcontent-%COMP%]{display:flex;user-select:none;max-width:250px;visibility:hidden}"],changeDetection:0}),(0,$.gn)([(0,Z.Ph)(Q.E.selectedRepositoryCurrentBranch)],o.prototype,"currentBranch",void 0),o})();const Zt=["contextMenu"];function yt(o,c){if(1&o&&(t.O4$(),t._UZ(0,"rect",13)),2&o){const e=c.ngIf,n=t.oxw();t.uIk("y",n.getYCoord(e.yIndex)-n.yOffset)("height",n.yUnit)}}function Tt(o,c){if(1&o&&(t.O4$(),t.TgZ(0,"g",14),t._UZ(1,"path",15),t.qZA()),2&o){const e=c.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngClass","color-"+n.getTrailColorIndex(e.from.trail)),t.uIk("d",e.path)}}function At(o,c){if(1&o&&(t.O4$(),t.TgZ(0,"g",16),t._UZ(1,"path",15),t.qZA()),2&o){const e=c.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngClass","color-"+n.getTrailColorIndex(e)),t.uIk("d",n.drawTrail(e))}}function kt(o,c){if(1&o&&(t.O4$(),t.TgZ(0,"g"),t._UZ(1,"circle",17),t.qZA()),2&o){const e=c.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngClass","color-"+n.getTrailColorIndex(e.trail)),t.uIk("cx",n.getXCoord(e.trail.lane.xIndex))("cy",n.getYCoord(e.yIndex))}}function Rt(o,c){if(1&o&&(t.TgZ(0,"span",22),t._UZ(1,"app-rebase-branches",23),t.qZA()),2&o){const e=c.ngIf,n=t.oxw().$implicit,i=t.oxw();t.xp6(1),t.Q6J("branches",e)("color",i.getTrailColorIndex(n.trail))}}function It(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"li",18),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().changeCommit.next(a.id)})("contextmenu",function(i){const r=t.CHM(e).$implicit;return t.oxw().openContextMenu(i,r)}),t.ALo(1,"async"),t._UZ(2,"app-avatar",19),t.ALo(3,"async"),t.YNc(4,Rt,2,2,"span",20),t.ALo(5,"nullEmpty"),t.TgZ(6,"span",21),t._uU(7),t.qZA(),t.qZA()}if(2&o){const e=c.$implicit,n=t.oxw();t.ekj("selected",e.id===t.lcZ(1,7,n.selectedCommitId)),t.xp6(2),t.Q6J("title",e.commit.authorName+" ("+e.commit.authorEmail+")")("remotes",t.lcZ(3,9,n.remotes))("email",e.commit.authorEmail),t.xp6(2),t.Q6J("ngIf",t.lcZ(5,11,n.getBranches(e))),t.xp6(3),t.hij(" ",n.getCommitSummary(e)," ")}}function Ft(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().data,a=t.oxw();return a.squash(i.commit,"up"),a.closeContextMenu()}),t.TgZ(1,"mat-icon"),t._uU(2,"vertical_align_top"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Squash into next"),t.qZA(),t.qZA()}}function qt(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",31),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().data,a=t.oxw();return a.squash(i.commit,"down"),a.closeContextMenu()}),t.TgZ(1,"mat-icon"),t._uU(2,"vertical_align_bottom"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Squash into previous"),t.qZA(),t.qZA()}}function Jt(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",24),t.TgZ(1,"button",25),t.NdJ("click",function(){const a=t.CHM(e).data,r=t.oxw();return r.editMessage(a.commit),r.closeContextMenu()}),t.TgZ(2,"mat-icon"),t._uU(3,"create"),t.qZA(),t.TgZ(4,"span"),t._uU(5,"Edit commit message"),t.qZA(),t.qZA(),t.YNc(6,Ft,5,0,"button",26),t.YNc(7,qt,5,0,"button",27),t.TgZ(8,"button",28),t.NdJ("click",function(){const a=t.CHM(e).data,r=t.oxw();return r.insert(a.commit,"above"),r.closeContextMenu()}),t.TgZ(9,"mat-icon"),t._uU(10,"move_up"),t.qZA(),t.TgZ(11,"span"),t._uU(12,"Insert commit above"),t.qZA(),t.qZA(),t.TgZ(13,"button",29),t.NdJ("click",function(){const a=t.CHM(e).data,r=t.oxw();return r.insert(a.commit,"below"),r.closeContextMenu()}),t.TgZ(14,"mat-icon"),t._uU(15,"move_down"),t.qZA(),t.TgZ(16,"span"),t._uU(17,"Insert commit below"),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=c.data,n=t.oxw();t.xp6(6),t.Q6J("ngIf",n.hasChild(null==e?null:e.commit)),t.xp6(1),t.Q6J("ngIf",n.hasParent(null==e?null:e.commit))}}let Ut=(()=>{class o extends((0,k.j)(R.A)){constructor(e,n,i,a,r,l,b,ee,ne){super(),this.element=e,this.dialog=n,this.overlay=i,this.viewContainerRef=a,this.store=r,this.commitsApi=l,this.historyApi=b,this.branchesService=ee,this.graphCalculatorService=ne,this.changeCommit=new t.vpe,this.commits=[],this.idToCommitDetail={},this.commitTrails=[],this.mergePaths=[],this.commitDetails=new M.X([]),this.visibleCommitDetails=new M.X([]),this.visibleCommitTrails=new M.X([]),this.visibleMergePaths=new M.X([]),this.xUnit=T.$.xUnit,this.yUnit=T.$.yUnit,this.xOffset=T.$.xOffset,this.yOffset=T.$.yOffset,this.totalColors=15,this.overlayRef=new M.X(null),this.getTrailColorIndex=m=>m.colorIndex%this.totalColors,this.getXCoord=m=>this.xOffset+this.xUnit*m,this.getYCoord=m=>this.yOffset+this.yUnit*m,this.getCommitSummary=m=>m.commit.message.split("\n")[0],this.getBranches=m=>this.branchesService.calculateBranches(m.commit.references,null),this.openContextMenu=(m,d)=>{m.preventDefault(),m.stopPropagation(),this.closeContextMenu();const g=this.overlay.create({positionStrategy:this.overlay.position().flexibleConnectedTo({x:m.x,y:m.y}).withPositions([{originX:"end",originY:"bottom",overlayX:"start",overlayY:"top"}])});this.overlayRef.next(g),g.attach(new ht.UE(this.menuTemplate,this.viewContainerRef,{data:{commit:d}})),(0,dt.t)(g).pipe((0,u.q)(1),(0,A.R)(this.destroyed$)).subscribe(()=>this.closeContextMenu())},this.closeContextMenu=()=>{this.overlayRef.value&&(this.overlayRef.value.dispose(),this.overlayRef.next(null))},this.editMessage=m=>{this.repository.pipe((0,u.q)(1),(0,C.h)(f.$K),(0,p.w)(d=>this.dialog.open(S,{data:{message:m.commit.message}}).afterClosed().pipe((0,C.h)(f.$K),(0,p.w)(({message:g})=>this.commitsApi.editCommitDetails(d.path,m.id,g)),(0,F.K)(g=>J.B.matches(g)?this.store.dispatch(new v.NN("error",g.message)).pipe((0,p.w)(()=>(0,x._)(g))):this.store.dispatch(new v.NN("unhandled",`${g}`)).pipe((0,p.w)(()=>(0,x._)(g))))))).subscribe(d=>{this.changeCommit.next(d)})},this.squash=(m,d)=>{this.repository.pipe((0,u.q)(1),(0,C.h)(f.$K),(0,p.w)(g=>this.commitsApi.squashCommit(g.path,m.id,d)),(0,F.K)(g=>J.B.matches(g)?this.store.dispatch(new v.NN("error",g.message)).pipe((0,p.w)(()=>(0,x._)(g))):this.store.dispatch(new v.NN("unhandled",`${g}`)).pipe((0,p.w)(()=>(0,x._)(g))))).subscribe(g=>{this.changeCommit.next(g)})},this.insert=(m,d)=>{this.repository.pipe((0,u.q)(1),(0,C.h)(f.$K),(0,p.w)(g=>this.commitsApi.insertCommit(g.path,m.id,d))).subscribe(g=>{this.changeCommit.next(g)})},this.hasChild=m=>!!m&&this.commitDetails.value.findIndex(d=>d.id===m.id)>0,this.hasParent=m=>!!m&&this.commitDetails.value.findIndex(d=>d.id===m.id)<this.commitDetails.value.length-1}ngOnInit(){this.remotes=this.repository.pipe((0,V.U)(e=>e?.remotes??[])),(0,O.aj)([this.repository,this.ongoingEdit]).pipe((0,C.h)(f.Ej),(0,p.w)(([e,n])=>this.historyApi.getCommitsWithReferences(e.path,n.commitIds)),(0,A.R)(this.destroyed$)).subscribe(e=>{this.calculate(e)})}graphClicked(e){const n=this.getCommitFromPosition(e.offsetY);n&&this.changeCommit.next(n.id)}graphContextMenu(e){const n=this.getCommitFromPosition(e.offsetY);n&&this.openContextMenu(e,this.idToCommitDetail[n.id])}keyPressed(e){e.preventDefault(),(0,O.aj)([this.repository,this.selectedCommitId]).pipe((0,u.q)(1),(0,A.R)(this.destroyed$)).subscribe(([n,i])=>{if(!n)return;const a=this.commits.findIndex(l=>l.id===i);if(-1===a)return;let r=null;switch(e.key){case"ArrowUp":if(!e.ctrlKey){a>0&&(r=this.commits[a-1].id);break}case"Home":r=this.commits[0].id;break;case"ArrowDown":if(!e.ctrlKey){a<this.commits.length-1&&(r=this.commits[a+1].id);break}case"End":r=this.commits[this.commits.length-1].id}r&&this.changeCommit.next(r)})}drawTrail(e){if(e.commits.length<1)return"";const n=e.commits[0],i=e.commits[e.commits.length-1],a=i.commit.parentIds.length>0?this.idToCommitDetail[i.commit.parentIds[0]]??i:i;if(a||console.error(`Could not find parent ${i.commit.parentIds[0]}`,e),n.id===i.id&&i.id===a.id)return"";const r=e.isDashed?{x:0,y:.05}:{x:0,y:0};return[`M ${this.getXCoord(n.trail.lane.xIndex+r.x)} ${this.getYCoord(n.yIndex+r.y)}`,`V ${this.getYCoord(a.yIndex-.5)}`,`L ${this.getXCoord(a.trail.lane.xIndex)} ${this.getYCoord(a.yIndex)}`].join("")}trackCommitDetail(e,n){return n.id}trackCommitTrail(e,n){return n.trailIndex}trackMergePath(e,n){return`${n.from.id}|${n.to.map(i=>i.id).join(";")}`}updateVisibleCommits(){const i=Math.ceil((600+this.element.nativeElement.clientHeight)/this.yUnit),a=this.viewport.measureScrollOffset("top"),r=Math.floor(Math.max(0,(a-300)/this.yUnit)),l=this.graphCalculatorService.calculateVisible(this.commitDetails.value,this.commitTrails,this.mergePaths,r,r+i);this.visibleCommitDetails.next(l.commitDetails),this.visibleCommitTrails.next(l.commitTrails),this.visibleMergePaths.next(l.mergePaths)}calculate(e){const n=this.graphCalculatorService.calculate(null,[],e,this.getXCoord,this.getYCoord,this.totalColors);this.idToCommitDetail=n.commitDetails,this.commitTrails=n.commitTrails,this.mergePaths=n.mergePaths,this.commits=n.orderedCommits,this.commitDetails.next(this.commits.map(i=>n.commitDetails[i.id])),this.updateVisibleCommits()}getCommitFromPosition(e){const n=this.viewport.measureScrollOffset("top"),i=Math.floor((n+e)/this.yUnit);return this.commits[i]}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.SBq),t.Y36(_.uw),t.Y36(Ct.aV),t.Y36(t.s_b),t.Y36(Z.yh),t.Y36(I.T),t.Y36(_t.Q),t.Y36(ut.p),t.Y36(T.$))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-rebase-view"]],viewQuery:function(e,n){if(1&e&&(t.Gf(U.N7,7),t.Gf(Zt,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.viewport=i.first),t.iGM(i=t.CRH())&&(n.menuTemplate=i.first)}},inputs:{repository:"repository",selectedCommitId:"selectedCommitId",ongoingEdit:"ongoingEdit"},outputs:{changeCommit:"changeCommit"},features:[t.qOj],decls:20,vars:18,consts:[["id","graph-view","tabindex","0",3,"keydown"],[1,"graph",3,"click","contextmenu"],["graphSvg",""],[1,"wrapper"],["graphWrapper",""],["class","selected-background","x","0","width","100%",4,"ngIf"],["class","merge-path",4,"ngFor","ngForOf","ngForTrackBy"],["class","commit-path",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"viewport",3,"itemSize"],[1,"messages"],[3,"selected","click","contextmenu",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["contextMenu",""],["x","0","width","100%",1,"selected-background"],[1,"merge-path"],[3,"ngClass"],[1,"commit-path"],["r","5",1,"commit-circle",3,"ngClass"],[3,"click","contextmenu"],[3,"title","remotes","email"],["class","branches",4,"ngIf"],[1,"summary"],[1,"branches"],[3,"branches","color"],[1,"menu-panel"],["title","Edit commit message",1,"menu-item",3,"click"],["class","menu-item","title","Squash this commit into the next one",3,"click",4,"ngIf"],["class","menu-item","title","Squash this commit into the previous one",3,"click",4,"ngIf"],["title","Insert a new commit above this one",1,"menu-item",3,"click"],["title","Insert a new commit below this one",1,"menu-item",3,"click"],["title","Squash this commit into the next one",1,"menu-item",3,"click"],["title","Squash this commit into the previous one",1,"menu-item",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"app-grid",0),t.NdJ("keydown",function(a){return n.keyPressed(a)}),t.TgZ(1,"app-grid-cell"),t.O4$(),t.TgZ(2,"svg",1,2),t.NdJ("click",function(a){return n.graphClicked(a)})("contextmenu",function(a){return n.graphContextMenu(a)}),t.TgZ(4,"g",3,4),t.YNc(6,yt,1,2,"rect",5),t.ALo(7,"async"),t.YNc(8,Tt,2,2,"g",6),t.ALo(9,"async"),t.YNc(10,At,2,2,"g",7),t.ALo(11,"async"),t.YNc(12,kt,2,3,"g",8),t.ALo(13,"async"),t.qZA(),t.qZA(),t.qZA(),t.kcU(),t.TgZ(14,"app-grid-cell"),t.TgZ(15,"cdk-virtual-scroll-viewport",9),t.TgZ(16,"ul",10),t.YNc(17,It,8,13,"li",11),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(18,Jt,18,2,"ng-template",null,12,t.W1O)),2&e&&(t.xp6(6),t.Q6J("ngIf",n.idToCommitDetail[t.lcZ(7,10,n.selectedCommitId)||""]),t.xp6(2),t.Q6J("ngForOf",t.lcZ(9,12,n.visibleMergePaths))("ngForTrackBy",n.trackMergePath),t.xp6(2),t.Q6J("ngForOf",t.lcZ(11,14,n.visibleCommitTrails))("ngForTrackBy",n.trackCommitTrail),t.xp6(2),t.Q6J("ngForOf",t.lcZ(13,16,n.visibleCommitDetails))("ngForTrackBy",n.trackCommitDetail),t.xp6(3),t.Q6J("itemSize",n.yUnit),t.xp6(2),t.Q6J("cdkVirtualForOf",n.commitDetails)("cdkVirtualForTrackBy",n.trackCommitDetail))},directives:[j.M,X.Y,h.O5,h.sg,U.N7,U.xd,U.x0,h.mk,z.A,wt,y.Hw],pipes:[h.Ov,K.x],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}app-grid[_ngcontent-%COMP%]{outline:none}.graph[_ngcontent-%COMP%]{display:block;width:100%;height:100%;cursor:pointer}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path[_ngcontent-%COMP%]{fill:none;stroke-width:2;z-index:10}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-0[_ngcontent-%COMP%]{stroke:#4363d8}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-1[_ngcontent-%COMP%]{stroke:#469990}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-2[_ngcontent-%COMP%]{stroke:#fabed4}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-3[_ngcontent-%COMP%]{stroke:#e6194b}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-4[_ngcontent-%COMP%]{stroke:#42d4f4}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-5[_ngcontent-%COMP%]{stroke:#f58231}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-6[_ngcontent-%COMP%]{stroke:#ffe119}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-7[_ngcontent-%COMP%]{stroke:#3cb44b}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-8[_ngcontent-%COMP%]{stroke:#f032e6}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-9[_ngcontent-%COMP%]{stroke:#fff}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-10[_ngcontent-%COMP%]{stroke:maroon}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-11[_ngcontent-%COMP%]{stroke:#9a6324}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-12[_ngcontent-%COMP%]{stroke:#fffac8}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-13[_ngcontent-%COMP%]{stroke:#aaffc3}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.color-14[_ngcontent-%COMP%]{stroke:#dcbeff}.graph[_ngcontent-%COMP%]   .commit-path[_ngcontent-%COMP%] > path.dashed[_ngcontent-%COMP%]{stroke:#ffffff80;stroke-dasharray:4;stroke-dashoffset:4}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path[_ngcontent-%COMP%]{fill:none;stroke-width:2;z-index:20}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-0[_ngcontent-%COMP%]{stroke:#4363d8}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-1[_ngcontent-%COMP%]{stroke:#469990}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-2[_ngcontent-%COMP%]{stroke:#fabed4}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-3[_ngcontent-%COMP%]{stroke:#e6194b}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-4[_ngcontent-%COMP%]{stroke:#42d4f4}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-5[_ngcontent-%COMP%]{stroke:#f58231}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-6[_ngcontent-%COMP%]{stroke:#ffe119}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-7[_ngcontent-%COMP%]{stroke:#3cb44b}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-8[_ngcontent-%COMP%]{stroke:#f032e6}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-9[_ngcontent-%COMP%]{stroke:#fff}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-10[_ngcontent-%COMP%]{stroke:maroon}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-11[_ngcontent-%COMP%]{stroke:#9a6324}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-12[_ngcontent-%COMP%]{stroke:#fffac8}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-13[_ngcontent-%COMP%]{stroke:#aaffc3}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.color-14[_ngcontent-%COMP%]{stroke:#dcbeff}.graph[_ngcontent-%COMP%]   .merge-path[_ngcontent-%COMP%] > path.dashed[_ngcontent-%COMP%]{stroke:#ffffff80;stroke-dasharray:4;stroke-dashoffset:4}.graph[_ngcontent-%COMP%]   .commit-circle[_ngcontent-%COMP%]{stroke:#000;stroke-width:1.5;z-index:30}.graph[_ngcontent-%COMP%]   .commit-circle.color-0[_ngcontent-%COMP%]{fill:#4363d8}.graph[_ngcontent-%COMP%]   .commit-circle.color-1[_ngcontent-%COMP%]{fill:#469990}.graph[_ngcontent-%COMP%]   .commit-circle.color-2[_ngcontent-%COMP%]{fill:#fabed4}.graph[_ngcontent-%COMP%]   .commit-circle.color-3[_ngcontent-%COMP%]{fill:#e6194b}.graph[_ngcontent-%COMP%]   .commit-circle.color-4[_ngcontent-%COMP%]{fill:#42d4f4}.graph[_ngcontent-%COMP%]   .commit-circle.color-5[_ngcontent-%COMP%]{fill:#f58231}.graph[_ngcontent-%COMP%]   .commit-circle.color-6[_ngcontent-%COMP%]{fill:#ffe119}.graph[_ngcontent-%COMP%]   .commit-circle.color-7[_ngcontent-%COMP%]{fill:#3cb44b}.graph[_ngcontent-%COMP%]   .commit-circle.color-8[_ngcontent-%COMP%]{fill:#f032e6}.graph[_ngcontent-%COMP%]   .commit-circle.color-9[_ngcontent-%COMP%]{fill:#fff}.graph[_ngcontent-%COMP%]   .commit-circle.color-10[_ngcontent-%COMP%]{fill:maroon}.graph[_ngcontent-%COMP%]   .commit-circle.color-11[_ngcontent-%COMP%]{fill:#9a6324}.graph[_ngcontent-%COMP%]   .commit-circle.color-12[_ngcontent-%COMP%]{fill:#fffac8}.graph[_ngcontent-%COMP%]   .commit-circle.color-13[_ngcontent-%COMP%]{fill:#aaffc3}.graph[_ngcontent-%COMP%]   .commit-circle.color-14[_ngcontent-%COMP%]{fill:#dcbeff}.graph[_ngcontent-%COMP%]   .commit-circle.dashed[_ngcontent-%COMP%]{fill:none;stroke:#ffffff80}.graph[_ngcontent-%COMP%]   .selected-background[_ngcontent-%COMP%]{fill:#424242}.viewport[_ngcontent-%COMP%]{height:100%}.messages[_ngcontent-%COMP%]{position:relative;font-size:0}.messages[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:pointer;height:26px;line-height:26px;padding-left:5px;user-select:none;white-space:nowrap}.messages[_ngcontent-%COMP%] > li.selected[_ngcontent-%COMP%]{background-color:#424242}.messages[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   app-avatar[_ngcontent-%COMP%]{width:24px;height:24px;vertical-align:middle;margin-right:5px}.messages[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .branches[_ngcontent-%COMP%]{display:inline-block;height:26px;vertical-align:middle;font-size:16px;margin-right:10px}.messages[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]{font-size:16px;vertical-align:middle}.messages[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .summary.dimmed[_ngcontent-%COMP%]{color:#ffffff80}.messages[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .uncommitted-icon[_ngcontent-%COMP%]{margin-right:5px;color:#ffffff80}.menu-panel[_ngcontent-%COMP%]{background:#424242;border-radius:4px;box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f;max-height:calc(100vh - 48px);max-width:25vw;min-height:48px;min-width:112px;overflow-x:hidden;overflow-y:auto}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{background:transparent;border:none;color:#fff;cursor:pointer;display:flex;font-family:Montserrat;font-size:14px;height:48px;line-height:48px;max-width:100%;outline:none;overflow:hidden;padding:0 16px;user-select:none;text-align:left;text-overflow:ellipsis;width:100%;white-space:nowrap}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:first-child{border-radius:4px 4px 0 0}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:last-child{border-radius:0 0 4px 4px}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:hover{background:#565656}.menu-panel[_ngcontent-%COMP%]   .menu-item[disabled][_ngcontent-%COMP%]{pointer-events:none;color:#ffffff4d}.menu-panel[_ngcontent-%COMP%]   .menu-item.bold[_ngcontent-%COMP%]{font-weight:bold}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin:12px 16px 12px 0;vertical-align:middle;flex:0 0 auto}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]   .mat-icon.expand-icon[_ngcontent-%COMP%]{margin-left:auto;margin-right:0}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{vertical-align:middle;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.menu-panel.sub-menu-1[_ngcontent-%COMP%]{background:#4a4a4a}"],changeDetection:0}),o})();var Nt=s(72352),Dt=s(80888),Vt=s(4893),Qt=s(88784);function Et(o,c){if(1&o&&(t.TgZ(0,"li",18),t._uU(1),t.qZA()),2&o){const e=c.$implicit,n=c.first;t.Q6J("title",e),t.xp6(1),t.AsE("",n?"":", ","",e,"")}}function Yt(o,c){if(1&o&&(t.TgZ(0,"div",15),t.TgZ(1,"span",3),t._uU(2),t.ALo(3,"plural"),t.qZA(),t.TgZ(4,"div",16),t.TgZ(5,"ul"),t.YNc(6,Et,2,3,"li",17),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw().ngIf;t.xp6(2),t.hij("",t.xi3(3,2,"Parent",e.parentIds.length),": "),t.xp6(4),t.Q6J("ngForOf",e.parentIds)}}function Ht(o,c){if(1&o&&(t.TgZ(0,"div",19),t._uU(1," committed by "),t._UZ(2,"app-avatar",8),t.ALo(3,"async"),t.TgZ(4,"span",9),t._uU(5),t.qZA(),t.qZA()),2&o){const e=t.oxw().ngIf,n=t.oxw();t.xp6(2),t.Q6J("remotes",t.lcZ(3,4,n.remotes))("email",e.committerEmail),t.xp6(2),t.Q6J("title",e.committerEmail),t.xp6(1),t.Oqu(e.committerName)}}function $t(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw().$implicit;return t.oxw(3).move(a,"up"),i.stopPropagation()}),t.TgZ(1,"mat-icon",28),t._uU(2,"vertical_align_top"),t.qZA(),t.qZA()}}function Bt(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw().$implicit;return t.oxw(3).move(a,"down"),i.stopPropagation()}),t.TgZ(1,"mat-icon",28),t._uU(2,"vertical_align_bottom"),t.qZA(),t.qZA()}}function Lt(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"li",21),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(3).changeSelectedFile(a)})("contextmenu",function(){const a=t.CHM(e).$implicit,r=t.oxw(3);return r.copyToClipboard(r.getPatchPath(a))}),t.ALo(1,"async"),t.TgZ(2,"mat-icon",22),t._uU(3),t.qZA(),t._UZ(4,"app-condensed-path",23),t.TgZ(5,"div",24),t.YNc(6,$t,3,0,"button",25),t.ALo(7,"async"),t.YNc(8,Bt,3,0,"button",26),t.ALo(9,"async"),t.qZA(),t.qZA()}if(2&o){const e=c.$implicit,n=t.oxw(3);t.ekj("selected",n.isFileSelected(e,t.lcZ(1,7,n.selectedFile))),t.xp6(2),t.Q6J("ngClass",n.getPatchIconColorClass(e)),t.xp6(1),t.Oqu(n.getPatchIcon(e)),t.xp6(1),t.Q6J("path",n.getPatchPath(e)),t.xp6(2),t.Q6J("ngIf",t.lcZ(7,9,n.selectedCommitHasChild)),t.xp6(2),t.Q6J("ngIf",t.lcZ(9,11,n.selectedCommitHasParent))}}function St(o,c){if(1&o&&(t.TgZ(0,"ul"),t.YNc(1,Lt,10,13,"li",20),t.qZA()),2&o){const e=c.ngIf;t.xp6(1),t.Q6J("ngForOf",e)}}function jt(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"header"),t.TgZ(2,"div",2),t.NdJ("click",function(){const a=t.CHM(e).ngIf;return t.oxw().copyToClipboard(a.id)}),t.TgZ(3,"span",3),t._uU(4,"Commit:"),t.qZA(),t._uU(5),t.qZA(),t.YNc(6,Yt,7,5,"div",4),t.qZA(),t.TgZ(7,"mat-card",5),t.TgZ(8,"div",6),t._uU(9),t.qZA(),t.TgZ(10,"div",7),t._uU(11," authored by "),t._UZ(12,"app-avatar",8),t.ALo(13,"async"),t.TgZ(14,"span",9),t._uU(15),t.qZA(),t._UZ(16,"br"),t.qZA(),t.YNc(17,Ht,6,6,"div",10),t.TgZ(18,"div",11),t.ALo(19,"date"),t._uU(20," on "),t.TgZ(21,"span",12),t._uU(22),t.ALo(23,"date"),t.qZA(),t._uU(24," at "),t.TgZ(25,"span",12),t._uU(26),t.ALo(27,"date"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(28,"mat-card",13),t.YNc(29,St,2,1,"ul",14),t.qZA(),t.qZA()}if(2&o){const e=c.ngIf,n=t.oxw();t.xp6(2),t.Q6J("title",e.id),t.xp6(3),t.hij(" ",e.id," "),t.xp6(1),t.Q6J("ngIf",e.parentIds.length),t.xp6(3),t.Oqu(e.message),t.xp6(3),t.Q6J("remotes",t.lcZ(13,13,n.remotes))("email",e.authorEmail),t.xp6(2),t.Q6J("title",e.authorEmail),t.xp6(1),t.Oqu(e.authorName),t.xp6(2),t.Q6J("ngIf",e.committerName&&e.committerEmail&&(e.authorName!==e.committerName||e.authorEmail!==e.committerEmail)),t.xp6(1),t.Q6J("title",t.xi3(19,15,e.date,"z")),t.xp6(4),t.Oqu(t.xi3(23,18,e.date,"d MMMM y")),t.xp6(4),t.Oqu(t.xi3(27,21,e.date,"HH:mm:ss")),t.xp6(3),t.Q6J("ngIf",e.diffs[0].patches)}}let Xt=(()=>{class o extends((0,k.j)(R.A)){constructor(e,n){super(),this.commitsApi=e,this.commitDetailService=n,this.changeCommit=new t.vpe,this.changeFile=new t.vpe,this.move=(i,a)=>{const r=i.newFilePath??i.oldFilePath;r&&(0,O.aj)([this.repository,this.selectedCommit]).pipe((0,u.q)(1),(0,C.h)(f.Ej),(0,p.w)(([l,b])=>this.commitsApi.moveCommitChanges(l.path,b.id,a,[r]))).subscribe(l=>{this.changeCommit.next(l)})}}ngOnInit(){this.remotes=this.repository.pipe((0,V.U)(e=>e?.remotes??[]))}getPatchPath(e){return this.commitDetailService.getPatchPath(e)}getPatchIcon(e){return this.commitDetailService.getPatchIcon(e)}getPatchIconColorClass(e){return this.commitDetailService.getPatchIconColorClass(e)}copyToClipboard(e){navigator.clipboard.writeText(e??"").then(()=>{})}changeSelectedFile(e){this.selectedFile.pipe((0,u.q)(1)).subscribe(n=>{this.changeFile.next(this.isFileSelected(e,n)?null:{area:"commit",oldFilePath:e.oldFilePath,newFilePath:e.newFilePath})})}isFileSelected(e,n){return!!n&&e.oldFilePath===n.oldFilePath&&e.newFilePath===n.newFilePath}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(I.T),t.Y36(Nt.d))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-rebase-detail-view"]],inputs:{repository:"repository",selectedCommit:"selectedCommit",selectedFile:"selectedFile",selectedCommitHasChild:"selectedCommitHasChild",selectedCommitHasParent:"selectedCommitHasParent"},outputs:{changeCommit:"changeCommit",changeFile:"changeFile"},features:[t.qOj],decls:2,vars:3,consts:[["class","detail-container",4,"ngIf"],[1,"detail-container"],[1,"this-commit",3,"title","click"],[1,"title"],["class","parent-commits",4,"ngIf"],[1,"message"],[1,"content"],[1,"author"],[3,"remotes","email"],[1,"highlight",3,"title"],["class","committer",4,"ngIf"],[1,"date",3,"title"],[1,"highlight"],[1,"files"],[4,"ngIf"],[1,"parent-commits"],[1,"parent-commit-ids"],["class","commit",3,"title",4,"ngFor","ngForOf"],[1,"commit",3,"title"],[1,"committer"],[3,"selected","click","contextmenu",4,"ngFor","ngForOf"],[3,"click","contextmenu"],["inline","",3,"ngClass"],[1,"name",3,"path"],[1,"buttons"],["type","button","mat-flat-button","","class","staging-btn","color","primary","title","Move changes into next commit",3,"click",4,"ngIf"],["type","button","mat-flat-button","","class","discard-btn","color","primary","title","Move changes into previous commit",3,"click",4,"ngIf"],["type","button","mat-flat-button","","color","primary","title","Move changes into next commit",1,"staging-btn",3,"click"],["inline",""],["type","button","mat-flat-button","","color","primary","title","Move changes into previous commit",1,"discard-btn",3,"click"]],template:function(e,n){1&e&&(t.YNc(0,jt,30,24,"div",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,n.selectedCommit))},directives:[h.O5,Dt.a8,z.A,h.sg,y.Hw,h.mk,Vt.j,q.lW],pipes:[h.Ov,h.uU,Qt.r],styles:[".detail-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:0 10px;flex:0 0 auto;overflow:auto;font-weight:600}header[_ngcontent-%COMP%]   .commit[_ngcontent-%COMP%]{min-width:65px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer}header[_ngcontent-%COMP%]   .this-commit[_ngcontent-%COMP%]{flex:1 1 auto;min-width:65px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;padding-right:10px}header[_ngcontent-%COMP%]   .parent-commits[_ngcontent-%COMP%]{flex:1 1 auto;min-width:65px;overflow:hidden}header[_ngcontent-%COMP%]   .parent-commits[_ngcontent-%COMP%]   .parent-commit-ids[_ngcontent-%COMP%]{display:inline-block;width:calc(100% - 61px)}header[_ngcontent-%COMP%]   .parent-commits[_ngcontent-%COMP%]   .parent-commit-ids[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{width:100%;display:flex;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:400;color:#fff}.message[_ngcontent-%COMP%]{flex:1 10 auto;margin:10px 10px 0;min-height:120px;overflow:auto;white-space:pre-line}.message[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{font-size:18px}.message[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%], .message[_ngcontent-%COMP%]   .committer[_ngcontent-%COMP%], .message[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{color:#ffffffb3}.message[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%], .message[_ngcontent-%COMP%]   .committer[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%], .message[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]{color:#fff}.message[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{margin-top:20px}.message[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%], .message[_ngcontent-%COMP%]   .committer[_ngcontent-%COMP%]{margin-bottom:2px}.message[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   app-avatar[_ngcontent-%COMP%], .message[_ngcontent-%COMP%]   .committer[_ngcontent-%COMP%]   app-avatar[_ngcontent-%COMP%]{width:22px;height:22px;margin:0 3px 0 5px;vertical-align:bottom}.message[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%], .message[_ngcontent-%COMP%]   .committer[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]{font-size:18px}.message[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]{font-size:16px}.files[_ngcontent-%COMP%]{flex:10 1 auto;margin:10px;white-space:nowrap;overflow:auto}.files[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{margin-right:5px}.files[_ngcontent-%COMP%]   .material-icons.red[_ngcontent-%COMP%]{color:#ef5350}.files[_ngcontent-%COMP%]   .material-icons.green[_ngcontent-%COMP%]{color:#4caf50}.files[_ngcontent-%COMP%]   .material-icons.orange[_ngcontent-%COMP%]{color:#cb8837}.files[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%]{margin-left:-16px;margin-right:-16px}.files[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{display:flex;height:22px;cursor:pointer;line-height:22px;padding-left:16px;padding-right:16px;position:relative;overflow:hidden;text-overflow:ellipsis}.files[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li.selected[_ngcontent-%COMP%]{background-color:#616161}.files[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover   .buttons[_ngcontent-%COMP%]{opacity:1}.files[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{user-select:none}.files[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:calc(100% - 19px)}.files[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{position:absolute;top:0;right:16px;opacity:0;transition:.2s ease-in-out opacity}.files[_ngcontent-%COMP%] > ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:22px;line-height:22px;margin-left:5px;font-size:16px;background-color:#607d8bd9}"],changeDetection:0}),o})();var zt=s(98798);function Kt(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"app-diff-view",8),t.NdJ("closed",function(){return t.CHM(e),t.oxw().selectedFile.next(null)}),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("@slideLeft",void 0)("patch",e.selectedPatch)}}const Wt=[{path:"",component:(()=>{class o extends((0,k.j)(R.A,st.H)){constructor(e,n){super(),this.store=e,this.commitsApi=n,this.ongoingEdit=new M.X(null),this.selectedCommitId=new M.X(null),this.selectedFile=new M.X(null),this.selectedCommitHasChild=new M.X(!1),this.selectedCommitHasParent=new M.X(!1),this.branchesViewMinSize=rt.q,this.refresh=()=>{const i=this.store.selectSnapshot(Q.E.selectedRepositoryPath);i&&this.commitsApi.getOngoingEdit(i).subscribe(a=>{this.ongoingEdit.next(a)})}}ngOnInit(){super.ngOnInit(),this.refresh(),this.selectedCommit=(0,O.aj)([this.selectedRepository,this.selectedCommitId,this.ongoingEdit]).pipe((0,p.w)(([e,n])=>e&&n?this.commitsApi.getCommit(e.path,n):(0,at.of)(null)),(0,B.d)(1)),this.selectedPatch=(0,O.aj)([this.selectedRepository,this.selectedCommit,this.selectedFile]).pipe((0,V.U)(([e,n,i])=>{if(!e||!n||!i)return null;const a=n.diffs?.[0].patches.find(r=>r.oldFilePath===i.oldFilePath&&r.newFilePath===i.newFilePath);return a?{repositoryPath:e.path,patch:a,isUnstaged:!1}:null}),(0,B.d)(1)),(0,O.aj)([this.ongoingEdit,this.selectedCommit]).pipe((0,A.R)(this.destroyed$)).subscribe(([e,n])=>{if(e&&n){const i=e.commitIds.indexOf(n.id);this.selectedCommitHasChild.next(i>0),this.selectedCommitHasParent.next(i<e.commitIds.length-1)}else this.selectedCommitHasChild.next(!1),this.selectedCommitHasParent.next(!1)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Z.yh),t.Y36(I.T))},o.\u0275cmp=t.Xpm({type:o,selectors:[["ng-component"]],features:[t.qOj],decls:9,vars:16,consts:[[3,"repository","selectedCommit","selectedCommitHasChild","selectedCommitHasParent","changeCommit"],["id","default-layout"],[1,"left-cell",3,"min"],[1,"center-cell"],[3,"repository","selectedCommitId","ongoingEdit","changeCommit"],[3,"patch","closed",4,"ngIf"],["min","355px",1,"right-cell"],[3,"repository","selectedCommit","selectedFile","selectedCommitHasChild","selectedCommitHasParent","changeCommit","changeFile"],[3,"patch","closed"]],template:function(e,n){1&e&&(t.TgZ(0,"app-rebase-action-view",0),t.NdJ("changeCommit",function(a){return n.selectedCommitId.next(a),n.refresh()}),t.qZA(),t.TgZ(1,"app-grid",1),t._UZ(2,"app-grid-cell",2),t.TgZ(3,"app-grid-cell",3),t.TgZ(4,"app-rebase-view",4),t.NdJ("changeCommit",function(a){return n.selectedCommitId.next(a),n.refresh()}),t.qZA(),t.YNc(5,Kt,1,2,"app-diff-view",5),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"app-grid-cell",6),t.TgZ(8,"app-rebase-detail-view",7),t.NdJ("changeCommit",function(a){return n.selectedCommitId.next(a),n.refresh()})("changeFile",function(a){return n.selectedFile.next(a)}),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.Q6J("repository",n.selectedRepository)("selectedCommit",n.selectedCommit)("selectedCommitHasChild",n.selectedCommitHasChild)("selectedCommitHasParent",n.selectedCommitHasParent),t.xp6(2),t.Q6J("min",n.branchesViewMinSize),t.xp6(2),t.Q6J("repository",n.selectedRepository)("selectedCommitId",n.selectedCommitId)("ongoingEdit",n.ongoingEdit),t.xp6(1),t.Q6J("ngIf",t.lcZ(6,14,n.selectedPatch)),t.xp6(3),t.Q6J("repository",n.selectedRepository)("selectedCommit",n.selectedCommit)("selectedFile",n.selectedFile)("selectedCommitHasChild",n.selectedCommitHasChild)("selectedCommitHasParent",n.selectedCommitHasParent))},directives:[pt,j.M,X.Y,Ut,h.O5,Xt,zt.s],pipes:[h.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:calc(100% - 50px)}app-rebase-action-view[_ngcontent-%COMP%]{height:50px}app-rebase-view[_ngcontent-%COMP%]{position:absolute;top:0;left:0;overflow:hidden}app-diff-view[_ngcontent-%COMP%]{z-index:200}.center-cell[_ngcontent-%COMP%] >.grid-cell-wrapper>.grid-cell-border{z-index:500}.center-cell[_ngcontent-%COMP%] >.grid-cell-wrapper>.grid-cell-content{overflow:hidden}.right-cell[_ngcontent-%COMP%] >.grid-cell-wrapper>.grid-cell-border{z-index:500}"],data:{animation:[(0,P.X$)("slideLeft",[(0,P.eR)(":enter",[(0,P.oB)({position:"absolute",top:0,left:0,transform:"translateX(100%)"}),(0,P.jt)("200ms",(0,P.oB)({transform:"translateX(0)"}))]),(0,P.eR)(":leave",[(0,P.oB)({position:"absolute",top:0,left:0,transform:"translateX(0)"}),(0,P.jt)("200ms",(0,P.oB)({transform:"translateX(100%)"}))])])]},changeDetection:0}),(0,$.gn)([(0,Z.Ph)(Q.E.selectedRepository)],o.prototype,"selectedRepository",void 0),o})()}];let Gt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[D.Bz.forChild(Wt)],D.Bz]}),o})(),te=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[W.ie,G.LD,Y.I,tt.c,et.m,nt.P,it,ct.Z,Gt]]}),o})()}}]);