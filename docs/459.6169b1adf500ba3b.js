"use strict";(self.webpackChunkgit_glint=self.webpackChunkgit_glint||[]).push([[459],{5459:(it,E,i)=>{i.r(E),i.d(E,{SearchLayoutModule:()=>j});var I=i(3179),x=i(5412),P=i(7084),C=i(9549),N=i(284),D=i(8255),F=i(1572),M=i(7093),st=i(7072),t=i(4650);class w{static{this.\u0275fac=function(e){return new(e||w)}}static{this.\u0275mod=t.oAB({type:w})}static{this.\u0275inj=t.cJS({imports:[x.Is,P.To,C.lN,N.c,D.Tx,F.Cq,I.I,M.v,st.m]})}}var _=i(2367),z=i(7579),y=i(8926),T=i(9967),at=i(4745),R=i(4006),Z=i(1135),W=i(9841),lt=i(8372),G=i(9300),$=i(8675),H=i(2722),m=i(4454),h=i(9867),d=i(6895),V=i(4859),Y=i(7392),J=i(266),K=i(4442);const ct=["input"];function rt(a,o){if(1&a&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Oqu(e.searchTextControl.getError("regex"))}}function pt(a,o){1&a&&t._UZ(0,"mat-spinner",12)}const mt=function(a){return{count:a}};function ht(a,o){if(1&a&&(t.TgZ(0,"div",10),t.YNc(1,pt,1,0,"mat-spinner",11),t._uU(2),t.ALo(3,"translate"),t.ALo(4,"translate"),t.qZA()),2&a){const e=o.ngIf;t.xp6(1),t.Q6J("ngIf","ongoing"===e),t.xp6(1),t.hij(" ",e?"ongoing"===e?t.lcZ(3,2,"Searching..."):t.xi3(4,4,"Found _count_ results",t.VKq(7,mt,e.found)):"","\n")}}class U extends((0,y.j)(T.A)){constructor(o,e){super(),this.router=o,this.store=e,this.searchTextControl=new R.NI(this.store.selectSnapshot(m.po.searchText),{nonNullable:!0,validators:n=>{if(this.useRegularExpressionControl?.value)try{new RegExp(n.value,"g")}catch(s){return{regex:s.message}}return null}}),this.matchCaseControl=new R.NI(!1,{nonNullable:!0}),this.useRegularExpressionControl=new R.NI(!1,{nonNullable:!0}),this.searchStatus=new Z.X(null)}ngOnInit(){this.inputElement.nativeElement.focus(),(0,W.a)([this.searchTextControl.valueChanges.pipe((0,lt.b)(200),(0,G.h)(()=>this.searchTextControl.valid),(0,$.O)(this.searchTextControl.value)),this.matchCaseControl.valueChanges.pipe((0,$.O)(this.matchCaseControl.value)),this.useRegularExpressionControl.valueChanges.pipe((0,$.O)(this.useRegularExpressionControl.value))]).pipe((0,H.R)(this.destroyed$)).subscribe(([o,e,n])=>{this.searchTextControl.updateValueAndValidity({emitEvent:!1}),this.searchStatus.next(o?"ongoing":null),this.store.dispatch(new m.ol(o,e,n))}),this.completed.pipe((0,H.R)(this.destroyed$)).subscribe(o=>{this.searchStatus.next(null===o?this.searchTextControl.value?"ongoing":null:{found:o})})}close(){this.router.navigate(["/standard/default"])}clear(){this.searchTextControl.value?this.searchTextControl.setValue(""):(this.store.dispatch(new m.ol("",this.matchCaseControl.value,this.useRegularExpressionControl.value)),this.close())}static{this.\u0275fac=function(e){return new(e||U)(t.Y36(_.F0),t.Y36(h.yh))}}static{this.\u0275cmp=t.Xpm({type:U,selectors:[["app-search-action-view"]],viewQuery:function(e,n){if(1&e&&t.Gf(ct,7,t.SBq),2&e){let s;t.iGM(s=t.CRH())&&(n.inputElement=s.first)}},inputs:{completed:"completed"},features:[t.qOj],decls:25,vars:24,consts:[["matPrefix",""],["type","text","matInput","",3,"formControl","placeholder"],["input",""],["type","button","matSuffix","","mat-button","","disableRipple","",3,"matTooltip","click"],["svgIcon","format-letter-case"],["svgIcon","regex"],["type","button","matSuffix","","mat-button","",3,"matTooltip","click"],[4,"ngIf"],["class","result-text",4,"ngIf"],["type","button","mat-icon-button","",1,"close-button","app-icon-button-md",3,"click"],[1,"result-text"],["diameter","24",4,"ngIf"],["diameter","24"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"mat-icon",0),t._uU(5,"search"),t.qZA(),t._UZ(6,"input",1,2),t.ALo(8,"translate"),t.TgZ(9,"button",3),t.NdJ("click",function(){return n.matchCaseControl.setValue(!n.matchCaseControl.value)}),t.ALo(10,"translate"),t._UZ(11,"mat-icon",4),t.qZA(),t.TgZ(12,"button",3),t.NdJ("click",function(){return n.useRegularExpressionControl.setValue(!n.useRegularExpressionControl.value)}),t.ALo(13,"translate"),t._UZ(14,"mat-icon",5),t.qZA(),t.TgZ(15,"button",6),t.NdJ("click",function(){return n.clear()}),t.ALo(16,"translate"),t.TgZ(17,"mat-icon"),t._uU(18,"close"),t.qZA()(),t.YNc(19,rt,2,1,"mat-error",7),t.qZA(),t.YNc(20,ht,5,9,"div",8),t.ALo(21,"async"),t.TgZ(22,"button",9),t.NdJ("click",function(){return n.close()}),t.TgZ(23,"mat-icon"),t._uU(24,"close"),t.qZA()()),2&e&&(t.xp6(2),t.Oqu(t.lcZ(3,12,"Find")),t.xp6(4),t.s9C("placeholder",t.lcZ(8,14,"Enter search text...")),t.Q6J("formControl",n.searchTextControl),t.xp6(3),t.ekj("selected",n.matchCaseControl.value),t.Q6J("matTooltip",t.lcZ(10,16,"Match case")),t.xp6(3),t.ekj("selected",n.useRegularExpressionControl.value),t.Q6J("matTooltip",t.lcZ(13,18,"Use regular expression")),t.xp6(3),t.Q6J("matTooltip",t.lcZ(16,20,"Clear")),t.xp6(4),t.Q6J("ngIf",n.searchTextControl.hasError("regex")),t.xp6(1),t.Q6J("ngIf",t.lcZ(21,22,n.searchStatus)))},dependencies:[C.KE,C.hX,C.TO,C.qo,C.R9,N.Nt,F.Ou,d.O5,R.Fj,R.JJ,R.oH,V.lW,V.RK,Y.Hw,J.gM,d.Ov,K.X],styles:["[_nghost-%COMP%]{position:relative;display:block;text-align:center;padding:10px 5px 5px;height:69px}mat-form-field[_ngcontent-%COMP%]  .mat-mdc-form-field-icon-suffix{display:flex;align-items:center;gap:4px;margin-right:9px}mat-form-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:2px solid transparent;min-width:36px}mat-form-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin:0;font-size:24px;width:24px;height:24px}.result-text[_ngcontent-%COMP%]{display:inline-flex;gap:10px;align-items:center;position:absolute;top:calc(50% - 8px);margin-left:10px}.close-button[_ngcontent-%COMP%]{position:absolute;right:20px;top:calc(50% - 18px)}.dark-theme[_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%]{border-color:#78909c}.light-theme[_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%]{border-color:#78909c}"],changeDetection:0})}}var dt=i(1848),gt=i(515),ut=i(3900),ft=i(262),q=i(8746),tt=i(3825),xt=i(2120),Ct=i(5938),O=i(6966),Ot=i(3779),vt=i(7016);class S{constructor(o){this.baseApi=o}search(o,e,n,s,l){return this.baseApi.stream(Ot.w.search.onSearchResult,o,e,n,s,l)}static{this.\u0275fac=function(e){return new(e||S)(t.LFG(vt._))}}static{this.\u0275prov=t.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"})}}var B=i(655),g=i(4883),L=i(2270),v=i(4889),Pt=i(6406),et=i(1884),Mt=i(9468);class X{constructor(o,e){this.itemWidth=o,this.itemHeight=e,this.containerSize=new Z.X([0,0]),this.index$=new z.x,this.resizeObserver=new ResizeObserver(n=>{n[0]&&this.containerSize.next([n[0].contentRect.width,n[0].contentRect.height])}),this.viewport=null,this.scrolledIndexChange=this.index$.pipe((0,et.x)()),this.containerSize.pipe((0,Mt.p)(20,Pt.Z,{leading:!0,trailing:!0})).subscribe(([n,s])=>{if(this.viewport){const l=Math.floor(n/this.itemWidth),c=Math.ceil(this.viewport.getDataLength()/l);this.viewport.setTotalContentSize(c*this.itemHeight),this.viewport.checkViewportSize(),this.updateRenderedRange(this.viewport)}})}attach(o){this.index$=new z.x,this.scrolledIndexChange=this.index$.pipe((0,et.x)()),this.viewport=o,this.resizeObserver.disconnect(),this.resizeObserver.observe(o.elementRef.nativeElement),this.containerSize.next([o.elementRef.nativeElement.clientWidth,o.elementRef.nativeElement.clientHeight]);const e=Math.floor(this.containerSize.value[0]/this.itemWidth),n=Math.ceil(o.getDataLength()/e);o.setTotalContentSize(n*this.itemHeight),this.updateRenderedRange(o)}detach(){this.index$.complete(),this.resizeObserver.disconnect(),this.viewport=null}onContentScrolled(){this.viewport&&this.updateRenderedRange(this.viewport)}onDataLengthChanged(){if(this.viewport){const o=Math.floor(this.containerSize.value[0]/this.itemWidth),e=Math.ceil(this.viewport.getDataLength()/o);this.viewport.setTotalContentSize(e*this.itemHeight),this.updateRenderedRange(this.viewport)}}onContentRendered(){if(this.viewport){const{start:o}=this.viewport.getRenderedRange();this.viewport.setRenderedContentOffset(this.getOffsetForIndex(o))}}onRenderedOffsetChanged(){this.viewport&&this.updateRenderedRange(this.viewport)}scrollToIndex(o,e){this.viewport&&this.viewport.scrollToOffset(this.getOffsetForIndex(o),e)}getOffsetForIndex(o){const e=Math.floor(this.containerSize.value[0]/this.itemWidth);return Math.ceil(o/e)*this.itemHeight}getIndexForOffset(o,e=!0){const n=Math.floor(o/this.itemHeight),s=Math.floor(this.containerSize.value[0]/this.itemWidth);return n*s+(e?0:s-1)}updateRenderedRange(o){const e=2*this.itemHeight,n=4*this.itemHeight,s=o.getViewportSize(),l=o.measureScrollOffset(),{start:c,end:r}=o.getRenderedRange(),p={start:c,end:r},u=this.getIndexForOffset(l),f=l-this.getOffsetForIndex(c),A=this.getOffsetForIndex(r)-(l+s);f<e&&0!==c&&(p.start=Math.max(0,this.getIndexForOffset(l-n))),A<e&&r!==o.getDataLength()&&(p.end=Math.min(this.getIndexForOffset(l+s+n,!1),o.getDataLength())),o.setRenderedRange(p),o.setRenderedContentOffset(this.getOffsetForIndex(p.start)),this.index$.next(u)}}var nt=i(3546),ot=i(3051);function wt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"li")(1,"mat-card",3)(2,"div",4),t._uU(3),t.qZA(),t.TgZ(4,"div",5)(5,"div",6),t._UZ(6,"app-avatar",7),t.ALo(7,"async"),t._uU(8),t.qZA(),t.TgZ(9,"div",8),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.gotoCommit(l.id))}),t._uU(10),t.qZA()()()()}if(2&a){const e=o.$implicit,n=t.oxw();t.xp6(2),t.Q6J("matTooltip",e.message),t.xp6(1),t.Oqu(e.message),t.xp6(2),t.Q6J("matTooltip",e.authorName+" ("+e.authorEmail+")"),t.xp6(1),t.Q6J("remotes",t.lcZ(7,8,n.remotes))("email",e.authorEmail),t.xp6(2),t.hij(" ",e.authorName," "),t.xp6(1),t.Q6J("matTooltip",e.id),t.xp6(1),t.Oqu(e.id)}}let _t=(()=>{class a extends((0,y.j)(T.A)){constructor(e,n){super(),this.router=e,this.store=n}trackByCommits(e,n){return n.id}gotoCommit(e,n){const s=this.store.selectSnapshot(O.E.selectedRepositoryPath);if(!s)throw new L.uX;this.store.dispatch([new v.jQ(s,e),...n?[new v.gt(s,{area:"commit",oldFilePath:n.oldPath,newFilePath:n.newPath})]:[],new v.BK(s,e)]).subscribe(()=>{this.router.navigate(["/standard/default"])})}static{this.\u0275fac=function(n){return new(n||a)(t.Y36(_.F0),t.Y36(h.yh))}}static{this.\u0275cmp=t.Xpm({type:a,selectors:[["app-commit-search-results-view"]],inputs:{commitResults:"commitResults"},features:[t._Bn([{provide:g.yU,useValue:new X(310,135)}]),t.qOj],decls:4,vars:4,consts:[[1,"item-list-container"],[1,"main-list"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["appearance","outlined"],[1,"message",3,"matTooltip"],[1,"bottom"],[1,"author",3,"matTooltip"],[3,"remotes","email"],[1,"commit-id",3,"matTooltip","click"]],template:function(n,s){1&n&&(t.TgZ(0,"cdk-virtual-scroll-viewport",0)(1,"ul",1),t.YNc(2,wt,11,10,"li",2),t.ALo(3,"async"),t.qZA()()),2&n&&(t.xp6(2),t.Q6J("cdkVirtualForOf",t.lcZ(3,2,s.commitResults))("cdkVirtualForTrackBy",s.trackByCommits))},dependencies:[g.x0,g.N7,nt.a8,J.gM,ot.A,d.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.main-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:-5px 5px -5px -5px;padding-right:8px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin:5px;height:125px;width:300px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;gap:10px;height:125px;width:300px;padding:16px;overflow:hidden}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{overflow:hidden;display:-webkit-box;text-overflow:ellipsis;-webkit-line-clamp:3;-webkit-box-orient:vertical;font-weight:700}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{margin-right:20px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:170px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   app-avatar[_ngcontent-%COMP%]{width:22px;height:22px;margin-right:3px;vertical-align:middle}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]   .commit-id[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;min-height:20px;width:80px}"],changeDetection:0})}}return(0,B.gn)([(0,h.Ph)(O.E.selectedRemotes)],a.prototype,"remotes",void 0),a})();var yt=i(4924),Tt=i(790),Rt=i(9131),Zt=i(5410);const At=["fileSnippetDialog"];function Ft(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"li",8),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.openFileSnippetPopup(l))}),t.TgZ(1,"div",9),t._UZ(2,"app-avatar",10),t.ALo(3,"async"),t.TgZ(4,"span",11),t._uU(5),t.qZA()(),t.TgZ(6,"div",12),t._uU(7),t.qZA()()}if(2&a){const e=o.$implicit,n=t.oxw(2);t.xp6(1),t.Q6J("matTooltip",e.authorName+" ("+e.authorEmail+")"),t.xp6(1),t.Q6J("remotes",t.lcZ(3,6,n.remotes))("email",e.authorEmail),t.xp6(3),t.Oqu(e.authorName),t.xp6(1),t.Q6J("matTooltip",e.commitMessage+"\n"+e.commitId),t.xp6(1),t.Oqu(e.commitMessage)}}function St(a,o){if(1&a&&(t.TgZ(0,"li")(1,"mat-card",4),t._UZ(2,"app-condensed-path",5),t.TgZ(3,"ul",6),t.YNc(4,Ft,8,8,"li",7),t.qZA()()()),2&a){const e=o.$implicit,n=t.oxw();t.xp6(2),t.Q6J("path",e.path),t.xp6(2),t.Q6J("ngForOf",e.snippets)("ngForTrackBy",n.trackByFileSnippets)}}function bt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"div",13),t._UZ(1,"app-condensed-path",5),t.TgZ(2,"button",14)(3,"mat-icon"),t._uU(4,"close"),t.qZA()()(),t.TgZ(5,"mat-dialog-content",15)(6,"div",16)(7,"div",17),t._uU(8),t.qZA(),t.TgZ(9,"div",18)(10,"div",9),t._UZ(11,"app-avatar",10),t.ALo(12,"async"),t.TgZ(13,"span",11),t._uU(14),t.qZA()(),t.TgZ(15,"div",19),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.gotoCommit(l.result.commitId,l.result))})("contextmenu",function(){const l=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.copyToClipboard(l.result.commitId))}),t._uU(16),t.qZA()()(),t.TgZ(17,"div",20),t.ALo(18,"async"),t._UZ(19,"app-diff-view",21),t.qZA()(),t.TgZ(20,"mat-dialog-actions")(21,"button",22),t._uU(22),t.ALo(23,"translate"),t.qZA(),t.TgZ(24,"button",23),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.gotoCommit(l.result.commitId,l.result))}),t._uU(25),t.ALo(26,"translate"),t.qZA(),t.TgZ(27,"button",24),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.blameFile(l.result))}),t._uU(28),t.ALo(29,"translate"),t.qZA()()}if(2&a){const e=o.$implicit,n=t.oxw();t.xp6(1),t.Q6J("path",e.result.oldPath||e.result.newPath),t.xp6(1),t.Q6J("mat-dialog-close",!1),t.xp6(6),t.Oqu(e.result.commitMessage),t.xp6(2),t.Q6J("matTooltip",e.result.authorName+" ("+e.result.authorEmail+")"),t.xp6(1),t.Q6J("remotes",t.lcZ(12,22,n.remotes))("email",e.result.authorEmail),t.xp6(3),t.Oqu(e.result.authorName),t.xp6(1),t.Q6J("matTooltip",e.result.commitId)("mat-dialog-close",!0),t.xp6(1),t.Oqu(e.result.commitId),t.xp6(1),t.Q6J("ngClass",t.lcZ(18,24,n.theme)+"-theme"),t.xp6(2),t.Q6J("patch",e.patch)("hideClose",!0)("search",e.search),t.xp6(2),t.Q6J("mat-dialog-close",!1),t.xp6(1),t.Oqu(t.lcZ(23,26,"Cancel")),t.xp6(2),t.Q6J("matTooltip",e.result.commitId)("mat-dialog-close",!0),t.xp6(1),t.Oqu(t.lcZ(26,28,"Goto commit")),t.xp6(2),t.Q6J("mat-dialog-close",!0)("matTooltip",e.result.newPath),t.xp6(1),t.Oqu(t.lcZ(29,30,"Blame file"))}}let Et=(()=>{class a extends((0,y.j)(T.A)){constructor(e,n,s,l){super(),this.router=e,this.dialog=n,this.store=s,this.commitsApi=l}trackByFiles(e,n){return n.path}trackByFileSnippets(e,n){return n.commitId}gotoCommit(e,n){const s=this.store.selectSnapshot(O.E.selectedRepositoryPath);if(!s)throw new L.uX;this.store.dispatch([new v.jQ(s,e),...n?[new v.gt(s,{area:"commit",oldFilePath:n.oldPath,newFilePath:n.newPath})]:[],new v.BK(s,e)]).subscribe(()=>{this.router.navigate(["/standard/default"])})}openFileSnippetPopup(e){const n=this.store.selectSnapshot(O.E.selectedRepositoryPath);if(!n)throw new L.uX;this.commitsApi.getPatch(n,e.commitId,e.oldPath,e.newPath).subscribe(s=>{this.dialog.open(this.fileSnippetDialog,{data:{result:e,patch:new Z.X({repositoryPath:n,patch:s,isUnstaged:!1}),search:{text:this.store.selectSnapshot(m.po.searchText),matchCase:this.store.selectSnapshot(m.po.matchCase),useRegularExpression:this.store.selectSnapshot(m.po.useRegularExpression)}}})})}copyToClipboard(e){navigator.clipboard.writeText(e??"").then(()=>{})}blameFile(e){this.router.navigate(["/standard/blame"],{queryParams:{area:"commit","commit-id":e.commitId,path:e.newPath}})}static{this.\u0275fac=function(n){return new(n||a)(t.Y36(_.F0),t.Y36(x.uw),t.Y36(h.yh),t.Y36(Tt.T))}}static{this.\u0275cmp=t.Xpm({type:a,selectors:[["app-file-search-results-view"]],viewQuery:function(n,s){if(1&n&&t.Gf(At,5),2&n){let l;t.iGM(l=t.CRH())&&(s.fileSnippetDialog=l.first)}},inputs:{fileResults:"fileResults"},features:[t._Bn([{provide:g.yU,useValue:new X(310,160)}]),t.qOj],decls:6,vars:4,consts:[[1,"item-list-container"],[1,"main-list"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["fileSnippetDialog",""],["appearance","outlined"],[1,"path",3,"path"],[1,"sub-list"],[3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],[1,"author",3,"matTooltip"],[3,"remotes","email"],[1,"name"],[1,"message",3,"matTooltip"],["mat-dialog-title","",1,"snippet-dialog-title"],["type","button","mat-icon-button","",1,"app-icon-button-md",3,"mat-dialog-close"],[1,"snippet-dialog"],[1,"top"],[1,"message"],[1,"right"],[1,"id",3,"matTooltip","mat-dialog-close","click","contextmenu"],[1,"diff",3,"ngClass"],[3,"patch","hideClose","search"],["type","button","mat-button","","cdkFocusInitial","",3,"mat-dialog-close"],["type","button","mat-button","","color","primary",3,"matTooltip","mat-dialog-close","click"],["type","button","mat-button","","color","accent",3,"mat-dialog-close","matTooltip","click"]],template:function(n,s){1&n&&(t.TgZ(0,"cdk-virtual-scroll-viewport",0)(1,"ul",1),t.YNc(2,St,5,3,"li",2),t.ALo(3,"async"),t.qZA()(),t.YNc(4,bt,30,32,"ng-template",null,3,t.W1O)),2&n&&(t.xp6(2),t.Q6J("cdkVirtualForOf",t.lcZ(3,2,s.fileResults))("cdkVirtualForTrackBy",s.trackByFiles))},dependencies:[x.ZT,x.uh,x.xY,x.H8,g.x0,g.N7,d.mk,d.sg,V.lW,V.RK,nt.a8,Y.Hw,J.gM,ot.A,Rt.j,Zt.s,d.Ov,K.X],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.main-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:-5px 5px -5px -5px;padding-right:8px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin:5px;height:150px;width:300px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;padding:16px;height:150px;width:300px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .path[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .sub-list[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .sub-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{cursor:pointer;display:flex;gap:10px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .sub-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:0 0 80px;display:flex;align-items:center;gap:5px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .sub-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   app-avatar[_ngcontent-%COMP%]{width:18px;height:18px;flex:0 0 auto}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .sub-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .sub-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}.snippet-dialog-title[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-top:10px}.snippet-dialog[_ngcontent-%COMP%]{height:65vh;width:80vw;display:flex;flex-direction:column}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{margin-right:40px;white-space:pre;max-height:100px;overflow:auto;flex:100 0 auto;padding-right:5px}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{overflow:hidden;min-width:80px;max-width:200px}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:0 0 80px;display:flex;align-items:center;gap:8px;margin-bottom:5px}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   app-avatar[_ngcontent-%COMP%]{width:24px;height:24px;flex:0 0 auto}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{cursor:pointer;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.snippet-dialog[_ngcontent-%COMP%]   .diff[_ngcontent-%COMP%]{position:relative;padding:10px 10px 0;overflow:hidden;flex:1 0 auto}.snippet-dialog[_ngcontent-%COMP%]   .diff.dark-theme[_ngcontent-%COMP%]{background:#1e1e1e}.snippet-dialog[_ngcontent-%COMP%]   .diff.light-theme[_ngcontent-%COMP%]{background:#fafafa}.snippet-dialog[_ngcontent-%COMP%]   .diff[_ngcontent-%COMP%]   app-diff-view[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}}return(0,B.gn)([(0,h.Ph)(O.E.selectedRemotes)],a.prototype,"remotes",void 0),(0,B.gn)([(0,h.Ph)(yt.$.theme)],a.prototype,"theme",void 0),a})();function It(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"li",3),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.gotoCommit(l.commitId))}),t.TgZ(1,"mat-icon",4),t._uU(2),t.qZA(),t.TgZ(3,"span",4),t._uU(4),t.qZA()()}if(2&a){const e=o.$implicit,n=t.oxw();t.xp6(1),t.Q6J("matTooltip",e.sourceName),t.xp6(1),t.Oqu(n.getBranchTypeIcon(e.type)),t.xp6(1),t.Q6J("matTooltip",e.refName),t.xp6(1),t.Oqu(e.shortName)}}let Nt=(()=>{class a extends((0,y.j)(T.A)){constructor(e,n){super(),this.router=e,this.store=n,this.getBranchTypeIcon=s=>{switch(s){case"local":return"desktop_windows";case"remote":return"cloud_queue";case"tag":return"label"}}}trackByReferences(e,n){return n.refName}gotoCommit(e){const n=this.store.selectSnapshot(O.E.selectedRepositoryPath);if(!n)throw new L.uX;this.store.dispatch([new v.jQ(n,e),new v.BK(n,e)]).subscribe(()=>{this.router.navigate(["/standard/default"])})}static{this.\u0275fac=function(n){return new(n||a)(t.Y36(_.F0),t.Y36(h.yh))}}static{this.\u0275cmp=t.Xpm({type:a,selectors:[["app-reference-search-results-view"]],inputs:{referenceResults:"referenceResults"},features:[t._Bn([{provide:g.yU,useValue:new X(220,34)}]),t.qOj],decls:5,vars:4,consts:[[1,"item-list-container"],[1,"main-list"],[3,"click",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[3,"click"],[3,"matTooltip"]],template:function(n,s){1&n&&(t.TgZ(0,"cdk-virtual-scroll-viewport",0)(1,"div",0)(2,"ul",1),t.YNc(3,It,5,4,"li",2),t.ALo(4,"async"),t.qZA()()()),2&n&&(t.xp6(3),t.Q6J("cdkVirtualForOf",t.lcZ(4,2,s.referenceResults))("cdkVirtualForTrackBy",s.trackByReferences))},dependencies:[g.x0,g.N7,Y.Hw,J.gM,d.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.main-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:0 -10px;padding-right:8px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin:5px 10px;cursor:pointer;width:200px;height:24px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:5px}"],changeDetection:0})}}return(0,B.gn)([(0,h.Ph)(O.E.selectedRemotes)],a.prototype,"remotes",void 0),a})();var Vt=i(744);function Jt(a,o){if(1&a&&(t.TgZ(0,"mat-expansion-panel",4)(1,"mat-expansion-panel-header"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"app-reference-search-results-view",5),t.qZA()),2&a){const e=o.ngIf,n=t.oxw();t.xp6(2),t.AsE("",t.lcZ(3,3,"References")," (",e.length,")"),t.xp6(2),t.Q6J("referenceResults",n.referenceResults)}}function Ut(a,o){if(1&a&&(t.TgZ(0,"mat-expansion-panel",6)(1,"mat-expansion-panel-header"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"app-commit-search-results-view",7),t.qZA()),2&a){const e=o.ngIf,n=t.oxw();t.xp6(2),t.AsE("",t.lcZ(3,3,"Commits")," (",e.length,")"),t.xp6(2),t.Q6J("commitResults",n.commitResults)}}function Bt(a,o){if(1&a&&(t.TgZ(0,"mat-expansion-panel",8)(1,"mat-expansion-panel-header"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"app-file-search-results-view",9),t.qZA()),2&a){const e=o.ngIf,n=t.oxw();t.xp6(2),t.AsE("",t.lcZ(3,3,"Files")," (",e.length,")"),t.xp6(2),t.Q6J("fileResults",n.fileResults)}}class Q extends((0,y.j)(T.A)){constructor(o,e){super(),this.store=o,this.searchApi=e,this.completed=new t.vpe,this.referenceResults=new Z.X([]),this.commitResults=new Z.X([]),this.fileResults=new Z.X([])}ngOnInit(){(0,W.a)([this.store.select(m.po.searchText),this.store.select(m.po.matchCase),this.store.select(m.po.useRegularExpression),this.store.select(O.E.selectedRepositoryPath).pipe((0,G.h)(xt.$K))]).pipe((0,ut.w)(([o,e,n,s])=>(this.referenceResults.next([]),this.commitResults.next([]),this.fileResults.next([]),this.completed.next(null),o?this.searchApi.search(s,e,n,o).pipe((0,ft.K)(l=>(this.store.dispatch(new Ct.hx("error",`${l}`)),gt.E)),(0,q.x)(()=>{this.completed.next(this.referenceResults.value.length+this.commitResults.value.length+this.fileResults.value.length)})):dt.C)),(0,q.x)(()=>{this.completed.next(null)}),(0,H.R)(this.destroyed$)).subscribe(o=>{switch(o.type){case"reference":const e=this.formatReferenceResult(o);e&&this.referenceResults.next([...this.referenceResults.value,e]);break;case"commit":this.commitResults.next([...this.commitResults.value,o]);break;case"file":this.fileResults.next(this.addFileResult(this.fileResults.value,o))}})}formatReferenceResult(o){const n=/^refs\/heads\/(.*)$/.exec(o.refName);if(n)return{type:"local",refName:o.refName,shortName:n[1]??"",sourceName:(0,tt.Iu)("local"),commitId:o.commitId};const l=/^refs\/remotes\/([^\/]+)\/(.*)$/.exec(o.refName);if(l)return{type:"remote",refName:o.refName,shortName:l[2]??"",sourceName:l[1]??"",commitId:o.commitId};const r=/^refs\/tags\/(.*)$/.exec(o.refName);return r?{type:"tag",refName:o.refName,shortName:r[1]??"",sourceName:(0,tt.Iu)("tag"),commitId:o.commitId}:null}addFileResult(o,e){const n=!!e.oldPath,s=!!e.newPath;let l=null,c=null,r=null,p=null;for(let f=0;f<o.length;f++){const A=o[f];if(A.path===e.oldPath&&(l=f),A.path===e.newPath&&(c=f),e.oldPath&&A.path>e.oldPath&&(r=f),e.newPath&&A.path>e.newPath&&(p=f),!(n&&null===l&&null===r||s&&null===c&&null===p))break}let u=o;return n&&s?null!==l||null===r||null!==p&&r>p?(u=this.addFileSnippet(o,e,l,r),u=this.addFileSnippet(o,e,c,p)):(u=this.addFileSnippet(o,e,c,p),u=this.addFileSnippet(o,e,l,r)):n?u=this.addFileSnippet(o,e,l,r):s&&(u=this.addFileSnippet(o,e,c,p)),u}addFileSnippet(o,e,n,s){if(null!==n){const l=o[n];if(l)return[...o.slice(0,n),{...l,snippets:[...l.snippets,e]},...o.slice(n+1)]}else if(null!==s)return[...o.slice(0,s),{path:e.newPath??e.oldPath??"",snippets:[e]},...o.slice(s)];return[...o,{path:e.newPath??e.oldPath??"",snippets:[e]}]}static{this.\u0275fac=function(e){return new(e||Q)(t.Y36(h.yh),t.Y36(S))}}static{this.\u0275cmp=t.Xpm({type:Q,selectors:[["app-search-results-view"]],outputs:{completed:"completed"},features:[t.qOj],decls:10,vars:15,consts:[["multi",""],["class","references","expanded","",4,"ngIf"],["class","commits","expanded","",4,"ngIf"],["class","files","expanded","",4,"ngIf"],["expanded","",1,"references"],[3,"referenceResults"],["expanded","",1,"commits"],[3,"commitResults"],["expanded","",1,"files"],[3,"fileResults"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-accordion",0),t.YNc(1,Jt,5,5,"mat-expansion-panel",1),t.ALo(2,"nullEmpty"),t.ALo(3,"async"),t.YNc(4,Ut,5,5,"mat-expansion-panel",2),t.ALo(5,"nullEmpty"),t.ALo(6,"async"),t.YNc(7,Bt,5,5,"mat-expansion-panel",3),t.ALo(8,"nullEmpty"),t.ALo(9,"async"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,3,t.lcZ(3,5,n.referenceResults))),t.xp6(3),t.Q6J("ngIf",t.lcZ(5,7,t.lcZ(6,9,n.commitResults))),t.xp6(3),t.Q6J("ngIf",t.lcZ(8,11,t.lcZ(9,13,n.fileResults))))},dependencies:[P.pp,P.ib,P.yz,d.O5,_t,Et,Nt,d.Ov,Vt.x,K.X],styles:["[_nghost-%COMP%]{display:block;height:calc(100% - 69px)}mat-accordion[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%}mat-expansion-panel[_ngcontent-%COMP%]{flex-shrink:3;display:flex;flex-direction:column;min-height:48px;background:transparent!important;box-shadow:none!important}mat-expansion-panel.mat-expansion-panel-spacing[_ngcontent-%COMP%]{min-height:96px}mat-expansion-panel.mat-expansion-panel-spacing[_ngcontent-%COMP%] + mat-expansion-panel.mat-expansion-panel-spacing[_ngcontent-%COMP%]{margin:0 0 16px}mat-expansion-panel.mat-expansion-panel-spacing.files[_ngcontent-%COMP%]{margin-bottom:0!important}mat-expansion-panel.mat-expanded.references[_ngcontent-%COMP%]{min-height:99px}mat-expansion-panel.mat-expanded.commits[_ngcontent-%COMP%]{min-height:216.75px}mat-expansion-panel.mat-expanded.files[_ngcontent-%COMP%]{min-height:248px}mat-expansion-panel[_ngcontent-%COMP%]   .references[_ngcontent-%COMP%]{flex-shrink:1}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{height:48px;padding:0 20px;font-size:20px;flex:0 0 auto}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header.mat-expanded[_ngcontent-%COMP%]{height:48px}mat-expansion-panel[_ngcontent-%COMP%]     .mat-expansion-panel-content{overflow:hidden}mat-expansion-panel[_ngcontent-%COMP%]     .mat-expansion-panel-content.ng-animating .item-list-container{overflow-y:hidden}mat-expansion-panel[_ngcontent-%COMP%]     .mat-expansion-panel-content .mat-expansion-panel-body{display:flex;flex-direction:column;overflow:hidden;padding:0 0 0 24px}mat-expansion-panel[_ngcontent-%COMP%]     .item-list-container{contain:content;scrollbar-gutter:stable}mat-expansion-panel[_ngcontent-%COMP%]     .item-list-container   .cdk-virtual-scroll-spacer{position:relative}"],changeDetection:0})}}class b extends((0,y.j)(T.A,at.H)){constructor(){super(...arguments),this.completed=new z.x}static{this.\u0275fac=function(){let o;return function(n){return(o||(o=t.n5z(b)))(n||b)}}()}static{this.\u0275cmp=t.Xpm({type:b,selectors:[["ng-component"]],features:[t.qOj],decls:2,vars:1,consts:[[3,"completed"]],template:function(e,n){1&e&&(t._UZ(0,"app-search-action-view",0),t.TgZ(1,"app-search-results-view",0),t.NdJ("completed",function(l){return n.completed.next(l)}),t.qZA()),2&e&&t.Q6J("completed",n.completed)},dependencies:[U,Q],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:calc(100% - 50px)}"],changeDetection:0})}}const Lt=[{path:"",component:b}];class k{static{this.\u0275fac=function(e){return new(e||k)}}static{this.\u0275mod=t.oAB({type:k})}static{this.\u0275inj=t.cJS({imports:[_.Bz.forChild(Lt),_.Bz]})}}class j{static{this.\u0275fac=function(e){return new(e||j)}}static{this.\u0275mod=t.oAB({type:j})}static{this.\u0275inj=t.cJS({imports:[I.I,k,w]})}}},7093:(it,E,i)=>{i.d(E,{v:()=>M});var I=i(5412),x=i(9549),P=i(284),C=i(1572),N=i(4385),D=i(3179),F=i(4650);class M{static{this.\u0275fac=function(w){return new(w||M)}}static{this.\u0275mod=F.oAB({type:M})}static{this.\u0275inj=F.cJS({imports:[I.Is,x.lN,P.c,C.Cq,N.LD,D.I]})}}}}]);