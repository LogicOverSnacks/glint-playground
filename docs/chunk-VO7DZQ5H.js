import{b as St,c as vt,d as bt,e as fe}from"./chunk-RDAFQ6G7.js";import{a as B}from"./chunk-UCZQN7KN.js";import{D as Ie,m,n as F,w as te}from"./chunk-XFRRWCWM.js";import{$ as gt,$g as Dt,$i as Xt,Aa as I,Ae as xt,B as Pe,Bd as ze,Be as $e,Bf as yt,Bg as ne,Bi as At,Cg as Vt,D as le,Dg as tt,E as Qe,Ea as Ct,Ei as jt,G as Te,Ga as ae,Gb as xe,Gf as Lt,Gg as pe,Hb as Se,Hi as Ht,I as we,Ia as x,Ib as ce,J as dt,Jg as ln,Ki as ge,La as h,Li as Wt,Ma as $,Mb as de,Mf as It,Mi as Qt,Nf as Je,Ni as Le,O as pt,Oi as Ut,Pi as zt,Q as Ee,Qf as Ce,Qg as Tt,R as ht,Rd as Xe,Rf as Ye,S as re,Sd as qe,Sf as Ze,Sg as nt,T as v,Th as $t,U as Oe,Ua as f,Va as M,W as ut,Wa as N,Wh as Ae,Xa as K,Xg as Et,Ya as ee,Yh as Rt,Zf as kt,_ as De,_a as q,a as V,ab as z,b as U,ba as Ne,bb as S,bd as wt,bh as Nt,d as on,da as se,ea as ft,ga as mt,gb as R,hb as A,hh as he,i as at,ia as W,ib as j,ig as Re,ih as ue,j as X,ja as Q,jb as Mt,kb as y,kh as ye,lb as k,lh as ie,me as Ot,mg as Ke,n as He,ne as Ge,pa as Ue,ph as Bt,q as L,qa as _t,qb as Pt,r as oe,s as D,sa as Z,sg as et,t as Y,ub as _,v as Ve,vb as P,vf as ve,w as We,wb as me,wg as Ft,xb as _e,yb as Be,yf as G,yi as je,z as ct,za as p,zf as be}from"./chunk-LQ6WPIKI.js";var qt=(()=>{class l{constructor(e,t,n){this.store=e,this.repositoriesApi=t,this.stashApi=n,this.discardAllChanges=i=>this.store.dispatch(new te(i,{name:"Discard",detail:ie("All changes"),do:o=>{let r=this.store.selectSnapshot(Ie.openRepositoryIds);return this.stashApi.saveWorkingCopyState(i).pipe(le(()=>(o(),L(""))),re(s=>this.repositoriesApi.discardAllChanges(i).pipe(le(u=>ze.matches(u)?oe(()=>new nt(u)):oe(()=>u)),B(u=>{let a=u?.filter(c=>r.includes(c))??[];return this.store.dispatch([...a.map(c=>new F(c,[m.currentBranch,m.currentBranchCommitId,m.headCommitId])),new F(i,[m.unstagedChanges,m.submodules])]).pipe(D(()=>[a,s]))}))))},undo:([o,r])=>this.stashApi.restoreWorkingCopyState(i,r).pipe(B(()=>this.store.dispatch([...o.map(s=>new F(s,[m.currentBranch,m.currentBranchCommitId,m.headCommitId])),new F(i,[m.unstagedChanges,m.submodules])])))})),this.discardFiles=(i,o)=>this.store.dispatch(new te(i,{name:"Discard",detail:o.map(r=>r.newFilePath??r.oldFilePath).join(", "),do:r=>{let s=this.store.selectSnapshot(Ie.openRepositoryIds);return this.stashApi.saveWorkingCopyState(i,o.map(u=>u.newFilePath??u.oldFilePath).filter(Tt)).pipe(le(()=>(r(),L(""))),re(u=>this.repositoriesApi.discardFiles(i,o).pipe(le(a=>ze.matches(a)?oe(()=>new nt(a)):oe(()=>a)),B(a=>{let c=a?.filter(d=>s.includes(d))??[];return this.store.dispatch([...c.map(d=>new F(d,[m.currentBranch,m.currentBranchCommitId,m.headCommitId])),new F(i,[m.unstagedChanges,m.submodules])]).pipe(D(()=>[c,u]))}))))},undo:([r,s])=>this.stashApi.restoreWorkingCopyState(i,s).pipe(B(()=>this.store.dispatch([...r.map(u=>new F(u,[m.currentBranch,m.currentBranchCommitId,m.headCommitId])),new F(i,[m.unstagedChanges,m.submodules])])))})),this.discardFileLines=(i,o,r,s)=>this.store.dispatch(new te(i,{name:"Discard lines",detail:ie("In _name_",{name:r??o}),do:()=>this.repositoriesApi.discardFileLines(i,o,r,s).pipe(B(()=>this.store.dispatch(new F(i,[m.unstagedChanges,m.submodules]))))})),this.stageAllChanges=i=>this.store.dispatch(new te(i,{name:"Stage",detail:ie("All changes"),do:()=>this.repositoriesApi.getUnstagedChanges(i).pipe(re(o=>this.repositoriesApi.stageAllChanges(i).pipe(B(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))),B(()=>L(o))))),undo:o=>this.repositoriesApi.unstageFiles(i,o).pipe(B(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))))})),this.stageFiles=(i,o)=>this.store.dispatch(new te(i,{name:"Stage",detail:o.map(r=>r.newFilePath??r.oldFilePath).join(", "),do:()=>this.repositoriesApi.stageFiles(i,o).pipe(B(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules])))),undo:()=>this.repositoriesApi.unstageFiles(i,o).pipe(B(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))))})),this.stageFileLines=(i,o,r,s)=>this.store.dispatch(new te(i,{name:"Stage lines",detail:ie("In _name_",{name:r??o}),do:()=>this.repositoriesApi.stageFileLines(i,o,r,s).pipe(B(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))))})),this.unstageAllChanges=i=>this.store.dispatch(new te(i,{name:"Unstage",detail:ie("All changes"),do:()=>this.repositoriesApi.getStagedChanges(i).pipe(re(o=>this.repositoriesApi.unstageAllChanges(i).pipe(B(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))),B(()=>L(o))))),undo:o=>this.repositoriesApi.stageFiles(i,o).pipe(B(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))))})),this.unstageFiles=(i,o)=>this.store.dispatch(new te(i,{name:"Unstage",detail:o.map(r=>r.newFilePath??r.oldFilePath).join(", "),do:()=>this.repositoriesApi.unstageFiles(i,o).pipe(B(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules])))),undo:()=>this.repositoriesApi.stageFiles(i,o).pipe(B(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))))})),this.unstageFileLines=(i,o,r,s)=>this.store.dispatch(new te(i,{name:"Unstage lines",detail:ie("In _name_",{name:r??o}),do:()=>this.repositoriesApi.unstageFileLines(i,o,r,s).pipe(B(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))))}))}static{this.\u0275fac=function(t){return new(t||l)(Ne(Re),Ne(Dt),Ne(Nt))}}static{this.\u0275prov=De({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();var cn=["contextMenu"];function dn(l,g){if(l&1&&(N(0,"app-condensed-path",15),_(1,"async")),l&2){let e=S(2);h("path",P(1,1,e.filePath))}}function pn(l,g){if(l&1){let e=q();f(0,"button",16),_(1,"translate"),z("click",function(){W(e);let n=S(2);return Q(n.modifyLinesStage("stage"))}),N(2,"mat-icon",17),M()}l&2&&h("matTooltip",P(1,1,"Stage selected lines"))}function hn(l,g){if(l&1){let e=q();f(0,"button",18),_(1,"translate"),z("click",function(){W(e);let n=S(2);return Q(n.modifyLinesStage("discard"))}),N(2,"mat-icon",19),M()}l&2&&h("matTooltip",P(1,1,"Discard selected lines"))}function un(l,g){if(l&1){let e=q();f(0,"button",20),_(1,"translate"),z("click",function(){W(e);let n=S(2);return Q(n.modifyLinesStage("unstage"))}),N(2,"mat-icon",21),M()}l&2&&h("matTooltip",P(1,1,"Unstage selected lines"))}function gn(l,g){if(l&1){let e=q();f(0,"button",22),z("click",function(){W(e);let n=S(2);return Q(n.edited.next())}),f(1,"mat-icon"),y(2,"edit"),M()()}}function fn(l,g){if(l&1){let e=q();f(0,"button",23),z("click",function(){W(e);let n=S(2);return Q(n.closed.next())}),f(1,"mat-icon"),y(2,"close"),M()()}}function mn(l,g){l&1&&(f(0,"main"),y(1),_(2,"translate"),M()),l&2&&(p(),k(P(2,1,"Loading...")))}function _n(l,g){l&1&&(f(0,"main"),y(1),_(2,"translate"),M()),l&2&&(p(),k(P(2,1,"Cannot load binary file.")))}function Cn(l,g){l&1&&(f(0,"main"),y(1),_(2,"translate"),M()),l&2&&(p(),k(P(2,1,"Cannot load file.")))}function Mn(l,g){if(l&1&&N(0,"app-hunk-view",25),l&2){let e=S(3);h("diffLines",e.diffLines)}}function Pn(l,g){if(l&1&&N(0,"app-inline-view",25),l&2){let e=S(3);h("diffLines",e.diffLines)}}function wn(l,g){if(l&1&&N(0,"app-split-view",25),l&2){let e=S(3);h("diffLines",e.diffLines)}}function On(l,g){if(l&1&&(f(0,"main"),x(1,Mn,1,1,"app-hunk-view",24)(2,Pn,1,1,"app-inline-view",24)(3,wn,1,1,"app-split-view",24),M()),l&2){let e=S().ngIf;p(),h("ngIf",e==="hunk"),p(),h("ngIf",e==="inline"),p(),h("ngIf",e==="split")}}function xn(l,g){if(l&1){let e=q();K(0),f(1,"header")(2,"app-find-control",2),_(3,"async"),z("focusin",function(){W(e);let n=S();return Q(n.findControlHasFocus$.next(!0))})("focusout",function(){W(e);let n=S();return Q(n.findControlHasFocus$.next(!1))}),M(),x(4,dn,2,3,"app-condensed-path",3),_(5,"async"),_(6,"async"),f(7,"div",4),x(8,pn,3,3,"button",5),_(9,"async"),x(10,hn,3,3,"button",6),_(11,"async"),x(12,un,3,3,"button",7),_(13,"async"),f(14,"mat-button-toggle-group",8),z("change",function(n){W(e);let i=S();return Q(i.changeView(n.value))}),f(15,"mat-button-toggle",9),_(16,"translate"),f(17,"mat-icon"),y(18,"calendar_view_day"),M()(),f(19,"mat-button-toggle",10),_(20,"translate"),f(21,"mat-icon"),y(22,"view_headline"),M()(),f(23,"mat-button-toggle",11),_(24,"translate"),f(25,"mat-icon"),y(26,"vertical_split"),M()()(),f(27,"div",12),x(28,gn,3,0,"button",13)(29,fn,3,0,"button",14),M()()(),x(30,mn,3,3,"main",1),_(31,"async"),x(32,_n,3,3,"main",1),_(33,"async"),x(34,Cn,3,3,"main",1),_(35,"async"),x(36,On,4,3,"main",1),_(37,"async"),ee()}if(l&2){let e=g.ngIf,t=S();p(2),h("@showFindControl",P(3,16,t.showFindControl))("initial",t.search),p(2),h("ngIf",!(P(5,18,t.showStage)||P(6,20,t.showUnstage))),p(4),h("ngIf",P(9,22,t.showStage)),p(2),h("ngIf",P(11,24,t.showStage)),p(2),h("ngIf",P(13,26,t.showUnstage)),p(2),h("value",e),p(),h("matTooltip",P(16,28,"Hunk View")),p(4),h("matTooltip",P(20,30,"Inline View")),p(4),h("matTooltip",P(24,32,"Split View")),p(5),h("ngIf",t.showEdit),p(),h("ngIf",!t.hideClose),p(),h("ngIf",P(31,34,t.currentView)==="loading"),p(2),h("ngIf",P(33,36,t.currentView)==="binary-file"),p(2),h("ngIf",P(35,38,t.currentView)==="error"),p(2),h("ngIf",P(37,40,t.currentView)==="normal")}}function Sn(l,g){if(l&1){let e=q();f(0,"button",28),_(1,"translate"),z("click",function(){W(e);let n=S(2);return n.modifyLinesStage("stage"),Q(n.closeContextMenu())}),N(2,"mat-icon",17),f(3,"span"),y(4),_(5,"translate"),M()()}l&2&&(h("matTooltip",P(1,2,"Stage selected lines")),p(4),k(P(5,4,"Stage")))}function vn(l,g){if(l&1){let e=q();f(0,"button",28),_(1,"translate"),z("click",function(){W(e);let n=S(2);return n.modifyLinesStage("discard"),Q(n.closeContextMenu())}),N(2,"mat-icon",17),f(3,"span"),y(4),_(5,"translate"),M()()}l&2&&(h("matTooltip",P(1,2,"Discard selected lines")),p(4),k(P(5,4,"Discard")))}function bn(l,g){if(l&1){let e=q();f(0,"button",28),_(1,"translate"),z("click",function(){W(e);let n=S(2);return n.modifyLinesStage("unstage"),Q(n.closeContextMenu())}),N(2,"mat-icon",17),f(3,"span"),y(4),_(5,"translate"),M()()}l&2&&(h("matTooltip",P(1,2,"Unstage selected lines")),p(4),k(P(5,4,"Unstage")))}function yn(l,g){if(l&1&&(f(0,"div",26),x(1,Sn,6,6,"button",27),_(2,"async"),x(3,vn,6,6,"button",27),_(4,"async"),x(5,bn,6,6,"button",27),_(6,"async"),M()),l&2){let e=S();p(),h("ngIf",P(2,3,e.showStage)),p(2),h("ngIf",P(4,5,e.showStage)),p(2),h("ngIf",P(6,7,e.showUnstage))}}var Gt=(()=>{class l extends he(ue){constructor(e,t,n,i,o,r,s,u){super(),this.viewContainerRef=e,this.breakpointObserver=t,this.overlay=n,this.store=i,this.highlightApi=o,this.findSelectionService=r,this.diffSelectionService=s,this.stagingActionsService=u,this.hideClose=!1,this.showEdit=!1,this.search=null,this.closed=new Ue,this.edited=new Ue,this.currentView=new X("loading"),this.diffLines=new X(null),this.findControlHasFocus$=new X(!1),this.showFindControl=Y([this.findSelectionService.searchRegex,this.findControlHasFocus$,this.breakpointObserver.observe([$e.XSmall,$e.Small,$e.Medium])]).pipe(D(([a,c,d])=>!!a||c||!d.matches)),this.searchMatchesCount=new X(0),this.matchClicked=new at,this.overlayRef=null,this.closeContextMenu=()=>{this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null)}}ngOnInit(){this.showStage=Y([this.patch,this.selectedCommitId,this.diffSelectionService.selectedFileLines]).pipe(D(([e,t,n])=>t==="head"&&e?.isUnstaged===!0&&!e.patch.newFileIsSubmodule&&!e.patch.oldFileIsSubmodule&&n.length>0)),this.showUnstage=Y([this.patch,this.selectedCommitId,this.diffSelectionService.selectedFileLines]).pipe(D(([e,t,n])=>t==="head"&&e?.isUnstaged===!1&&!e.patch.newFileIsSubmodule&&!e.patch.oldFileIsSubmodule&&n.length>0)),this.diffSelectionService.contextMenuOpened.pipe(v(this.destroyed$)).subscribe(e=>{this.closeContextMenu(),Y([this.showStage,this.showUnstage]).pipe(Te(1),v(this.destroyed$)).subscribe(([t,n])=>{(t||n)&&(this.overlayRef=this.overlay.create({positionStrategy:this.overlay.position().flexibleConnectedTo({x:e.x,y:e.y}).withPositions([{originX:"end",originY:"bottom",overlayX:"start",overlayY:"top"}])}),this.overlayRef.attach(new yt(this.menuTemplate,this.viewContainerRef)),ct(this.diffSelectionService.selectedRange.pipe(Ee(1)),Ht(this.overlayRef)).pipe(Te(1),v(this.destroyed$)).subscribe(()=>this.closeContextMenu()))})}),this.filePath=this.patch.pipe(D(e=>e?.patch.newFilePath??e?.patch.oldFilePath??"")),this.patch.pipe(dt((e,t)=>!e||!t?!e&&!t:!(e.repositoryPath!==t.repositoryPath||e.isUnstaged!==t.isUnstaged||e.patch.newFileId!==t.patch.newFileId||e.patch.newFileIsDir!==t.patch.newFileIsDir||e.patch.newFileIsSubmodule!==t.patch.newFileIsSubmodule||e.patch.newFilePath!==t.patch.newFilePath||e.patch.oldFileId!==t.patch.oldFileId||e.patch.oldFileIsDir!==t.patch.oldFileIsDir||e.patch.oldFileIsSubmodule!==t.patch.oldFileIsSubmodule||e.patch.oldFilePath!==t.patch.oldFilePath||e.patch.status!==t.patch.status||e.patch.hunks.length!==t.patch.hunks.length||pe(e.patch.hunks,t.patch.hunks).some(([n,i])=>n?.lines.length!==i?.lines.length||n?.newStart!==i?.newStart||n?.oldStart!==i?.oldStart||n?.header!==i?.header||n&&i&&pe(n.lines,i.lines).some(([o,r])=>o?.content.length!==r?.content.length||o?.newLineNo!==r?.newLineNo||o?.oldLineNo!==r?.oldLineNo||o?.origin!==r?.origin||o?.content!==r?.content)))),Oe(()=>{this.currentView.next("loading")}),re(e=>e?Ve(this.getLines(e,!1)).pipe(v(this.currentView.pipe(Ee(1),Pe(t=>t==="loading"))),v(this.destroyed$),D(([t,n])=>[e,t,n]),le(t=>Xe.matches(t)?(this.currentView.next("binary-file"),L(null)):qe.matches(t)?(this.currentView.next("error"),L(null)):oe(()=>t))):L(null)),Oe(e=>{if(e){let[t,n,i]=e;this.diffLines.next({hunks:t.patch.hunks,oldLines:n,newLines:i,oldFilePath:t.patch.oldFilePath,newFilePath:t.patch.newFilePath,highlighted:!1}),this.currentView.next("normal")}else this.diffLines.next(null)}),re(e=>e?.[0]?Ve(this.getLines(e?.[0],!0)).pipe(v(this.currentView.pipe(Ee(1),Pe(t=>t==="loading"))),v(this.destroyed$),D(([t,n])=>[e?.[0],t,n]),le(t=>Xe.matches(t)?(this.currentView.next("binary-file"),L(null)):qe.matches(t)?(this.currentView.next("error"),L(null)):oe(()=>t))):L(null)),v(this.destroyed$)).subscribe(e=>{if(e){let[t,n,i]=e;this.diffLines.next({hunks:t.patch.hunks,oldLines:n,newLines:i,oldFilePath:t.patch.oldFilePath,newFilePath:t.patch.newFilePath,highlighted:!0}),this.currentView.next("normal")}else this.diffLines.next(null)})}changeView(e){this.store.dispatch(new Bt(e))}modifyLinesStage(e){let t=this.store.selectSnapshot(Ie.selectedRepositoryPath);if(!t)throw new wt;this.patch.pipe(Te(1)).subscribe(n=>{if(!n||!n.patch.oldFilePath)return;let i=[t,n.patch.oldFileId?n.patch.oldFilePath:null,n.patch.newFileId?n.patch.newFilePath:null,this.diffSelectionService.selectedFileLines.value];switch(e){case"discard":this.stagingActionsService.discardFileLines(...i).subscribe();break;case"stage":this.stagingActionsService.stageFileLines(...i).subscribe();break;default:this.stagingActionsService.unstageFileLines(...i).subscribe();break}})}getLines(e,t){if(e.patch.oldFileIsSubmodule||e.patch.newFileIsSubmodule){if(e.patch.hunks.length<=0)return[L([]),L([])];let n=e.patch.hunks[0]?.lines.find(o=>o.oldLineNo>0),i=e.patch.hunks[0]?.lines.find(o=>o.newLineNo>0);return[L([{lineNumber:1,text:n?.content??"",tokens:[{startIndex:0,endIndex:n?.content.length??0,scopes:["normal"]}]}]),L([{lineNumber:1,text:i?.content??"",tokens:[{startIndex:0,endIndex:i?.content.length??0,scopes:["normal"]}]}])]}return[e.patch.oldFileId?this.highlightApi.getHighlightedFile(e.repositoryPath,e.patch.oldFileId,e.patch.oldFilePath,t):L([]),e.isUnstaged?this.highlightApi.getHighlightedFile(e.repositoryPath,null,e.patch.newFilePath,t):e.patch.newFileId?this.highlightApi.getHighlightedFile(e.repositoryPath,e.patch.newFileId,e.patch.newFilePath,t):L([])]}static{this.\u0275fac=function(t){return new(t||l)(I(Ct),I(xt),I(Lt),I(Re),I(Et),I(ge),I(fe),I(qt))}}static{this.\u0275cmp=se({type:l,selectors:[["app-diff-view"]],viewQuery:function(t,n){if(t&1&&R(cn,5),t&2){let i;A(i=j())&&(n.menuTemplate=i.first)}},inputs:{patch:"patch",hideClose:"hideClose",showEdit:"showEdit",search:"search"},outputs:{closed:"closed",edited:"edited"},features:[ae],decls:4,vars:3,consts:[["contextMenu",""],[4,"ngIf"],[3,"focusin","focusout","initial"],[3,"path",4,"ngIf"],[1,"right"],["type","button","class","stage-button","mat-stroked-button","",3,"matTooltip","click",4,"ngIf"],["type","button","class","discard-button","mat-stroked-button","","color","warn",3,"matTooltip","click",4,"ngIf"],["type","button","class","unstage-button","mat-stroked-button","",3,"matTooltip","click",4,"ngIf"],[3,"change","value"],["value","hunk",3,"matTooltip"],["value","inline",3,"matTooltip"],["value","split",3,"matTooltip"],[1,"close-container"],["type","button","mat-icon-button","","class","edit-button app-icon-button-md",3,"click",4,"ngIf"],["type","button","mat-icon-button","","class","close-button app-icon-button-md",3,"click",4,"ngIf"],[3,"path"],["type","button","mat-stroked-button","",1,"stage-button",3,"click","matTooltip"],["svgIcon","tray-plus"],["type","button","mat-stroked-button","","color","warn",1,"discard-button",3,"click","matTooltip"],["svgIcon","tray-remove"],["type","button","mat-stroked-button","",1,"unstage-button",3,"click","matTooltip"],["svgIcon","tray-minus"],["type","button","mat-icon-button","",1,"edit-button","app-icon-button-md",3,"click"],["type","button","mat-icon-button","",1,"close-button","app-icon-button-md",3,"click"],[3,"diffLines",4,"ngIf"],[3,"diffLines"],[1,"menu-panel"],["type","button","class","menu-item",3,"matTooltip","click",4,"ngIf"],["type","button",1,"menu-item",3,"click","matTooltip"]],template:function(t,n){t&1&&(x(0,xn,38,42,"ng-container",1),_(1,"async"),x(2,yn,7,9,"ng-template",null,0,Be)),t&2&&h("ngIf",P(1,1,n.view))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;position:absolute}header[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:baseline;justify-content:space-between;margin-bottom:5px;outline:none;overflow-x:auto;overflow-y:hidden}header[_ngcontent-%COMP%]::-webkit-scrollbar{height:4px}header[_ngcontent-%COMP%]   app-find-control[_ngcontent-%COMP%]{min-width:340px;max-width:350px;overflow:hidden}header[_ngcontent-%COMP%]   app-condensed-path[_ngcontent-%COMP%]{min-width:150px}header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{display:flex;gap:5px;margin-left:auto}header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .stage-button[_ngcontent-%COMP%], header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .discard-button[_ngcontent-%COMP%], header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .unstage-button[_ngcontent-%COMP%]{height:40px}header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{height:40px}header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{font-size:0}header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]     .mat-button-toggle-label-content{line-height:38px;padding:0 6px}header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .close-container[_ngcontent-%COMP%]{display:flex;align-items:center;align-self:baseline;overflow:hidden;height:40px}main[_ngcontent-%COMP%]{flex:1 0 auto;outline:none;overflow-x:auto;overflow-y:auto}.dark-theme   [_nghost-%COMP%]{background:#1e1e1e}.light-theme   [_nghost-%COMP%]{background:#fafafa}"],data:{animation:[It("showFindControl",[Ye("true",Ce({opacity:1})),Ye("false",Ce({opacity:0,position:"absolute",height:0})),Ze("false -> true",[Ce({opacity:0,position:"relative",height:"*"}),Je("225ms ease-in-out",Ce({opacity:1}))]),Ze("true -> false",[Ce({opacity:1}),Je("225ms ease-in-out",Ce({opacity:0}))])])]},changeDetection:0})}}return He([Ke(Ie.selectedCommitId)],l.prototype,"selectedCommitId",void 0),He([Ke($t.diffView)],l.prototype,"view",void 0),l})();var J=on(ln());var ke=(()=>{class l{constructor(){this.calculateInlineLines=(e,t,n)=>{let i=[],o=0,r=0,s=[],u=(a,c)=>{(a>o||c>r)&&(i.push(...pe(e.slice(o,a),t.slice(r,c)).map(([d,C])=>({oldLine:d??null,newLine:C??null,status:"unchanged"}))),o=a,r=c)};for(let a of n){u(a.oldStart-1,a.newStart-1),[s,o,r]=this.calculateGroups(e,t,o,r,a);for(let c of s)c.type==="modified"?i.push(...c.lines.flatMap(d=>d.status==="replaced"?[U(V({},d),{status:"removed",newLine:null}),U(V({},d),{status:"added",oldLine:null})]:[d]).sort((d,C)=>d.status==="removed"&&C.status==="removed"?0:d.status==="removed"?-1:C.status==="removed"?1:0)):i.push(...c.lines)}return u(e.length,t.length),L(i)},this.calculateHunkLines=(e,t,n)=>{let i=[],o=0,r=0,s=[],u=(a,c,d)=>{(a>o||c>r)&&(i.push({isSeparator:!0,separatorHeader:d,hiddenDiffLines:pe(e.slice(o,a),t.slice(r,c)).map(([C,b])=>({oldLine:C??null,newLine:b??null,status:"unchanged"}))}),o=a,r=c)};for(let a of n){u(a.oldStart-1,a.newStart-1,a.header),[s,o,r]=this.calculateGroups(e,t,o,r,a);for(let c of s)c.type==="modified"?i.push(...c.lines.flatMap(d=>d.status==="replaced"?[{isSeparator:!1,diffLine:U(V({},d),{status:"removed",newLine:null})},{isSeparator:!1,diffLine:U(V({},d),{status:"added",oldLine:null})}]:[{isSeparator:!1,diffLine:d}]).sort((d,C)=>d.diffLine.status==="removed"&&C.diffLine.status==="removed"?0:d.diffLine.status==="removed"?-1:C.diffLine.status==="removed"?1:0)):i.push(...c.lines.map(d=>({isSeparator:!1,diffLine:d})))}return u(e.length,t.length,null),L(i)},this.calculateSplitLines=(e,t,n)=>{let i=[],o=0,r=0,s=[],u=(a,c)=>{(a>o||c>r)&&(i.push(...pe(e.slice(o,a),t.slice(r,c)).map(([d,C])=>({oldLine:d??null,newLine:C??null,status:"unchanged"}))),o=a,r=c)};for(let a of n){u(a.oldStart-1,a.newStart-1),[s,o,r]=this.calculateGroups(e,t,o,r,a);for(let c of s)i.push(...c.lines)}return u(e.length,t.length),L(i)},this.calculateMergeLines=(e,t,n,i,o)=>{let r=[],s=this.calculateSplitLines(e,t,i),u=this.calculateSplitLines(e,n,o);return Ve([s,u]).pipe(D(([a,c])=>{let d=1,C=0,b=0;for(;C<a.length&&b<c.length;){let w=a[C],T=c[b];if(!w.oldLine&&!T.oldLine)r.push({baseLine:null,yoursLine:w.newLine,yoursStatus:w.status,theirsLine:T.newLine,theirsStatus:T.status}),C++,b++;else if(!w.oldLine&&T.oldLine)r.push({baseLine:null,yoursLine:w.newLine,yoursStatus:w.status,theirsLine:null,theirsStatus:null}),C++;else if(w.oldLine&&!T.oldLine)r.push({baseLine:null,yoursLine:null,yoursStatus:null,theirsLine:T.newLine,theirsStatus:T.status}),b++;else if(w.oldLine&&T.oldLine){if(d!==w.oldLine.lineNumber||d!==T.oldLine.lineNumber)throw new Ot(w.oldLine.lineNumber,T.oldLine.lineNumber);r.push({baseLine:T.oldLine,yoursLine:w.newLine,yoursStatus:w.status,theirsLine:T.newLine,theirsStatus:T.status}),d++,C++,b++}}for(;C<a.length;){let w=a[C];r.push({baseLine:w.oldLine,yoursLine:w.newLine,yoursStatus:w.status,theirsLine:null,theirsStatus:null}),C++}for(;b<c.length;){let w=c[b];r.push({baseLine:w.oldLine,yoursLine:null,yoursStatus:null,theirsLine:w.newLine,theirsStatus:w.status}),b++}return r}))},this.calculateGroups=(e,t,n,i,o)=>{let r=o.lines.filter(d=>d.origin!==">"&&d.origin!=="<"),s=[],u=n,a=i,c=0;for(;c<r.length;)if(r[c]?.newLineNo===-1){let d=[];for(;c<r.length&&r[c]?.newLineNo===-1;){let C=e[u];C&&d.push(C),u++,c++}if(c<r.length&&r[c]?.oldLineNo===-1){let C=[];for(;c<r.length&&r[c]?.oldLineNo===-1;){let b=t[a];b&&C.push(b),a++,c++}s.push(this.createModifiedGroup(d,C))}else s.push({type:"removed",lines:d.map(C=>({oldLine:C,newLine:null,status:"removed"}))})}else if(r[c]?.oldLineNo===-1){let d=[];for(;c<r.length&&r[c]?.oldLineNo===-1;){let C=t[a];C&&d.push(C),a++,c++}if(c<r.length&&r[c]?.newLineNo===-1){let C=[];for(;c<r.length&&r[c]?.newLineNo===-1;){let b=e[u];b&&C.push(b),u++,c++}s.push(this.createModifiedGroup(C,d))}else s.push({type:"added",lines:d.map(C=>({oldLine:null,newLine:C,status:"added"}))})}else{let d=[],C=[];for(;c<r.length&&r[c]?.oldLineNo!==-1&&r[c]?.newLineNo!==-1;){let b=e[u];b&&d.push(b);let w=t[a];w&&C.push(w),u++,a++,c++}s.push({type:"unchanged",lines:pe(d,C).map(([b,w])=>({oldLine:b??null,newLine:w??null,status:"unchanged"}))})}return[s,u,a]},this.createModifiedGroup=(e,t)=>{let n=e.map(H=>H.text.replace(`
`,"")).join(`
`),i=t.map(H=>H.text.replace(`
`,"")).join(`
`),o=new J.diff_match_patch,r=o.diff_main(n,i);o.diff_cleanupSemantic(r);let s=[],u=0,a=0,c=null,d=null,C=[],b=[],w=[],T=H=>{H===J.DIFF_EQUAL?(s.push({status:c!==null&&d!==null?"replaced":c!==null?"removed":"added",oldLine:c!==null?U(V({},e[u]),{tokens:[...e[u]?.tokens??[],...C]}):null,newLine:d!==null?U(V({},t[a]),{tokens:[...t[a]?.tokens??[],...b]}):null}),u++,a++,c=null,d=null,C=[],b=[]):H===J.DIFF_INSERT?(c===null&&(s.push(...w),w=[]),(c===null?s:w).push({status:"added",oldLine:null,newLine:U(V({},t[a]),{tokens:[...t[a]?.tokens??[],...b]})}),a++,d=null,b=[]):H===J.DIFF_DELETE&&(d===null&&(s.push(...w),w=[]),(d===null?s:w).push({status:"removed",oldLine:U(V({},e[u]),{tokens:[...e[u]?.tokens??[],...C]}),newLine:null}),u++,c=null,C=[])};for(let[H,nn]of r){let O=nn.split(`
`);if(H===J.DIFF_EQUAL){if(O.length>1){s.push(...w),w=[],c!==null||d!==null?(c=(c??0)+(O[0]?.length??0),d=(d??0)+(O[0]?.length??0),T(H)):(s.push({status:"unchanged",oldLine:e[u],newLine:t[a]}),u++,a++);for(let E=1;E<O.length-1;E++)s.push({status:"unchanged",oldLine:e[u],newLine:t[a]}),u++,a++}c=(c??0)+(O[O.length-1]?.length??0),d=(d??0)+(O[O.length-1]?.length??0)}else if(H===J.DIFF_INSERT){if(O.length>1)if(d!==null){O[0]&&O[0].length>0&&b.push({startIndex:d??0,endIndex:(d??0)+O[0].length,scopes:["diff-added"]}),d=d+(O[0]?.length??0),T(H);for(let E=1;E<O.length-1;E++)(c===null?s:w).push({status:"added",oldLine:null,newLine:U(V({},t[a]),{tokens:[...t[a]?.tokens??[],{startIndex:0,endIndex:O[E]?.length??0,scopes:["diff-added"]}]})}),a++}else for(let E=0;E<O.length-1;E++)(c===null?s:w).push({status:"added",oldLine:null,newLine:U(V({},t[a]),{tokens:[...t[a]?.tokens??[],{startIndex:0,endIndex:O[E]?.length??0,scopes:["diff-added"]}]})}),a++;(O[O.length-1]?.length??0)>0&&b.push({startIndex:d??0,endIndex:(d??0)+(O[O.length-1]?.length??0),scopes:["diff-added"]}),d=(d??0)+(O[O.length-1]?.length??0)}else if(H===J.DIFF_DELETE){if(O.length>1)if(c!==null){(O[0]?.length??0)>0&&C.push({startIndex:c??0,endIndex:(c??0)+(O[0]?.length??0),scopes:["diff-removed"]}),c=c+(O[0]?.length??0),T(H);for(let E=1;E<O.length-1;E++)(d===null?s:w).push({status:"removed",oldLine:U(V({},e[u]),{tokens:[...e[u]?.tokens??[],{startIndex:0,endIndex:O[E]?.length??0,scopes:["diff-removed"]}]}),newLine:null}),u++}else for(let E=0;E<O.length-1;E++)(d===null?s:w).push({status:"removed",oldLine:U(V({},e[u]),{tokens:[...e[u]?.tokens??[],{startIndex:0,endIndex:O[E]?.length??0,scopes:["diff-removed"]}]}),newLine:null}),u++;(O[O.length-1]?.length??0)>0&&C.push({startIndex:c??0,endIndex:(c??0)+(O[O.length-1]?.length??0),scopes:["diff-removed"]}),c=(c??0)+(O[O.length-1]?.length??0)}}return s.push(...w),(c!==null||d!==null)&&(n.length===0&&(c=c??0),i.length===0&&(d=d??0),T(J.DIFF_EQUAL)),{type:"modified",lines:s}}}static{this.lineNumberCharacterWidth=8.3}static{this.lineNumberSpacing=10}calculateMargin(e,t=!1){return l.lineNumberSpacing+e*l.lineNumberCharacterWidth*(t?1:2)}getFileExtension(e){if(!e)return null;let t=e.lastIndexOf(".");return t>0?e.substring(t+1):null}static{this.\u0275fac=function(t){return new(t||l)}}static{this.\u0275prov=De({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();var Jt=1e4,Fe=(()=>{class l{constructor(){this.renderScopes=e=>e.map(t=>this.renderScope(t)).join(" "),this.areEqual=(e,t)=>{if(e.length!==t.length)return!1;let n=new Set(e);for(let i of t)if(!n.has(i))return!1;return!0}}transform(e,t=""){if(!t)return[];if(t.length>Jt)return[{class:"normal",text:t.slice(0,Jt)+ie("... Max line length reached!")}];let n=Vt(e,s=>s.startIndex),i=[],o=0,r=n.filter(s=>s.startIndex<=o&&s.endIndex>o);for(;o<t.length;){let s=n.filter(a=>a.startIndex<=o&&a.endIndex>o),u=o;for(;this.areEqual(r,s)&&o<t.length;)o++,s=n.filter(a=>a.startIndex<=o&&a.endIndex>o);i.push({class:this.renderScopes(r.map(a=>a.scopes)),text:t.substring(u,o)||`
`}),r=s}return i}renderScope(e){let t=e[e.length-1];if(!t)return"";let n=t.split(".");return ne(1,n.length+1).map(i=>n.slice(0,i).join("-")).join(" ")}static{this.\u0275fac=function(t){return new(t||l)}}static{this.\u0275pipe=mt({name:"tokens",type:l,pure:!0})}}return l})();var kn=["scrollContainer"],Fn=["code"];function Vn(l,g){if(l&1&&N(0,"span",9),l&2){let e=g.ngIf;$("left",e.left)("width",e.width)}}function Tn(l,g){if(l&1){let e=q();K(0),f(1,"button",10),z("click",function(){W(e);let n=S().$implicit,i=S();return Q(i.expandSeparator(n))}),f(2,"mat-icon",11),y(3),M()(),f(4,"span",12),y(5),M(),ee()}if(l&2){let e=S(),t=e.$implicit,n=e.first,i=e.last,o=S();p(),$("width",o.lineNumberMargin+26,"px"),p(2),k(n?"expand_less":i?"expand_more":"unfold_more"),p(2),k(t.separatorHeader)}}function En(l,g){if(l&1&&(f(0,"span",17),y(1),M()),l&2){let e=g.$implicit;h("ngClass",e.class),p(),k(e.text)}}function Dn(l,g){if(l&1&&(K(0),x(1,En,2,2,"span",16),_(2,"findToken"),_(3,"tokens"),ee()),l&2){let e=g.ngIf,t=S(2).index;p(),h("ngForOf",me(3,5,_e(2,1,e.tokens,e.text,t),e.text))}}function Nn(l,g){if(l&1&&(f(0,"span",13),y(1),M(),f(2,"span",14),y(3),M(),x(4,Dn,4,8,"ng-container",15)),l&2){let e=S().$implicit,t=S();$("right","calc(100% + 26px + "+(t.lineNumberMargin/2).toString()+"px)")("width",t.lineNumberMargin/2-5,"px"),p(),k(e.diffLine.oldLine==null?null:e.diffLine.oldLine.lineNumber),p(),$("width",t.lineNumberMargin/2-5,"px"),p(),k(e.diffLine.newLine==null?null:e.diffLine.newLine.lineNumber),p(),h("ngIf",t.getLineView(e.diffLine))}}function Bn(l,g){if(l&1&&(f(0,"li",6),x(1,Vn,1,4,"span",7),_(2,"async"),x(3,Tn,6,4,"ng-container",8)(4,Nn,5,9,"ng-template",null,2,Be),M()),l&2){let e=g.$implicit,t=g.index,n=Mt(5),i=S();h("ngClass","line-"+(e.isSeparator?"separator":e.diffLine.status)),p(),h("ngIf",P(2,4,i.getSelection(t))),p(2),h("ngIf",e.isSeparator)("ngIfElse",n)}}var Kt=(()=>{class l extends he(ue,ye){constructor(e,t,n){super(),this.diffService=e,this.diffSelectionService=t,this.findSelectionService=n,this.lineNumberMargin=0,this.lines$=new X([]),this.currentPatch=null,this.getSelection=i=>this.diffSelectionService.selectedRange.pipe(D(o=>{if(!o)return null;let[r,s]=o[0].line>o[1].line||o[0].line===o[1].line&&o[0].char>o[1].char?[o[1],o[0]]:o;return i<r.line||i>s.line?null:i===r.line?{left:`${r.char*this.diffSelectionService.charWidth}px`,width:r.line===s.line?`${(s.char-r.char)*this.diffSelectionService.charWidth}px`:"100%"}:i===s.line?{left:"0px",width:`${s.char*this.diffSelectionService.charWidth}px`}:{left:"0px",width:"100%"}}))}ngOnInit(){let e=this.scrollContainer.elementRef.nativeElement;this.diffLines.pipe(ht(null),pt(),we(0),v(this.destroyed$)).subscribe(([t,n])=>{let i=this.currentPatch?V({},this.currentPatch):null;if(n){this.currentPatch={newFilePath:n.newFilePath,oldFilePath:n.oldFilePath};let o=Ft([n.oldLines.length,n.newLines.length])??0;this.lineNumberMargin=this.diffService.calculateMargin(o.toString().length),this.diffService.calculateHunkLines(n.oldLines,n.newLines,n.hunks).pipe(v(this.destroyed$)).subscribe(r=>{t&&t.newFilePath===n.newFilePath&&t.oldFilePath===n.oldFilePath&&!t.highlighted&&n.highlighted?this.updateLines(r):this.lines$.next(r),(!i||i.oldFilePath!==this.currentPatch?.oldFilePath||i.newFilePath!==this.currentPatch?.newFilePath)&&this.scrollContainer.elementRef?.nativeElement?.scrollTo(0,0)})}else this.currentPatch=null,this.lineNumberMargin=0,this.lines$.next([]),i&&this.scrollContainer.elementRef?.nativeElement?.scrollTo(0,0)}),Y([this.lines$,this.findSelectionService.searchRegex]).pipe(v(this.destroyed$)).subscribe(([t,n])=>{if(!n){this.findSelectionService.setMatches([]);return}let i=t.map((o,r)=>[o.isSeparator?null:this.getLineView(o.diffLine),r]).flatMap(([o,r])=>o?Array.from(o.text.matchAll(n),s=>({lineId:r,startIndex:s.index??0,endIndex:(s.index??0)+(s[0]?.length??0)})):[]);this.findSelectionService.setMatches(i)}),this.findSelectionService.selectedMatch.pipe(v(this.destroyed$)).subscribe(t=>{if(!t||typeof t.lineId!="number")return;let n=this.lineNumberMargin+26+t.startIndex*this.diffSelectionService.charWidth,i=this.lineNumberMargin+26+t.endIndex*this.diffSelectionService.charWidth,o=e.scrollLeft,r=e.scrollLeft+e.clientWidth,s=n<o?n:n>r?i-e.clientWidth:e.scrollLeft;e.scrollTo(s,t.lineId*19)}),this.diffSelectionService.captureSelections(this.codeElement.nativeElement,(t,n)=>({line:Math.floor((e.scrollTop+n-e.getBoundingClientRect().top)/19),char:Math.max(0,Math.round((e.scrollLeft+t-e.getBoundingClientRect().left-(this.lineNumberMargin+26))/this.diffSelectionService.charWidth))}),(t,n)=>this.lines$.value.filter((i,o)=>o>=t&&o<=n).map(i=>i.isSeparator?i.separatorHeader??void 0:this.getLineView(i.diffLine)?.text),()=>{let t=this.lines$.value,n=t[t.length-1];return{line:t.length-1,char:n?(n.isSeparator?n.separatorHeader:this.getLineView(n.diffLine)?.text)?.length??0:0}},([t,n])=>ne(t.line,n.line+1).flatMap(i=>{let o=this.lines$.value[i];return!o||o.isSeparator?[]:[{oldLineNo:o.diffLine.oldLine?.lineNumber??-1,newLineNo:o.diffLine.newLine?.lineNumber??-1}]})).pipe(v(this.destroyed$)).subscribe()}expandSeparator(e){let n=this.lines$.value;this.lines$.next(n.flatMap((i,o)=>{if(i!==e)return i;if(e.hiddenDiffLines.length<=10*2+5)return e.hiddenDiffLines.map(a=>({isSeparator:!1,diffLine:a}));if(o===0)return[{isSeparator:!0,separatorHeader:e.separatorHeader,hiddenDiffLines:et(e.hiddenDiffLines,10*2)},...tt(e.hiddenDiffLines,10*2).map(a=>({isSeparator:!1,diffLine:a}))];if(o===n.length-1)return[...e.hiddenDiffLines.slice(0,10*2).map(a=>({isSeparator:!1,diffLine:a})),{isSeparator:!0,separatorHeader:null,hiddenDiffLines:e.hiddenDiffLines.slice(10*2)}];let r=e.hiddenDiffLines.slice(0,10),s=et(e.hiddenDiffLines.slice(10),10),u=tt(e.hiddenDiffLines,10);return[...r.map(a=>({isSeparator:!1,diffLine:a})),{isSeparator:!0,separatorHeader:e.separatorHeader,hiddenDiffLines:s},...u.map(a=>({isSeparator:!1,diffLine:a}))]}))}getLineView(e){return e.status==="added"?e.newLine:e.status==="removed"?e.oldLine:e.status==="unchanged"?e.newLine??e.oldLine:null}trackByHunkLine(e,t){return t.isSeparator?t.separatorHeader:`${t.diffLine.oldLine?.text}:::${t.diffLine.newLine?.text}`}updateLines(e){let t=this.lines$.value,n=0,i=0,o=[];for(;i<e.length;){let r=t[n],s=e[i];if(!r||!s)throw new Ge;if(s.isSeparator){if(r.isSeparator){if(r.hiddenDiffLines.length===s.hiddenDiffLines.length){o.push(s),n++,i++;continue}o.push({isSeparator:!0,separatorHeader:s.separatorHeader,hiddenDiffLines:s.hiddenDiffLines.slice(0,r.hiddenDiffLines.length)}),s.hiddenDiffLines=s.hiddenDiffLines.slice(r.hiddenDiffLines.length),n++;continue}let u=s.hiddenDiffLines[0];if(!u){i++;continue}o.push({isSeparator:!1,diffLine:u}),s.hiddenDiffLines=s.hiddenDiffLines.slice(1),n++;continue}if(!r.isSeparator){o.push(s),n++,i++;continue}throw new Ge}this.lines$.next(o)}static{this.\u0275fac=function(t){return new(t||l)(I(ke),I(fe),I(ge))}}static{this.\u0275cmp=se({type:l,selectors:[["app-hunk-view"]],viewQuery:function(t,n){if(t&1&&(R(kn,7),R(Fn,7,Z),R(G,5)),t&2){let i;A(i=j())&&(n.scrollContainer=i.first),A(i=j())&&(n.codeElement=i.first),A(i=j())&&(n.viewports=i)}},inputs:{diffLines:"diffLines"},features:[ae],decls:7,vars:9,consts:[["scrollContainer",""],["code",""],["diffLineContent",""],[1,"viewport",3,"itemSize","maxBufferPx","minBufferPx"],["tabindex","0",1,"vs-code-theme"],["class","line",3,"ngClass",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"line",3,"ngClass"],["class","selection",3,"left","width",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"selection"],["mat-button","",1,"separator-icon",3,"click"],["inline",""],[1,"separator-header"],[1,"old-line-number"],[1,"new-line-number"],[4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(t,n){t&1&&(f(0,"cdk-virtual-scroll-viewport",3,0)(2,"code",4,1)(4,"ul"),x(5,Bn,6,6,"li",5),_(6,"async"),M()()()),t&2&&(h("itemSize",19)("maxBufferPx",1e3)("minBufferPx",200),p(4),$("margin-left",n.lineNumberMargin+26,"px"),p(),h("cdkVirtualForOf",P(6,7,n.lines$))("cdkVirtualForTrackBy",n.trackByHunkLine))},dependencies:[ve,be,G,xe,Se,ce,Ae,je,de,Le,Fe],styles:['code[_ngcontent-%COMP%]{display:block;white-space:pre;user-select:none;cursor:text;outline:none}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]{position:absolute;text-align:right;user-select:none}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{right:calc(100% + 26px)}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{position:absolute;display:block;height:19px;opacity:.5}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]{right:100%}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]{cursor:pointer;height:19px;line-height:19px;padding:0;text-align:center;min-width:0}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:0;height:100%;width:100%;z-index:-1}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{line-height:19px}.viewport[_ngcontent-%COMP%]{height:100%;width:100%}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-separator[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-separator[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]:before, .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]:before{background:#252525}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]{color:#858585}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{background-color:#53789b!important}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-separator[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-separator[_ngcontent-%COMP%], .light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]:before, .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]:before{background:#eee}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]{color:#5e5e5e}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{background-color:#add6ff!important}'],changeDetection:0})}}return l})();var $n=["scrollContainer"],Rn=["code"];function An(l,g){if(l&1&&N(0,"span",10),l&2){let e=g.ngIf;$("left",e.left)("width",e.width)}}function jn(l,g){if(l&1&&(f(0,"span",12),y(1),M()),l&2){let e=g.$implicit;h("ngClass",e.class),p(),k(e.text)}}function Hn(l,g){if(l&1&&(K(0),x(1,jn,2,2,"span",11),_(2,"findToken"),_(3,"tokens"),ee()),l&2){let e=g.ngIf,t=S().index;p(),h("ngForOf",me(3,5,_e(2,1,e.tokens,e.text,t),e.text))}}function Wn(l,g){if(l&1&&(f(0,"li",5),x(1,An,1,4,"span",6),_(2,"async"),f(3,"span",7),y(4),M(),f(5,"span",8),y(6),M(),x(7,Hn,4,8,"ng-container",9),M()),l&2){let e=g.$implicit,t=g.index,n=S();h("ngClass","line-"+e.status),p(),h("ngIf",P(2,11,n.getSelection(t))),p(2),$("right","calc(100% + 26px + "+(n.lineNumberMargin/2).toString()+"px)")("width",n.lineNumberMargin/2-5,"px"),p(),k(e.oldLine==null?null:e.oldLine.lineNumber),p(),$("width",n.lineNumberMargin/2-5,"px"),p(),k(e.newLine==null?null:e.newLine.lineNumber),p(),h("ngIf",n.getLineView(e))}}var en=(()=>{class l extends he(ue,ye){constructor(e,t,n){super(),this.diffService=e,this.diffSelectionService=t,this.findSelectionService=n,this.lineNumberMargin=0,this.lines$=new X([]),this.currentPatch=null,this.getSelection=i=>this.diffSelectionService.selectedRange.pipe(D(o=>{if(!o)return null;let[r,s]=o[0].line>o[1].line||o[0].line===o[1].line&&o[0].char>o[1].char?[o[1],o[0]]:o;return i<r.line||i>s.line?null:i===r.line?{left:`${r.char*this.diffSelectionService.charWidth}px`,width:r.line===s.line?`${(s.char-r.char)*this.diffSelectionService.charWidth}px`:"100%"}:i===s.line?{left:"0px",width:`${s.char*this.diffSelectionService.charWidth}px`}:{left:"0px",width:"100%"}}))}ngOnInit(){let e=this.scrollContainer.nativeElement;this.diffLines.pipe(we(0),v(this.destroyed$)).subscribe(t=>{let n=this.currentPatch?V({},this.currentPatch):null;if(t){this.currentPatch={newFilePath:t.newFilePath,oldFilePath:t.oldFilePath};let i=Math.max(t.oldLines.length,t.newLines.length)??0;this.lineNumberMargin=this.diffService.calculateMargin(i.toString().length),this.diffService.calculateInlineLines(t.oldLines,t.newLines,t.hunks).pipe(v(this.destroyed$)).subscribe(o=>{this.lines$.next(o),(!n||n.oldFilePath!==this.currentPatch?.oldFilePath||n.newFilePath!==this.currentPatch?.newFilePath)&&this.scrollContainer.nativeElement?.scrollTo(0,0)})}else this.currentPatch=null,this.lineNumberMargin=0,this.lines$.next([]),n&&this.scrollContainer.nativeElement?.scrollTo(0,0)}),Y([this.lines$,this.findSelectionService.searchRegex]).pipe(v(this.destroyed$)).subscribe(([t,n])=>{if(!n){this.findSelectionService.setMatches([]);return}let i=t.map((o,r)=>[this.getLineView(o),r]).flatMap(([o,r])=>o?Array.from(o.text.matchAll(n),s=>({lineId:r,startIndex:s.index??0,endIndex:(s.index??0)+(s[0]?.length??0)})):[]);this.findSelectionService.setMatches(i)}),this.findSelectionService.selectedMatch.pipe(v(this.destroyed$)).subscribe(t=>{if(!t||typeof t.lineId!="number")return;let n=this.lineNumberMargin+26+t.startIndex*this.diffSelectionService.charWidth,i=this.lineNumberMargin+26+t.endIndex*this.diffSelectionService.charWidth,o=e.scrollLeft,r=e.scrollLeft+e.clientWidth,s=n<o?n:n>r?i-e.clientWidth:e.scrollLeft;e.scrollTo(s,t.lineId*19)}),this.diffSelectionService.captureSelections(this.codeElement.nativeElement,(t,n)=>({line:Math.floor((e.scrollTop+n-e.getBoundingClientRect().top)/19),char:Math.max(0,Math.round((e.scrollLeft+t-e.getBoundingClientRect().left-(this.lineNumberMargin+26))/this.diffSelectionService.charWidth))}),(t,n)=>this.lines$.value.filter((i,o)=>o>=t&&o<=n).map(i=>this.getLineView(i)?.text),()=>{let t=this.lines$.value[this.lines$.value.length-1];return{line:this.lines$.value.length-1,char:t?this.getLineView(t)?.text.length??0:0}},([t,n])=>ne(t.line,n.line+1).map(i=>({oldLineNo:this.lines$.value[i]?.oldLine?.lineNumber??-1,newLineNo:this.lines$.value[i]?.newLine?.lineNumber??-1}))).pipe(v(this.destroyed$)).subscribe()}getLineView(e){return e.status==="added"?e.newLine:e.status==="removed"?e.oldLine:e.status==="unchanged"?e.newLine??e.oldLine:null}trackByDiffLine(e,t){return e}static{this.\u0275fac=function(t){return new(t||l)(I(ke),I(fe),I(ge))}}static{this.\u0275cmp=se({type:l,selectors:[["app-inline-view"]],viewQuery:function(t,n){if(t&1&&(R($n,7,Z),R(Rn,7,Z),R(G,5)),t&2){let i;A(i=j())&&(n.scrollContainer=i.first),A(i=j())&&(n.codeElement=i.first),A(i=j())&&(n.viewports=i)}},inputs:{diffLines:"diffLines"},features:[ae],decls:7,vars:9,consts:[["scrollContainer",""],["code",""],[1,"viewport",3,"itemSize","maxBufferPx","minBufferPx"],["tabindex","0",1,"vs-code-theme"],["class","line",3,"ngClass",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"line",3,"ngClass"],["class","selection",3,"left","width",4,"ngIf"],[1,"old-line-number"],[1,"new-line-number"],[4,"ngIf"],[1,"selection"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(t,n){t&1&&(f(0,"cdk-virtual-scroll-viewport",2,0)(2,"code",3,1)(4,"ul"),x(5,Wn,8,13,"li",4),_(6,"async"),M()()()),t&2&&(h("itemSize",19)("maxBufferPx",1e3)("minBufferPx",200),p(4),$("margin-left",n.lineNumberMargin+26,"px"),p(),h("cdkVirtualForOf",P(6,7,n.lines$))("cdkVirtualForTrackBy",n.trackByDiffLine))},dependencies:[ve,be,G,xe,Se,ce,de,Le,Fe],styles:["code[_ngcontent-%COMP%]{display:block;white-space:pre;user-select:none;cursor:text;outline:none}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{position:absolute;text-align:right;user-select:none}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{right:calc(100% + 26px)}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{position:absolute;display:block;height:19px;opacity:.5}.viewport[_ngcontent-%COMP%]{height:100%;width:100%}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{color:#858585}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{background-color:#53789b!important}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{color:#5e5e5e}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{background-color:#add6ff!important}"],changeDetection:0})}}return l})();var Qn=["leftScrollContainer"],Un=["rightScrollContainer"],zn=["leftCode"],Xn=["rightCode"];function qn(l,g){if(l&1&&N(0,"span",13),l&2){let e=g.ngIf;$("left",e.left)("width",e.width)}}function Gn(l,g){if(l&1&&(f(0,"span",16),y(1),M()),l&2){let e=g.$implicit;h("ngClass",e.class),p(),k(e.text)}}function Jn(l,g){if(l&1&&(K(0),f(1,"span",14),y(2),M(),x(3,Gn,2,2,"span",15),_(4,"findToken"),_(5,"tokens"),ee()),l&2){let e=S(),t=e.$implicit,n=e.index;p(2),k(t.oldLine==null?null:t.oldLine.lineNumber),p(),h("ngForOf",me(5,6,_e(4,2,t.oldLine==null?null:t.oldLine.tokens,t.oldLine==null?null:t.oldLine.text,"l:"+n),t.oldLine==null?null:t.oldLine.text))}}function Yn(l,g){if(l&1&&(f(0,"li",10),x(1,qn,1,4,"span",11),_(2,"async"),x(3,Jn,6,9,"ng-container",12),M()),l&2){let e=g.$implicit,t=g.index,n=S();h("ngClass","line-"+e.status),p(),h("ngIf",P(2,3,n.getSelection(t,"left"))),p(2),h("ngIf",e.status!=="added")}}function Zn(l,g){if(l&1&&N(0,"span",13),l&2){let e=g.ngIf;$("left",e.left)("width",e.width)}}function Kn(l,g){if(l&1&&(f(0,"span",16),y(1),M()),l&2){let e=g.$implicit;h("ngClass",e.class),p(),k(e.text)}}function ei(l,g){if(l&1&&(K(0),f(1,"span",14),y(2),M(),x(3,Kn,2,2,"span",15),_(4,"findToken"),_(5,"tokens"),ee()),l&2){let e=S(),t=e.$implicit,n=e.index;p(2),k(t.newLine==null?null:t.newLine.lineNumber),p(),h("ngForOf",me(5,6,_e(4,2,t.newLine==null?null:t.newLine.tokens,t.newLine==null?null:t.newLine.text,"r:"+n),t.newLine==null?null:t.newLine.text))}}function ti(l,g){if(l&1&&(f(0,"li",10),x(1,Zn,1,4,"span",11),_(2,"async"),x(3,ei,6,9,"ng-container",12),M()),l&2){let e=g.$implicit,t=g.index,n=S();h("ngClass","line-"+e.status),p(),h("ngIf",P(2,3,n.getSelection(t,"right"))),p(2),h("ngIf",e.status!=="removed")}}var tn=(()=>{class l extends he(ue,ye){constructor(e,t,n,i){super(),this.zone=e,this.diffService=t,this.diffSelectionService=n,this.findSelectionService=i,this.leftLineNumberMargin=0,this.rightLineNumberMargin=0,this.lines$=new X([]),this.currentPatch=null,this.selectionSide=new X("right"),this.getSelection=(o,r)=>this.diffSelectionService.selectedRange.pipe(ut(this.selectionSide),D(([s,u])=>{if(!s||u!==r)return null;let[a,c]=s[0].line>s[1].line||s[0].line===s[1].line&&s[0].char>s[1].char?[s[1],s[0]]:s;return o<a.line||o>c.line?null:o===a.line?{left:`${a.char*this.diffSelectionService.charWidth}px`,width:a.line===c.line?`${(c.char-a.char)*this.diffSelectionService.charWidth}px`:"100%"}:o===c.line?{left:"0px",width:`${c.char*this.diffSelectionService.charWidth}px`}:{left:"0px",width:"100%"}}))}ngOnInit(){let e=this.leftScrollContainer.nativeElement,t=this.rightScrollContainer.nativeElement;this.diffLines.pipe(we(0),v(this.destroyed$)).subscribe(n=>{let i=this.currentPatch?V({},this.currentPatch):null;n?(this.currentPatch={newFilePath:n.newFilePath,oldFilePath:n.oldFilePath},this.leftLineNumberMargin=this.diffService.calculateMargin(n.oldLines.length.toString().length,!0),this.rightLineNumberMargin=this.diffService.calculateMargin(n.newLines.length.toString().length,!0),this.diffService.calculateSplitLines(n.oldLines,n.newLines,n.hunks).pipe(v(this.destroyed$)).subscribe(o=>{this.lines$.next(o),(!i||i.oldFilePath!==this.currentPatch?.oldFilePath||i.newFilePath!==this.currentPatch?.newFilePath)&&(this.leftScrollContainer?.nativeElement?.scrollTo(0,0),this.rightScrollContainer?.nativeElement?.scrollTo(0,0))})):(this.currentPatch=null,this.leftLineNumberMargin=0,this.rightLineNumberMargin=0,this.lines$.next([]),i&&(this.leftScrollContainer?.nativeElement?.scrollTo(0,0),this.rightScrollContainer?.nativeElement?.scrollTo(0,0)))}),this.zone.runOutsideAngular(()=>{let n=!1,i=!1;We(this.leftScrollContainer.nativeElement,"scroll",{passive:!0}).pipe(Pe(()=>!i),Oe(()=>{n=!0,this.rightScrollContainer.nativeElement.scrollTo(this.leftScrollContainer.nativeElement.scrollLeft,this.leftScrollContainer.nativeElement.scrollTop)}),Qe(100),v(this.destroyed$)).subscribe(()=>{n=!1}),We(this.rightScrollContainer.nativeElement,"scroll",{passive:!0}).pipe(Pe(()=>!n),Oe(()=>{i=!0,this.leftScrollContainer.nativeElement.scrollTo(this.rightScrollContainer.nativeElement.scrollLeft,this.rightScrollContainer.nativeElement.scrollTop)}),Qe(100),v(this.destroyed$)).subscribe(()=>{i=!1})}),Y([this.lines$,this.findSelectionService.searchRegex]).pipe(v(this.destroyed$)).subscribe(([n,i])=>{if(!i){this.findSelectionService.setMatches([]);return}let o=n.map((a,c)=>[a,c]),r=o.filter(([a])=>a.status!=="added").map(([a,c])=>[a.oldLine,c]),s=o.filter(([a])=>a.status!=="removed").map(([a,c])=>[a.newLine,c]),u=[...r.flatMap(([a,c])=>a?Array.from(a.text.matchAll(i),d=>({lineId:`l:${c}`,startIndex:d.index??0,endIndex:(d.index??0)+(d[0]?.length??0)})):[]),...s.flatMap(([a,c])=>a?Array.from(a.text.matchAll(i),d=>({lineId:`r:${c}`,startIndex:d.index??0,endIndex:(d.index??0)+(d[0]?.length??0)})):[])];this.findSelectionService.setMatches(u)}),this.findSelectionService.selectedMatch.pipe(v(this.destroyed$)).subscribe(n=>{if(!n||typeof n.lineId!="string")return;let i=n.lineId.startsWith("l")?e:t,o=26+(n.lineId.startsWith("l")?this.leftLineNumberMargin:this.rightLineNumberMargin),r=o+n.startIndex*this.diffSelectionService.charWidth,s=o+n.endIndex*this.diffSelectionService.charWidth,u=i.scrollLeft,a=i.scrollLeft+i.clientWidth,c=r<u?r:r>a?s-i.clientWidth:i.scrollLeft;i.scrollTo(c,+n.lineId.slice(2)*19)}),this.diffSelectionService.captureSelections(this.leftCodeElement.nativeElement,(n,i)=>({line:Math.floor((e.scrollTop+i-e.getBoundingClientRect().top)/19),char:Math.max(0,Math.round((e.scrollLeft+n-e.getBoundingClientRect().left-(this.leftLineNumberMargin+26))/this.diffSelectionService.charWidth))}),(n,i)=>this.lines$.value.filter((o,r)=>r>=n&&r<=i).map(o=>o.oldLine?.text),()=>({line:this.lines$.value.length-1,char:this.lines$.value[this.lines$.value.length-1]?.oldLine?.text.length??0}),([n,i])=>ne(n.line,i.line+1).map(o=>({oldLineNo:this.lines$.value[o]?.oldLine?.lineNumber??-1,newLineNo:this.lines$.value[o]?.newLine?.lineNumber??-1}))).pipe(v(this.destroyed$)).subscribe(()=>{this.selectionSide.next("left")}),this.diffSelectionService.captureSelections(this.rightCodeElement.nativeElement,(n,i)=>({line:Math.floor((t.scrollTop+i-t.getBoundingClientRect().top)/19),char:Math.max(0,Math.round((t.scrollLeft+n-t.getBoundingClientRect().left-(this.rightLineNumberMargin+26))/this.diffSelectionService.charWidth))}),(n,i)=>this.lines$.value.filter((o,r)=>r>=n&&r<=i).map(o=>o.newLine?.text),()=>({line:this.lines$.value.length-1,char:this.lines$.value[this.lines$.value.length-1]?.newLine?.text.length??0}),([n,i])=>ne(n.line,i.line+1).map(o=>({oldLineNo:this.lines$.value[o]?.oldLine?.lineNumber??-1,newLineNo:this.lines$.value[o]?.newLine?.lineNumber??-1}))).pipe(v(this.destroyed$)).subscribe(()=>{this.selectionSide.next("right")})}trackByDiffLine(e,t){return e}static{this.\u0275fac=function(t){return new(t||l)(I(_t),I(ke),I(fe),I(ge))}}static{this.\u0275cmp=se({type:l,selectors:[["app-split-view"]],viewQuery:function(t,n){if(t&1&&(R(Qn,7,Z),R(Un,7,Z),R(zn,7,Z),R(Xn,7,Z),R(G,5)),t&2){let i;A(i=j())&&(n.leftScrollContainer=i.first),A(i=j())&&(n.rightScrollContainer=i.first),A(i=j())&&(n.leftCodeElement=i.first),A(i=j())&&(n.rightCodeElement=i.first),A(i=j())&&(n.viewports=i)}},inputs:{diffLines:"diffLines"},features:[ae],decls:17,vars:18,consts:[["leftScrollContainer",""],["leftCode",""],["rightScrollContainer",""],["rightCode",""],["id","diff-view_split-left"],[1,"viewport",3,"itemSize","maxBufferPx","minBufferPx"],["tabindex","0",1,"vs-code-theme","left-code"],["class","line",3,"ngClass",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["id","diff-view_split-right"],["tabindex","1",1,"vs-code-theme","right-code"],[1,"line",3,"ngClass"],["class","selection",3,"left","width",4,"ngIf"],[4,"ngIf"],[1,"selection"],[1,"line-number"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(t,n){t&1&&(f(0,"app-grid")(1,"app-grid-cell",4)(2,"cdk-virtual-scroll-viewport",5,0)(4,"code",6,1)(6,"ul"),x(7,Yn,4,5,"li",7),_(8,"async"),M()()()(),f(9,"app-grid-cell",8)(10,"cdk-virtual-scroll-viewport",5,2)(12,"code",9,3)(14,"ul"),x(15,ti,4,5,"li",7),_(16,"async"),M()()()()()),t&2&&(p(2),h("itemSize",19)("maxBufferPx",1e3)("minBufferPx",200),p(4),$("margin-left",n.leftLineNumberMargin+26,"px"),p(),h("cdkVirtualForOf",P(8,14,n.lines$))("cdkVirtualForTrackBy",n.trackByDiffLine),p(3),h("itemSize",19)("maxBufferPx",1e3)("minBufferPx",200),p(4),$("margin-left",n.rightLineNumberMargin+26,"px"),p(),h("cdkVirtualForOf",P(16,16,n.lines$))("cdkVirtualForTrackBy",n.trackByDiffLine))},dependencies:[ve,be,G,xe,Se,ce,Ut,zt,de,Le,Fe],styles:["code[_ngcontent-%COMP%]{display:block;white-space:pre;user-select:none;cursor:text;outline:none}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .line-number[_ngcontent-%COMP%]{position:absolute;text-align:right;user-select:none;right:calc(100% + 26px)}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{position:absolute;display:block;height:19px;opacity:.5}.viewport[_ngcontent-%COMP%]{height:100%;width:100%;overflow-x:scroll}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .line-number[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .line-number[_ngcontent-%COMP%]{color:#858585}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{background-color:#53789b!important}.dark-theme[_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-added[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-added[_ngcontent-%COMP%]{background:#111}.dark-theme[_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%]{background:#501515}.dark-theme[_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-removed[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-removed[_ngcontent-%COMP%]{background:#111}.dark-theme[_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%]{background:#1f2c19}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .line-number[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .line-number[_ngcontent-%COMP%]{color:#5e5e5e}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{background-color:#add6ff!important}.light-theme[_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-added[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-added[_ngcontent-%COMP%]{background:#f0f0f0}.light-theme[_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%]{background:#ee7e7e}.light-theme[_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-removed[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-removed[_ngcontent-%COMP%]{background:#f0f0f0}.light-theme[_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%]{background:#0cd086}"],changeDetection:0})}}return l})();var Ho=(()=>{class l{static{this.\u0275fac=function(t){return new(t||l)}}static{this.\u0275mod=ft({type:l})}static{this.\u0275inj=gt({imports:[bt,At,Xt]})}}return l})();Pt(Gt,[St,vt,ce,Ae,Rt,je,kt,jt,Qt,Kt,en,tn],[de,Wt]);export{qt as a,Gt as b,ke as c,Fe as d,Ho as e};
