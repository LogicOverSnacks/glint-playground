"use strict";(self.webpackChunkgit_glint=self.webpackChunkgit_glint||[]).push([[373],{6803:(Q,D,m)=>{m.d(D,{t:()=>g});var R=m(4006),E=m(5412),s=m(4650),v=m(9549),C=m(284),x=m(4859);class g{constructor(O){this.data=O,this.form=new R.cw({name:new R.NI(null,R.kI.required)})}static{this.\u0275fac=function(o){return new(o||g)(s.Y36(E.WI))}}static{this.\u0275cmp=s.Xpm({type:g,selectors:[["ng-component"]],decls:13,vars:5,consts:[["mat-dialog-title",""],[3,"formGroup"],["subscriptSizing","dynamic"],["type","text","matInput","","required","","formControlName","name"],["mat-button","",3,"mat-dialog-close"],["mat-flat-button","","type","submit","color","primary",3,"mat-dialog-close","disabled"]],template:function(o,d){1&o&&(s.TgZ(0,"div",0),s._uU(1),s.qZA(),s.TgZ(2,"form",1)(3,"mat-dialog-content")(4,"mat-form-field",2)(5,"mat-label"),s._uU(6,"Name"),s.qZA(),s._UZ(7,"input",3),s.qZA()(),s.TgZ(8,"mat-dialog-actions")(9,"button",4),s._uU(10,"Cancel"),s.qZA(),s.TgZ(11,"button",5),s._uU(12,"Save"),s.qZA()()()),2&o&&(s.xp6(1),s.hij("Create ",d.data.title,""),s.xp6(1),s.Q6J("formGroup",d.form),s.xp6(7),s.Q6J("mat-dialog-close",void 0),s.xp6(2),s.Q6J("mat-dialog-close",d.form.value)("disabled",d.form.invalid))},dependencies:[E.ZT,E.uh,E.xY,E.H8,v.KE,v.hX,C.Nt,R._Y,R.Fj,R.JJ,R.JL,R.Q7,R.sg,R.u,x.lW],encapsulation:2,changeDetection:0})}}},6719:(Q,D,m)=>{m.d(D,{$:()=>pe});var R=m(655),E=m(9867),s=m(2843),v=m(9646),C=m(515),x=m(4128),g=m(262),r=m(3900),O=m(4004),o=m(2435),d=m(2120),u=m(8523),e=m(4889),A=m(1129),F=m(8724),G=m(9077),T=m(5412),z=m(1135),j=m(2722),X=m(8926),_=m(9967),n=m(4650),N=m(5219),k=m(1572),J=m(6895),Y=m(4859),q=m(7392),y=m(266),P=m(744);function ee(B,Z){1&B&&n._UZ(0,"mat-spinner",5)}function te(B,Z){1&B&&(n.TgZ(0,"div",7)(1,"mat-icon",8),n._uU(2,"warning"),n.qZA(),n._uU(3," There are changes to the working copy that will be lost. "),n.qZA())}function ne(B,Z){if(1&B&&(n.TgZ(0,"li",11),n._uU(1),n.qZA()),2&B){const f=Z.$implicit;n.Q6J("matTooltip",f.id),n.xp6(1),n.AsE(" ",f.message," - ",f.id," ")}}function se(B,Z){if(1&B&&(n.TgZ(0,"div",7)(1,"mat-icon",8),n._uU(2,"warning"),n.qZA(),n._uU(3," The following commits will no longer be reachable by any branch or tag and may be lost: "),n.TgZ(4,"ul",9),n.YNc(5,ne,2,3,"li",10),n.ALo(6,"async"),n.qZA()()),2&B){const f=n.oxw(2);n.xp6(5),n.Q6J("ngForOf",n.lcZ(6,1,f.atRiskCommits))}}function ie(B,Z){if(1&B&&(n.ynx(0),n.YNc(1,te,4,0,"div",6),n.ALo(2,"async"),n.YNc(3,se,7,3,"div",6),n.ALo(4,"nullEmpty"),n.ALo(5,"async"),n.BQk()),2&B){const f=n.oxw();n.xp6(1),n.Q6J("ngIf",n.lcZ(2,2,f.workingCopyAtRisk)),n.xp6(2),n.Q6J("ngIf",n.lcZ(4,4,n.lcZ(5,6,f.atRiskCommits)))}}function ae(B,Z){1&B&&(n.TgZ(0,"button",12),n._uU(1,"Confirm"),n.qZA()),2&B&&n.Q6J("mat-dialog-close",!0)}class K extends((0,X.j)(_.A)){constructor(Z,f,w){super(),this.data=Z,this.dialogRef=f,this.graphSharedService=w,this.loading=new z.X(!0),this.atRiskCommits=new z.X([]),this.workingCopyAtRisk=new z.X(!1)}ngOnInit(){this.graphSharedService.getCommits().pipe((0,j.R)(this.destroyed$)).subscribe(Z=>{const f=this.data.branchName.startsWith("refs/heads/")?this.data.branchName:`refs/heads/${this.data.branchName}`,w={...Z},L=Object.values(Z).filter(I=>I.commit.references.length>0&&I.commit.references.some(t=>t!==f)).map(I=>I.id);w.head&&delete w.head;const $=this.data.toCommitId?[...L,this.data.toCommitId]:L;let b=0;for(;b<$.length;){const I=$[b],t=w[I];t&&(delete w[I],$.push(...t.commit.parentIds)),b++}const H=Object.values(w).filter(I=>!I.stash).map(I=>I.commit);this.atRiskCommits.next(H),this.loading.value&&0===H.length&&!this.workingCopyAtRisk.value?setTimeout(()=>this.dialogRef.close(!0),0):this.loading.next(!1)})}static{this.\u0275fac=function(f){return new(f||K)(n.Y36(T.WI),n.Y36(T.so),n.Y36(N.p))}}static{this.\u0275cmp=n.Xpm({type:K,selectors:[["ng-component"]],features:[n.qOj],decls:12,vars:11,consts:[["mat-dialog-title",""],["diameter","48",4,"ngIf"],[4,"ngIf"],["type","button","mat-button","",3,"mat-dialog-close"],["type","button","mat-button","","color","warn",3,"mat-dialog-close",4,"ngIf"],["diameter","48"],["class","text-block",4,"ngIf"],[1,"text-block"],[1,"warning-icon"],[1,"commit-list"],[3,"matTooltip",4,"ngFor","ngForOf"],[3,"matTooltip"],["type","button","mat-button","","color","warn",3,"mat-dialog-close"]],template:function(f,w){1&f&&(n.TgZ(0,"div",0),n._uU(1),n.qZA(),n.TgZ(2,"mat-dialog-content"),n.YNc(3,ee,1,0,"mat-spinner",1),n.ALo(4,"async"),n.YNc(5,ie,6,8,"ng-container",2),n.ALo(6,"async"),n.qZA(),n.TgZ(7,"mat-dialog-actions")(8,"button",3),n._uU(9,"Cancel"),n.qZA(),n.YNc(10,ae,2,1,"button",4),n.ALo(11,"async"),n.qZA()),2&f&&(n.xp6(1),n.Oqu(w.data.title),n.xp6(2),n.Q6J("ngIf",n.lcZ(4,5,w.loading)),n.xp6(2),n.Q6J("ngIf",!1===n.lcZ(6,7,w.loading)),n.xp6(3),n.Q6J("mat-dialog-close",void 0),n.xp6(2),n.Q6J("ngIf",!1===n.lcZ(11,9,w.loading)))},dependencies:[T.ZT,T.uh,T.xY,T.H8,k.Ou,J.sg,J.O5,Y.lW,q.Hw,y.gM,J.Ov,P.x],styles:["mat-spinner[_ngcontent-%COMP%]{margin:0 auto}.text-block[_ngcontent-%COMP%]{margin-bottom:10px}.warning-icon[_ngcontent-%COMP%]{margin-right:5px}.commit-list[_ngcontent-%COMP%]{list-style:inside;padding-left:20px;margin-top:10px;overflow-x:hidden}.commit-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{height:26px;line-height:26px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-size:16px}"],changeDetection:0})}}var W=m(6803),V=m(4006),S=m(9549),he=m(284);class M{constructor(Z){this.data=Z,this.form=new V.cw({name:new V.NI(this.data.name,{nonNullable:!0,validators:V.kI.required})})}static{this.\u0275fac=function(f){return new(f||M)(n.Y36(T.WI))}}static{this.\u0275cmp=n.Xpm({type:M,selectors:[["ng-component"]],decls:13,vars:5,consts:[["mat-dialog-title",""],[3,"formGroup"],["subscriptSizing","dynamic"],["type","text","matInput","","required","","formControlName","name"],["mat-button","",3,"mat-dialog-close"],["mat-flat-button","","type","submit","color","primary",3,"mat-dialog-close","disabled"]],template:function(f,w){1&f&&(n.TgZ(0,"div",0),n._uU(1),n.qZA(),n.TgZ(2,"form",1)(3,"mat-dialog-content")(4,"mat-form-field",2)(5,"mat-label"),n._uU(6,"Name"),n.qZA(),n._UZ(7,"input",3),n.qZA()(),n.TgZ(8,"mat-dialog-actions")(9,"button",4),n._uU(10,"Cancel"),n.qZA(),n.TgZ(11,"button",5),n._uU(12,"Save"),n.qZA()()()),2&f&&(n.xp6(1),n.hij("Rename ",w.data.title,""),n.xp6(1),n.Q6J("formGroup",w.form),n.xp6(7),n.Q6J("mat-dialog-close",void 0),n.xp6(2),n.Q6J("mat-dialog-close",w.form.value.name)("disabled",w.form.invalid))},dependencies:[T.ZT,T.uh,T.xY,T.H8,S.KE,S.hX,he.Nt,V._Y,V.Fj,V.JJ,V.JL,V.Q7,V.sg,V.u,Y.lW],encapsulation:2,changeDetection:0})}}var ce=m(790),me=m(4348),oe=m(9160),de=m(3058),le=m(4614);let pe=(()=>{class B{constructor(f,w,L,$,b,H,I){this.dialog=f,this.store=w,this.commitsApi=L,this.historyApi=$,this.remotesApi=b,this.repositoriesApi=H,this.submodulesApi=I,this.fetchFromRemote=(t,a,h=null)=>(h?this.remotesApi.fetch(t,h,a):this.remotesApi.fetchAll(t,a)).pipe((0,g.K)(i=>o.Ay.matches(i)||o.T0.matches(i)||o.OV.matches(i)?(0,s._)(()=>new d.ZR(i.message)):(0,s._)(()=>i)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.references])))),this.push=(t,a,h,i,c=!1)=>this.store.dispatch(new A.z0(t,{name:c?"Force push":"Push",detail:`'${i.join(", ")}' to ${a??"all remotes"}`,do:()=>(a?this.remotesApi.push(t,h,a,i,c):this.remotesApi.pushToAllRemotes(t,h,i,c)).pipe((0,g.K)(l=>o.Ay.matches(l)?(0,s._)(()=>new d.ZR(l.message)):o.a9.matches(l)?(0,s._)(()=>new d.ZR(l.message,l.isHtml)):o.T0.matches(l)?(0,s._)(()=>new d.ZR(l.message)):(0,s._)(()=>l)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranchCommitId,e.nh.headCommitId,e.nh.references]))))})),this.pull=(t,a,h,i)=>this.fetchFromRemote(t,h,a).pipe((0,r.w)(()=>this.commitsApi.getBranchUpstreamCommitId(t,`refs/heads/${i}`)),(0,r.w)(c=>{if(c)return this.updateBranch(t,`refs/heads/${i}`,c);const l=new o.aK(i);return(0,s._)(()=>new d.ZR(l.message))})),this.checkoutBranch=(t,a)=>this.store.dispatch(new A.z0(t,{name:"Checkout",detail:a,do:()=>this.repositoriesApi.getCurrentBranch(t).pipe((0,r.w)(h=>this.repositoriesApi.checkoutBranch(t,a).pipe((0,g.K)(i=>o.Nu.matches(i)?(0,s._)(()=>new d.ZR(i.message,i.isHtml)):(0,s._)(()=>i)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.headCommitId,e.nh.references,e.nh.stagedChanges,e.nh.unstagedChanges]))),(0,u.C)(()=>(0,v.of)(h))))),undo:h=>h?this.repositoriesApi.checkoutBranch(t,h).pipe((0,g.K)(i=>o.Nu.matches(i)?(0,s._)(()=>new d.ZR(i.message,i.isHtml)):(0,s._)(()=>i)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.headCommitId,e.nh.references,e.nh.stagedChanges,e.nh.unstagedChanges])))):C.E})),this.checkoutRemoteBranch=(t,a,h,i,c)=>{const l=(/^refs\/remotes\/([^\/]+)\//.exec(h)??[])[1];if(!l)throw new Error(`Reference '${h}' is not a remote branch`);const p=h.replace(/^refs\/remotes\/[^\/]+\//,"");if(!p)throw new Error("Cannot checkout branch when no branch is selected");return i?this.pull(t,l,a,p).pipe((0,r.w)(()=>this.checkoutBranch(t,i))):c?this.createBranchWithDetails(t,c,p,`${l}/${p}`,!0):C.E},this.createBranch=(t,a,h=!0)=>this.dialog.open(W.t,{data:{title:"Branch"}}).afterClosed().pipe((0,r.w)(c=>c?this.store.dispatch(new A.z0(t,{name:"Create branch",detail:`${c.name} at ${a}`,do:()=>(0,x.D)([this.repositoriesApi.getCurrentBranch(t),this.historyApi.getHeadCommitId(t)]).pipe((0,r.w)(l=>this.repositoriesApi.createBranch(t,a,c.name).pipe((0,g.K)(p=>o.vV.matches(p)?(0,s._)(()=>new d.ZR(p.message)):(0,s._)(()=>p)),(0,r.w)(()=>h?this.repositoriesApi.checkoutBranch(t,c.name):C.E),(0,g.K)(p=>o.Nu.matches(p)?C.E:o.bG.matches(p)||o.OV.matches(p)?(0,s._)(()=>new d.ZR(p.message)):(0,s._)(()=>p)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.headCommitId,e.nh.references,e.nh.stagedChanges,e.nh.unstagedChanges]))),(0,u.C)(()=>(0,v.of)(l))))),undo:([l,p])=>(h?l?this.repositoriesApi.checkoutBranch(t,l):p?this.repositoriesApi.detachHead(t,p):(0,v.of)(void 0):(0,v.of)(void 0)).pipe((0,g.K)(U=>o.Nu.matches(U)?C.E:o.bG.matches(U)||o.OV.matches(U)?(0,s._)(()=>new d.ZR(U.message)):(0,s._)(()=>U)),(0,r.w)(()=>this.repositoriesApi.deleteBranch(t,c.name)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.headCommitId,e.nh.references,e.nh.stagedChanges,e.nh.unstagedChanges]))))})):C.E)),this.createBranchWithDetails=(t,a,h,i=null,c=!0)=>this.store.dispatch(new A.z0(t,{name:"Create branch",detail:`${h} at ${a}${i?` with upstream branch ${i}`:""}`,do:()=>(0,x.D)([this.repositoriesApi.getCurrentBranch(t),this.historyApi.getHeadCommitId(t)]).pipe((0,r.w)(l=>this.repositoriesApi.createBranch(t,a,h).pipe((0,g.K)(p=>o.vV.matches(p)?(0,s._)(()=>new d.ZR(p.message)):(0,s._)(()=>p)),(0,r.w)(()=>c?this.repositoriesApi.checkoutBranch(t,h):C.E),(0,g.K)(p=>o.Nu.matches(p)?C.E:(0,s._)(()=>p)),(0,r.w)(()=>i?this.repositoriesApi.setUpstreamBranch(t,h,i):C.E),(0,g.K)(p=>o.bG.matches(p)||o.OV.matches(p)?(0,s._)(()=>new d.ZR(p.message)):(0,s._)(()=>p)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.headCommitId,e.nh.references,e.nh.stagedChanges,e.nh.unstagedChanges]))),(0,u.C)(()=>(0,v.of)(l))))),undo:([l,p])=>(c?l?this.repositoriesApi.checkoutBranch(t,l):p?this.repositoriesApi.detachHead(t,p):(0,v.of)(void 0):(0,v.of)(void 0)).pipe((0,g.K)(U=>o.Nu.matches(U)?C.E:o.bG.matches(U)||o.OV.matches(U)?(0,s._)(()=>new d.ZR(U.message)):(0,s._)(()=>U)),(0,r.w)(()=>this.repositoriesApi.deleteBranch(t,h)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.headCommitId,e.nh.references,e.nh.stagedChanges,e.nh.unstagedChanges]))))})),this.createTag=(t,a,h="")=>this.dialog.open(W.t,{data:{title:"Tag"}}).afterClosed().pipe((0,r.w)(c=>c?this.store.dispatch(new A.z0(t,{name:"Create tag",detail:`${c.name} at ${a}`,do:()=>this.repositoriesApi.createTag(t,a,c.name,h).pipe((0,g.K)(l=>o.OV.matches(l)?(0,s._)(()=>new d.ZR(l.message)):(0,s._)(()=>l)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.references])))),undo:()=>this.repositoriesApi.deleteTag(t,c.name).pipe((0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.references]))))})):C.E)),this.renameBranch=(t,a)=>this.dialog.open(M,{data:{title:"Branch",name:a}}).afterClosed().pipe((0,r.w)(i=>i?this.store.dispatch(new A.z0(t,{name:"Rename branch",detail:`${a} to ${i}`,do:()=>this.repositoriesApi.renameBranch(t,a,`refs/heads/${i}`).pipe((0,g.K)(c=>o.bG.matches(c)||o.OV.matches(c)?(0,s._)(()=>new d.ZR(c.message)):(0,s._)(()=>c)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.references])))),undo:()=>this.repositoriesApi.renameBranch(t,i,`refs/heads/${a}`).pipe((0,g.K)(c=>o.bG.matches(c)||o.OV.matches(c)?(0,s._)(()=>new d.ZR(c.message)):(0,s._)(()=>c)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.references]))))})):C.E)),this.deleteBranch=(t,a)=>this.dialog.open(K,{data:{title:"Delete Branch",branchName:a,toCommitId:null}}).afterClosed().pipe((0,r.w)(i=>i?this.store.dispatch(new A.z0(t,{name:"Delete branch",detail:a,do:()=>this.commitsApi.getBranchCommitId(t,a).pipe((0,r.w)(c=>this.repositoriesApi.deleteBranch(t,a).pipe((0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.references]))),(0,u.C)(()=>(0,v.of)(c))))),undo:c=>this.repositoriesApi.createBranch(t,c,a).pipe((0,g.K)(l=>o.vV.matches(l)||o.bG.matches(l)||o.OV.matches(l)?(0,s._)(()=>new d.ZR(l.message)):(0,s._)(()=>l)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.references]))))})):C.E)),this.deleteTag=(t,a)=>this.store.dispatch(new A.z0(t,{name:"Delete tag",detail:a,do:()=>this.commitsApi.getTagCommitId(t,a).pipe((0,r.w)(h=>this.repositoriesApi.deleteTag(t,a).pipe((0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.references]))),(0,u.C)(()=>(0,v.of)(h))))),undo:h=>this.repositoriesApi.createTag(t,h,a,"").pipe((0,g.K)(i=>o.OV.matches(i)?(0,s._)(()=>new d.ZR(i.message)):(0,s._)(()=>i)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.references]))))})),this.updateBranch=(t,a,h)=>this.dialog.open(K,{data:{title:"Move Branch",branchName:a,toCommitId:h}}).afterClosed().pipe((0,r.w)(c=>c?this.store.dispatch(new A.z0(t,{name:"Move branch",detail:`${a} to ${h}`,do:()=>this.commitsApi.getBranchCommitId(t,a).pipe((0,r.w)(l=>this.repositoriesApi.updateBranch(t,a,h).pipe((0,g.K)(p=>o.Nu.matches(p)?(0,s._)(()=>new d.ZR(p.message,p.isHtml)):(0,s._)(()=>p)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.headCommitId,e.nh.references]))),(0,O.U)(()=>l)))),undo:l=>this.repositoriesApi.updateBranch(t,a,l).pipe((0,g.K)(p=>o.Nu.matches(p)?(0,s._)(()=>new d.ZR(p.message,p.isHtml)):(0,s._)(()=>p)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.currentBranchUpstreamBranch,e.nh.headCommitId,e.nh.references]))))})):C.E)),this.setUpstreamBranch=(t,a,h)=>this.store.dispatch(new A.z0(t,{name:(h?"Change":"Remove")+" upstream branch",detail:h?`${a} -> ${h}`:a,do:()=>this.repositoriesApi.getUpstreamBranch(t,a).pipe((0,r.w)(i=>this.repositoriesApi.setUpstreamBranch(t,a,h).pipe((0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.currentBranchUpstreamBranch,e.nh.references]))),(0,u.C)(()=>(0,v.of)(i))))),undo:i=>this.repositoriesApi.setUpstreamBranch(t,a,i?.replace(/^refs\/remotes\//,"")??null).pipe((0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.currentBranchUpstreamBranch,e.nh.references]))))})),this.createCommit=(t,a,h)=>this.store.dispatch(new A.z0(t,{name:"Create commit",detail:h,do:()=>this.commitsApi.putCommit(t,a.name,a.email,h).pipe((0,g.K)(i=>o.fD.matches(i)?(0,s._)(()=>new d.ZR(i.message)):o.L8.matches(i)?(0,s._)(()=>new d.ZR(i.message,i.isHtml)):(0,s._)(()=>i)),(0,u.C)(i=>this.store.dispatch([...i?[new e.$h(t,null),new e.jQ(t,i)]:[],new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.headCommitId,e.nh.references,e.nh.stagedChanges,e.nh.submodules])]).pipe((0,O.U)(()=>i)))),undo:()=>this.commitsApi.undoHeadCommit(t).pipe((0,g.K)(i=>o.OV.matches(i)?(0,s._)(()=>new d.ZR(i.message)):(0,s._)(()=>i)),(0,u.C)(i=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranchCommitId,e.nh.headCommitId,e.nh.references,e.nh.stagedChanges,e.nh.submodules]))))})).pipe((0,O.U)(()=>this.store.selectSnapshot(F.h.mostRecentAction(t))?.state)),this.revertCommit=(t,a)=>{const h=this.store.selectSnapshot(G.$.selectedProfile);return this.store.dispatch(new A.z0(t,{name:"Revert commit",detail:a,do:()=>(0,x.D)([this.historyApi.getHeadCommitId(t),this.repositoriesApi.getCurrentBranch(t)]).pipe((0,r.w)(i=>this.commitsApi.revertCommit(t,a,h?.name??null,h?.email??null).pipe((0,r.w)(c=>this.store.dispatch(new e.jQ(t,c))),(0,g.K)(c=>o.fD.matches(c)?(0,s._)(()=>new d.ZR(c.message)):o.Nu.matches(c)||o.L8.matches(c)?(0,s._)(()=>new d.ZR(c.message,c.isHtml)):(0,s._)(()=>c)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranchCommitId,e.nh.headCommitId,e.nh.references]))),(0,u.C)(()=>(0,v.of)(i))))),undo:([i,c])=>i?this.repositoriesApi.updateBranch(t,c??"HEAD",i).pipe((0,g.K)(l=>o.Nu.matches(l)?(0,s._)(()=>new d.ZR(l.message,l.isHtml)):(0,s._)(()=>l)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.headCommitId,e.nh.references])))):(0,v.of)(void 0)}))},this.undoHeadCommit=t=>this.store.dispatch(new A.z0(t,{name:"Undo commit",detail:"HEAD",do:()=>this.historyApi.getHeadCommitId(t).pipe((0,r.w)(a=>this.commitsApi.undoHeadCommit(t).pipe((0,g.K)(h=>o.OV.matches(h)?(0,s._)(()=>new d.ZR(h.message)):(0,s._)(()=>h)),(0,u.C)(h=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranchCommitId,e.nh.headCommitId,e.nh.references,e.nh.stagedChanges,e.nh.submodules])).pipe((0,O.U)(()=>[a,h??[]])))))),undo:([a,h])=>a?(0,x.D)(h.map(i=>this.repositoriesApi.updateBranch(t,i,a))).pipe((0,g.K)(i=>o.Nu.matches(i)?(0,s._)(()=>new d.ZR(i.message,i.isHtml)):(0,s._)(()=>i)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranch,e.nh.currentBranchCommitId,e.nh.headCommitId,e.nh.references,e.nh.stagedChanges,e.nh.submodules])))):(0,v.of)(void 0)})),this.addSubmodule=(t,a,h,i)=>this.store.dispatch(new A.z0(t,{name:"Add submodule",detail:h,do:()=>this.submodulesApi.addSubmodule(t,a,h,i).pipe((0,g.K)(c=>o.vV.matches(c)?(0,s._)(()=>new d.ZR(c.message)):(0,s._)(()=>c)),(0,u.C)(c=>this.store.dispatch(new e.Vu(t,[e.nh.stagedChanges,e.nh.submodules,e.nh.unstagedChanges])).pipe((0,r.w)(()=>c?(0,v.of)(c):C.E))))})).pipe((0,O.U)(()=>this.store.selectSnapshot(F.h.mostRecentAction(t))?.state)),this.editSubmodule=(t,a,h)=>this.store.dispatch(new A.z0(t,{name:"Edit submodule",detail:`${a} -> ${h}`,do:()=>this.submodulesApi.editSubmodule(t,a,h).pipe((0,g.K)(i=>o.vV.matches(i)?(0,s._)(()=>new d.ZR(i.message)):(0,s._)(()=>i)),(0,u.C)(i=>this.store.dispatch(new e.Vu(t,[e.nh.stagedChanges,e.nh.submodules,e.nh.unstagedChanges])).pipe((0,r.w)(()=>i?(0,v.of)(i.url):C.E)))),undo:i=>this.submodulesApi.editSubmodule(t,a,i).pipe((0,g.K)(c=>o.vV.matches(c)?(0,s._)(()=>new d.ZR(c.message)):(0,s._)(()=>c)),(0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.stagedChanges,e.nh.submodules,e.nh.unstagedChanges]))))})),this.addRemote=(t,a,h)=>this.store.dispatch(new A.z0(t,{name:"Add remote",detail:`${a} -> ${h}`,do:()=>this.remotesApi.addRemote(t,a,h).pipe((0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranchUpstreamBranch,e.nh.merges,e.nh.references,e.nh.remotes]))))})),this.deleteRemote=(t,a)=>this.store.dispatch(new A.z0(t,{name:"Delete remote",detail:a,do:()=>this.remotesApi.deleteRemote(t,a).pipe((0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranchUpstreamBranch,e.nh.merges,e.nh.references,e.nh.remotes]))))})),this.updateRemoteUrl=(t,a,h)=>this.store.dispatch(new A.z0(t,{name:"Update remote url",detail:`${a} -> ${h}`,do:()=>this.remotesApi.updateRemoteUrl(t,a,h).pipe((0,u.C)(()=>this.store.dispatch(new e.Vu(t,[e.nh.commits,e.nh.currentBranchUpstreamBranch,e.nh.merges,e.nh.references,e.nh.remotes]))))}))}static{this.\u0275fac=function(w){return new(w||B)(n.LFG(T.uw),n.LFG(E.yh),n.LFG(ce.T),n.LFG(me.Q),n.LFG(oe.G),n.LFG(de.a),n.LFG(le.N))}}static{this.\u0275prov=n.Yz7({token:B,factory:B.\u0275fac,providedIn:"root"})}}return(0,R.gn)([(0,E.Ph)(G.$.selectedProfile)],B.prototype,"selectedProfile",void 0),B})()},5219:(Q,D,m)=>{m.d(D,{p:()=>s});var R=m(1135),E=m(4650);class s{constructor(){this.colorsByCommitId=new R.X({}),this.commitDetailsByCommitId=new R.X({})}getColors(){return this.colorsByCommitId.asObservable()}setColors(C){this.colorsByCommitId.next(C)}getCommits(){return this.commitDetailsByCommitId.asObservable()}setCommits(C){this.commitDetailsByCommitId.next(C)}static{this.\u0275fac=function(x){return new(x||s)}}static{this.\u0275prov=E.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}}}}]);