"use strict";(self.webpackChunkgit_glint=self.webpackChunkgit_glint||[]).push([[459],{5459:(fe,z,s)=>{s.r(z),s.d(z,{SearchLayoutModule:()=>B});var g=s(43144),f=s(15671),H=s(33179),w=s(65412),S=s(37084),Z=s(59549),K=s(284),q=s(28255),Q=s(51572),R=s(57093),Y=s(37072),e=s(94650),A=(0,g.Z)(function a(){(0,f.Z)(this,a)});A.\u0275fac=function(r){return new(r||A)},A.\u0275mod=e.oAB({type:A}),A.\u0275inj=e.cJS({imports:[w.Is,S.To,Z.lN,K.c,q.Tx,Q.Cq,H.I,R.v,Y.m]});var F=s(2367),E=s(60136),V=s(18486),ee=s(77579),I=s(78926),b=s(9967),ve=s(84745),te=s(97685),N=s(24006),L=s(61135),se=s(39841),xe=s(78372),ce=s(39300),ne=s(68675),oe=s(82722),O=s(34454),P=s(89867),M=s(36895),W=s(4859),ie=s(97392),X=s(10266),ae=s(74442),Ce=["input"];function Oe(a,r){if(1&a&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&a){var n=e.oxw();e.xp6(1),e.Oqu(n.searchTextControl.getError("regex"))}}function Pe(a,r){1&a&&e._UZ(0,"mat-spinner",12)}var Me=function(r){return{count:r}};function ye(a,r){if(1&a&&(e.TgZ(0,"div",10),e.YNc(1,Pe,1,0,"mat-spinner",11),e._uU(2),e.ALo(3,"translate"),e.ALo(4,"translate"),e.qZA()),2&a){var n=r.ngIf;e.xp6(1),e.Q6J("ngIf","ongoing"===n),e.xp6(1),e.hij(" ",n?"ongoing"===n?e.lcZ(3,2,"Searching..."):e.xi3(4,4,"Found _count_ results",e.VKq(7,Me,n.found)):"","\n")}}var D=function(a){(0,E.Z)(n,a);var r=(0,V.Z)(n);function n(t,o){var i;return(0,f.Z)(this,n),(i=r.call(this)).router=t,i.store=o,i.searchTextControl=new N.NI(i.store.selectSnapshot(O.po.searchText),{nonNullable:!0,validators:function(p){var c;if(null!==(c=i.useRegularExpressionControl)&&void 0!==c&&c.value)try{new RegExp(p.value,"g")}catch(m){return{regex:m.message}}return null}}),i.matchCaseControl=new N.NI(!1,{nonNullable:!0}),i.useRegularExpressionControl=new N.NI(!1,{nonNullable:!0}),i.searchStatus=new L.X(null),i}return(0,g.Z)(n,[{key:"ngOnInit",value:function(){var o=this;this.inputElement.nativeElement.focus(),(0,se.a)([this.searchTextControl.valueChanges.pipe((0,xe.b)(200),(0,ce.h)(function(){return o.searchTextControl.valid}),(0,ne.O)(this.searchTextControl.value)),this.matchCaseControl.valueChanges.pipe((0,ne.O)(this.matchCaseControl.value)),this.useRegularExpressionControl.valueChanges.pipe((0,ne.O)(this.useRegularExpressionControl.value))]).pipe((0,oe.R)(this.destroyed$)).subscribe(function(i){var l=(0,te.Z)(i,3),p=l[0],c=l[1],m=l[2];o.searchTextControl.updateValueAndValidity({emitEvent:!1}),o.searchStatus.next(p?"ongoing":null),o.store.dispatch(new O.ol(p,c,m))}),this.completed.pipe((0,oe.R)(this.destroyed$)).subscribe(function(i){o.searchStatus.next(null===i?o.searchTextControl.value?"ongoing":null:{found:i})})}},{key:"close",value:function(){this.router.navigate(["/standard/default"])}},{key:"clear",value:function(){this.searchTextControl.value?this.searchTextControl.setValue(""):(this.store.dispatch(new O.ol("",this.matchCaseControl.value,this.useRegularExpressionControl.value)),this.close())}}]),n}((0,I.j)(b.A));D.\u0275fac=function(r){return new(r||D)(e.Y36(F.F0),e.Y36(P.yh))},D.\u0275cmp=e.Xpm({type:D,selectors:[["app-search-action-view"]],viewQuery:function(r,n){var t;1&r&&e.Gf(Ce,7,e.SBq),2&r&&e.iGM(t=e.CRH())&&(n.inputElement=t.first)},inputs:{completed:"completed"},features:[e.qOj],decls:25,vars:24,consts:[["matPrefix",""],["type","text","matInput","",3,"formControl","placeholder"],["input",""],["type","button","matSuffix","","mat-button","","disableRipple","",3,"matTooltip","click"],["svgIcon","format-letter-case"],["svgIcon","regex"],["type","button","matSuffix","","mat-button","",3,"matTooltip","click"],[4,"ngIf"],["class","result-text",4,"ngIf"],["type","button","mat-icon-button","",1,"close-button","app-icon-button-md",3,"click"],[1,"result-text"],["diameter","24",4,"ngIf"],["diameter","24"]],template:function(r,n){1&r&&(e.TgZ(0,"mat-form-field")(1,"mat-label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"mat-icon",0),e._uU(5,"search"),e.qZA(),e._UZ(6,"input",1,2),e.ALo(8,"translate"),e.TgZ(9,"button",3),e.NdJ("click",function(){return n.matchCaseControl.setValue(!n.matchCaseControl.value)}),e.ALo(10,"translate"),e._UZ(11,"mat-icon",4),e.qZA(),e.TgZ(12,"button",3),e.NdJ("click",function(){return n.useRegularExpressionControl.setValue(!n.useRegularExpressionControl.value)}),e.ALo(13,"translate"),e._UZ(14,"mat-icon",5),e.qZA(),e.TgZ(15,"button",6),e.NdJ("click",function(){return n.clear()}),e.ALo(16,"translate"),e.TgZ(17,"mat-icon"),e._uU(18,"close"),e.qZA()(),e.YNc(19,Oe,2,1,"mat-error",7),e.qZA(),e.YNc(20,ye,5,9,"div",8),e.ALo(21,"async"),e.TgZ(22,"button",9),e.NdJ("click",function(){return n.close()}),e.TgZ(23,"mat-icon"),e._uU(24,"close"),e.qZA()()),2&r&&(e.xp6(2),e.Oqu(e.lcZ(3,12,"Find")),e.xp6(4),e.s9C("placeholder",e.lcZ(8,14,"Enter search text...")),e.Q6J("formControl",n.searchTextControl),e.xp6(3),e.ekj("selected",n.matchCaseControl.value),e.Q6J("matTooltip",e.lcZ(10,16,"Match case")),e.xp6(3),e.ekj("selected",n.useRegularExpressionControl.value),e.Q6J("matTooltip",e.lcZ(13,18,"Use regular expression")),e.xp6(3),e.Q6J("matTooltip",e.lcZ(16,20,"Clear")),e.xp6(4),e.Q6J("ngIf",n.searchTextControl.hasError("regex")),e.xp6(1),e.Q6J("ngIf",e.lcZ(21,22,n.searchStatus)))},dependencies:[Z.KE,Z.hX,Z.TO,Z.qo,Z.R9,K.Nt,Q.Ou,M.O5,N.Fj,N.JJ,N.oH,W.lW,W.RK,ie.Hw,X.gM,M.Ov,ae.X],styles:["[_nghost-%COMP%]{position:relative;display:block;text-align:center;padding:10px 5px 5px;height:69px}mat-form-field[_ngcontent-%COMP%]  .mat-mdc-form-field-icon-suffix{display:flex;align-items:center;gap:4px;margin-right:9px}mat-form-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:2px solid transparent;min-width:36px}mat-form-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin:0;font-size:24px;width:24px;height:24px}.result-text[_ngcontent-%COMP%]{display:inline-flex;gap:10px;align-items:center;position:absolute;top:calc(50% - 8px);margin-left:10px}.close-button[_ngcontent-%COMP%]{position:absolute;right:20px;top:calc(50% - 18px)}.dark-theme[_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%]{border-color:#78909c}.light-theme[_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%]{border-color:#78909c}"],changeDetection:0});var pe=s(1413),C=s(74902),we=s(11848),Ze=s(60515),Re=s(63900),Te=s(70262),me=s(28746),ue=s(3825),_e=s(32120),Se=s(75938),T=s(36966),Ae=s(63779),Fe=s(7016),k=function(){function a(r){(0,f.Z)(this,a),this.baseApi=r}return(0,g.Z)(a,[{key:"search",value:function(n,t,o,i,l){return this.baseApi.stream(Ae.w.search.onSearchResult,n,t,o,i,l)}}]),a}();k.\u0275fac=function(r){return new(r||k)(e.LFG(Fe._))},k.\u0275prov=e.Yz7({token:k,factory:k.\u0275fac,providedIn:"root"});var G=s(70655),v=s(4883),$=s(82270),le=s(82771),_=s(64889),Ee=s(66406),he=s(71884),Ve=s(59468),re=function(){function a(r,n){var t=this;(0,f.Z)(this,a),this.itemWidth=r,this.itemHeight=n,this.containerSize=new L.X([0,0]),this.index$=new ee.x,this.resizeObserver=new ResizeObserver(function(o){o[0]&&t.containerSize.next([o[0].contentRect.width,o[0].contentRect.height])}),this.viewport=null,this.scrolledIndexChange=this.index$.pipe((0,he.x)()),this.containerSize.pipe((0,Ve.p)(20,Ee.Z,{leading:!0,trailing:!0})).subscribe(function(o){var i=(0,te.Z)(o,2);if(t.viewport){var c=Math.floor(i[0]/t.itemWidth),m=Math.ceil(t.viewport.getDataLength()/c);t.viewport.setTotalContentSize(m*t.itemHeight),t.viewport.checkViewportSize(),t.updateRenderedRange(t.viewport)}})}return(0,g.Z)(a,[{key:"attach",value:function(n){this.index$=new ee.x,this.scrolledIndexChange=this.index$.pipe((0,he.x)()),this.viewport=n,this.resizeObserver.disconnect(),this.resizeObserver.observe(n.elementRef.nativeElement),this.containerSize.next([n.elementRef.nativeElement.clientWidth,n.elementRef.nativeElement.clientHeight]);var t=Math.floor(this.containerSize.value[0]/this.itemWidth),o=Math.ceil(n.getDataLength()/t);n.setTotalContentSize(o*this.itemHeight),this.updateRenderedRange(n)}},{key:"detach",value:function(){this.index$.complete(),this.resizeObserver.disconnect(),this.viewport=null}},{key:"onContentScrolled",value:function(){this.viewport&&this.updateRenderedRange(this.viewport)}},{key:"onDataLengthChanged",value:function(){if(this.viewport){var n=Math.floor(this.containerSize.value[0]/this.itemWidth),t=Math.ceil(this.viewport.getDataLength()/n);this.viewport.setTotalContentSize(t*this.itemHeight),this.updateRenderedRange(this.viewport)}}},{key:"onContentRendered",value:function(){if(this.viewport){var n=this.viewport.getRenderedRange();this.viewport.setRenderedContentOffset(this.getOffsetForIndex(n.start))}}},{key:"onRenderedOffsetChanged",value:function(){this.viewport&&this.updateRenderedRange(this.viewport)}},{key:"scrollToIndex",value:function(n,t){this.viewport&&this.viewport.scrollToOffset(this.getOffsetForIndex(n),t)}},{key:"getOffsetForIndex",value:function(n){var t=Math.floor(this.containerSize.value[0]/this.itemWidth);return Math.ceil(n/t)*this.itemHeight}},{key:"getIndexForOffset",value:function(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=Math.floor(n/this.itemHeight),i=Math.floor(this.containerSize.value[0]/this.itemWidth);return o*i+(t?0:i-1)}},{key:"updateRenderedRange",value:function(n){var t=2*this.itemHeight,o=4*this.itemHeight,i=n.getViewportSize(),l=n.measureScrollOffset(),p=n.getRenderedRange(),c=p.start,m=p.end,u={start:c,end:m},h=this.getIndexForOffset(l),d=l-this.getOffsetForIndex(c),y=this.getOffsetForIndex(m)-(l+i);d<t&&0!==c&&(u.start=Math.max(0,this.getIndexForOffset(l-o))),y<t&&m!==n.getDataLength()&&(u.end=Math.min(this.getIndexForOffset(l+i+o,!1),n.getDataLength())),n.setRenderedRange(u),n.setRenderedContentOffset(this.getOffsetForIndex(u.start)),this.index$.next(h)}}]),a}(),de=s(73546),ge=s(53051);function Ie(a,r){if(1&a){var n=e.EpF();e.TgZ(0,"li")(1,"mat-card",3)(2,"div",4),e._uU(3),e.qZA(),e.TgZ(4,"div",5)(5,"div",6),e._UZ(6,"app-avatar",7),e.ALo(7,"async"),e._uU(8),e.qZA(),e.TgZ(9,"div",8),e.NdJ("click",function(){var p=e.CHM(n).$implicit,c=e.oxw();return e.KtG(c.gotoCommit(p.id))}),e._uU(10),e.qZA()()()()}if(2&a){var t=r.$implicit,o=e.oxw();e.xp6(2),e.Q6J("matTooltip",t.message),e.xp6(1),e.Oqu(t.message),e.xp6(2),e.Q6J("matTooltip",t.authorName+" ("+t.authorEmail+")"),e.xp6(1),e.Q6J("remotes",e.lcZ(7,8,o.remotes))("email",t.authorEmail),e.xp6(2),e.hij(" ",t.authorName," "),e.xp6(1),e.Q6J("matTooltip",t.id),e.xp6(1),e.Oqu(t.id)}}var be=function(){var a=function(r){(0,E.Z)(t,r);var n=(0,V.Z)(t);function t(o,i){var l;return(0,f.Z)(this,t),(l=n.call(this)).router=o,l.store=i,l}return(0,g.Z)(t,[{key:"trackByCommits",value:function(i,l){return l.id}},{key:"gotoCommit",value:function(i,l){var p=this,c=this.store.selectSnapshot(T.E.selectedRepositoryPath);if(!c)throw new $.uX;this.store.dispatch([new _.jQ(c,i)].concat((0,C.Z)(l?[new _.gt(c,{area:"commit",oldFilePath:l.oldPath,newFilePath:l.newPath})]:[]),[new _.BK(c,i)])).subscribe(function(){p.router.navigate(["/standard/default"])})}}]),t}((0,I.j)(b.A,le.P));return a.\u0275fac=function(n){return new(n||a)(e.Y36(F.F0),e.Y36(P.yh))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-commit-search-results-view"]],viewQuery:function(n,t){var o;1&n&&e.Gf(v.N7,5),2&n&&e.iGM(o=e.CRH())&&(t.viewports=o)},inputs:{commitResults:"commitResults"},features:[e._Bn([{provide:v.yU,useValue:new re(310,135)}]),e.qOj],decls:4,vars:4,consts:[[1,"item-list-container"],[1,"main-list"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["appearance","outlined"],[1,"message",3,"matTooltip"],[1,"bottom"],[1,"author",3,"matTooltip"],[3,"remotes","email"],[1,"commit-id",3,"matTooltip","click"]],template:function(n,t){1&n&&(e.TgZ(0,"cdk-virtual-scroll-viewport",0)(1,"ul",1),e.YNc(2,Ie,11,10,"li",2),e.ALo(3,"async"),e.qZA()()),2&n&&(e.xp6(2),e.Q6J("cdkVirtualForOf",e.lcZ(3,2,t.commitResults))("cdkVirtualForTrackBy",t.trackByCommits))},dependencies:[v.x0,v.N7,de.a8,X.gM,ge.A,M.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.main-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:-5px 5px -5px -5px;padding-right:8px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin:5px;height:125px;width:300px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;gap:10px;height:125px;width:300px;padding:16px;overflow:hidden}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{overflow:hidden;display:-webkit-box;text-overflow:ellipsis;-webkit-line-clamp:3;-webkit-box-orient:vertical;font-weight:700}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{margin-right:20px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:170px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   app-avatar[_ngcontent-%COMP%]{width:22px;height:22px;margin-right:3px;vertical-align:middle}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]   .commit-id[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;min-height:20px;width:80px}"],changeDetection:0}),(0,G.gn)([(0,P.Ph)(T.E.selectedRemotes)],a.prototype,"remotes",void 0),a}(),Ne=s(84924),Le=s(20790),ke=s(29131),Je=s(95410),Ue=["fileSnippetDialog"];function Be(a,r){if(1&a){var n=e.EpF();e.TgZ(0,"li",8),e.NdJ("click",function(){var p=e.CHM(n).$implicit,c=e.oxw(2);return e.KtG(c.openFileSnippetPopup(p))}),e.TgZ(1,"div",9),e._UZ(2,"app-avatar",10),e.ALo(3,"async"),e.TgZ(4,"span",11),e._uU(5),e.qZA()(),e.TgZ(6,"div",12),e._uU(7),e.qZA()()}if(2&a){var t=r.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("matTooltip",t.authorName+" ("+t.authorEmail+")"),e.xp6(1),e.Q6J("remotes",e.lcZ(3,6,o.remotes))("email",t.authorEmail),e.xp6(3),e.Oqu(t.authorName),e.xp6(1),e.Q6J("matTooltip",t.commitMessage+"\n"+t.commitId),e.xp6(1),e.Oqu(t.commitMessage)}}function Qe(a,r){if(1&a&&(e.TgZ(0,"li")(1,"mat-card",4),e._UZ(2,"app-condensed-path",5),e.TgZ(3,"ul",6),e.YNc(4,Be,8,8,"li",7),e.qZA()()()),2&a){var n=r.$implicit,t=e.oxw();e.xp6(2),e.Q6J("path",n.path),e.xp6(2),e.Q6J("ngForOf",n.snippets)("ngForTrackBy",t.trackByFileSnippets)}}function De(a,r){if(1&a){var n=e.EpF();e.TgZ(0,"div",13),e._UZ(1,"app-condensed-path",5),e.TgZ(2,"button",14)(3,"mat-icon"),e._uU(4,"close"),e.qZA()()(),e.TgZ(5,"mat-dialog-content",15)(6,"div",16)(7,"div",17),e._uU(8),e.qZA(),e.TgZ(9,"div",18)(10,"div",9),e._UZ(11,"app-avatar",10),e.ALo(12,"async"),e.TgZ(13,"span",11),e._uU(14),e.qZA()(),e.TgZ(15,"div",19),e.NdJ("click",function(){var p=e.CHM(n).$implicit,c=e.oxw();return e.KtG(c.gotoCommit(p.result.commitId,p.result))})("contextmenu",function(){var p=e.CHM(n).$implicit,c=e.oxw();return e.KtG(c.copyToClipboard(p.result.commitId))}),e._uU(16),e.qZA()()(),e.TgZ(17,"div",20),e.ALo(18,"async"),e._UZ(19,"app-diff-view",21),e.qZA()(),e.TgZ(20,"mat-dialog-actions")(21,"button",22),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"button",23),e.NdJ("click",function(){var p=e.CHM(n).$implicit,c=e.oxw();return e.KtG(c.gotoCommit(p.result.commitId,p.result))}),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"button",24),e.NdJ("click",function(){var p=e.CHM(n).$implicit,c=e.oxw();return e.KtG(c.blameFile(p.result))}),e._uU(28),e.ALo(29,"translate"),e.qZA()()}if(2&a){var t=r.$implicit,o=e.oxw();e.xp6(1),e.Q6J("path",t.result.oldPath||t.result.newPath),e.xp6(1),e.Q6J("mat-dialog-close",!1),e.xp6(6),e.Oqu(t.result.commitMessage),e.xp6(2),e.Q6J("matTooltip",t.result.authorName+" ("+t.result.authorEmail+")"),e.xp6(1),e.Q6J("remotes",e.lcZ(12,22,o.remotes))("email",t.result.authorEmail),e.xp6(3),e.Oqu(t.result.authorName),e.xp6(1),e.Q6J("matTooltip",t.result.commitId)("mat-dialog-close",!0),e.xp6(1),e.Oqu(t.result.commitId),e.xp6(1),e.Q6J("ngClass",e.lcZ(18,24,o.theme)+"-theme"),e.xp6(2),e.Q6J("patch",t.patch)("hideClose",!0)("search",t.search),e.xp6(2),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.Oqu(e.lcZ(23,26,"Cancel")),e.xp6(2),e.Q6J("matTooltip",t.result.commitId)("mat-dialog-close",!0),e.xp6(1),e.Oqu(e.lcZ(26,28,"Goto commit")),e.xp6(2),e.Q6J("mat-dialog-close",!0)("matTooltip",t.result.newPath),e.xp6(1),e.Oqu(e.lcZ(29,30,"Blame file"))}}var je=function(){var a=function(r){(0,E.Z)(t,r);var n=(0,V.Z)(t);function t(o,i,l,p){var c;return(0,f.Z)(this,t),(c=n.call(this)).router=o,c.dialog=i,c.store=l,c.commitsApi=p,c}return(0,g.Z)(t,[{key:"trackByFiles",value:function(i,l){return l.path}},{key:"trackByFileSnippets",value:function(i,l){return l.commitId}},{key:"gotoCommit",value:function(i,l){var p=this,c=this.store.selectSnapshot(T.E.selectedRepositoryPath);if(!c)throw new $.uX;this.store.dispatch([new _.jQ(c,i)].concat((0,C.Z)(l?[new _.gt(c,{area:"commit",oldFilePath:l.oldPath,newFilePath:l.newPath})]:[]),[new _.BK(c,i)])).subscribe(function(){p.router.navigate(["/standard/default"])})}},{key:"openFileSnippetPopup",value:function(i){var l=this,p=this.store.selectSnapshot(T.E.selectedRepositoryPath);if(!p)throw new $.uX;this.commitsApi.getPatch(p,i.commitId,i.oldPath,i.newPath).subscribe(function(c){l.dialog.open(l.fileSnippetDialog,{data:{result:i,patch:new L.X({repositoryPath:p,patch:c,isUnstaged:!1}),search:{text:l.store.selectSnapshot(O.po.searchText),matchCase:l.store.selectSnapshot(O.po.matchCase),useRegularExpression:l.store.selectSnapshot(O.po.useRegularExpression)}}})})}},{key:"copyToClipboard",value:function(i){navigator.clipboard.writeText(i??"").then(function(){})}},{key:"blameFile",value:function(i){this.router.navigate(["/standard/blame"],{queryParams:{area:"commit","commit-id":i.commitId,path:i.newPath}})}}]),t}((0,I.j)(b.A,le.P));return a.\u0275fac=function(n){return new(n||a)(e.Y36(F.F0),e.Y36(w.uw),e.Y36(P.yh),e.Y36(Le.T))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-file-search-results-view"]],viewQuery:function(n,t){var o;1&n&&(e.Gf(Ue,5),e.Gf(v.N7,5)),2&n&&(e.iGM(o=e.CRH())&&(t.fileSnippetDialog=o.first),e.iGM(o=e.CRH())&&(t.viewports=o))},inputs:{fileResults:"fileResults"},features:[e._Bn([{provide:v.yU,useValue:new re(310,160)}]),e.qOj],decls:6,vars:4,consts:[[1,"item-list-container"],[1,"main-list"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["fileSnippetDialog",""],["appearance","outlined"],[1,"path",3,"path"],[1,"sub-list"],[3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[3,"click"],[1,"author",3,"matTooltip"],[3,"remotes","email"],[1,"name"],[1,"message",3,"matTooltip"],["mat-dialog-title","",1,"snippet-dialog-title"],["type","button","mat-icon-button","",1,"app-icon-button-md",3,"mat-dialog-close"],[1,"snippet-dialog"],[1,"top"],[1,"message"],[1,"right"],[1,"id",3,"matTooltip","mat-dialog-close","click","contextmenu"],[1,"diff",3,"ngClass"],[3,"patch","hideClose","search"],["type","button","mat-button","","cdkFocusInitial","",3,"mat-dialog-close"],["type","button","mat-button","","color","primary",3,"matTooltip","mat-dialog-close","click"],["type","button","mat-button","","color","accent",3,"mat-dialog-close","matTooltip","click"]],template:function(n,t){1&n&&(e.TgZ(0,"cdk-virtual-scroll-viewport",0)(1,"ul",1),e.YNc(2,Qe,5,3,"li",2),e.ALo(3,"async"),e.qZA()(),e.YNc(4,De,30,32,"ng-template",null,3,e.W1O)),2&n&&(e.xp6(2),e.Q6J("cdkVirtualForOf",e.lcZ(3,2,t.fileResults))("cdkVirtualForTrackBy",t.trackByFiles))},dependencies:[w.ZT,w.uh,w.xY,w.H8,v.x0,v.N7,M.mk,M.sg,W.lW,W.RK,de.a8,ie.Hw,X.gM,ge.A,ke.j,Je.s,M.Ov,ae.X],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.main-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:-5px 5px -5px -5px;padding-right:8px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin:5px;height:150px;width:300px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;padding:16px;height:150px;width:300px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .path[_ngcontent-%COMP%]{margin-bottom:10px;font-weight:700}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .sub-list[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .sub-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{cursor:pointer;display:flex;gap:10px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .sub-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:0 0 80px;display:flex;align-items:center;gap:5px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .sub-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   app-avatar[_ngcontent-%COMP%]{width:18px;height:18px;flex:0 0 auto}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .sub-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]   .sub-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}.snippet-dialog-title[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-top:10px}.snippet-dialog[_ngcontent-%COMP%]{height:65vh;width:80vw;display:flex;flex-direction:column}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{margin-right:40px;white-space:pre;max-height:100px;overflow:auto;flex:100 0 auto;padding-right:5px}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{overflow:hidden;min-width:80px;max-width:200px}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:0 0 80px;display:flex;align-items:center;gap:8px;margin-bottom:5px}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   app-avatar[_ngcontent-%COMP%]{width:24px;height:24px;flex:0 0 auto}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.snippet-dialog[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .id[_ngcontent-%COMP%]{cursor:pointer;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.snippet-dialog[_ngcontent-%COMP%]   .diff[_ngcontent-%COMP%]{position:relative;padding:10px 10px 0;overflow:hidden;flex:1 0 auto}.snippet-dialog[_ngcontent-%COMP%]   .diff.dark-theme[_ngcontent-%COMP%]{background:#1e1e1e}.snippet-dialog[_ngcontent-%COMP%]   .diff.light-theme[_ngcontent-%COMP%]{background:#fafafa}.snippet-dialog[_ngcontent-%COMP%]   .diff[_ngcontent-%COMP%]   app-diff-view[_ngcontent-%COMP%]{position:relative}"],changeDetection:0}),(0,G.gn)([(0,P.Ph)(T.E.selectedRemotes)],a.prototype,"remotes",void 0),(0,G.gn)([(0,P.Ph)(Ne.$.theme)],a.prototype,"theme",void 0),a}();function ze(a,r){if(1&a){var n=e.EpF();e.TgZ(0,"li",3),e.NdJ("click",function(){var p=e.CHM(n).$implicit,c=e.oxw();return e.KtG(c.gotoCommit(p.commitId))}),e.TgZ(1,"mat-icon",4),e._uU(2),e.qZA(),e.TgZ(3,"span",4),e._uU(4),e.qZA()()}if(2&a){var t=r.$implicit,o=e.oxw();e.xp6(1),e.Q6J("matTooltip",t.sourceName),e.xp6(1),e.Oqu(o.getBranchTypeIcon(t.type)),e.xp6(1),e.Q6J("matTooltip",t.refName),e.xp6(1),e.Oqu(t.shortName)}}var He=function(){var a=function(r){(0,E.Z)(t,r);var n=(0,V.Z)(t);function t(o,i){var l;return(0,f.Z)(this,t),(l=n.call(this)).router=o,l.store=i,l.getBranchTypeIcon=function(p){switch(p){case"local":return"desktop_windows";case"remote":return"cloud_queue";case"tag":return"label"}},l}return(0,g.Z)(t,[{key:"trackByReferences",value:function(i,l){return l.refName}},{key:"gotoCommit",value:function(i){var l=this,p=this.store.selectSnapshot(T.E.selectedRepositoryPath);if(!p)throw new $.uX;this.store.dispatch([new _.jQ(p,i),new _.BK(p,i)]).subscribe(function(){l.router.navigate(["/standard/default"])})}}]),t}((0,I.j)(b.A,le.P));return a.\u0275fac=function(n){return new(n||a)(e.Y36(F.F0),e.Y36(P.yh))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-reference-search-results-view"]],viewQuery:function(n,t){var o;1&n&&e.Gf(v.N7,5),2&n&&e.iGM(o=e.CRH())&&(t.viewports=o)},inputs:{referenceResults:"referenceResults"},features:[e._Bn([{provide:v.yU,useValue:new re(220,34)}]),e.qOj],decls:5,vars:4,consts:[[1,"item-list-container"],[1,"main-list"],[3,"click",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[3,"click"],[3,"matTooltip"]],template:function(n,t){1&n&&(e.TgZ(0,"cdk-virtual-scroll-viewport",0)(1,"div",0)(2,"ul",1),e.YNc(3,ze,5,4,"li",2),e.ALo(4,"async"),e.qZA()()()),2&n&&(e.xp6(3),e.Q6J("cdkVirtualForOf",e.lcZ(4,2,t.referenceResults))("cdkVirtualForTrackBy",t.trackByReferences))},dependencies:[v.x0,v.N7,ie.Hw,X.gM,M.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden}.main-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:0 -10px;padding-right:8px}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{margin:5px 10px;cursor:pointer;width:200px;height:24px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.main-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:5px}"],changeDetection:0}),(0,G.gn)([(0,P.Ph)(T.E.selectedRemotes)],a.prototype,"remotes",void 0),a}(),Ke=s(30744);function Ye(a,r){if(1&a&&(e.TgZ(0,"mat-expansion-panel",4)(1,"mat-expansion-panel-header"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"app-reference-search-results-view",5),e.qZA()),2&a){var n=r.ngIf,t=e.oxw();e.xp6(2),e.AsE("",e.lcZ(3,3,"References")," (",n.length,")"),e.xp6(2),e.Q6J("referenceResults",t.referenceResults)}}function We(a,r){if(1&a&&(e.TgZ(0,"mat-expansion-panel",6)(1,"mat-expansion-panel-header"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"app-commit-search-results-view",7),e.qZA()),2&a){var n=r.ngIf,t=e.oxw();e.xp6(2),e.AsE("",e.lcZ(3,3,"Commits")," (",n.length,")"),e.xp6(2),e.Q6J("commitResults",t.commitResults)}}function Xe(a,r){if(1&a&&(e.TgZ(0,"mat-expansion-panel",8)(1,"mat-expansion-panel-header"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"app-file-search-results-view",9),e.qZA()),2&a){var n=r.ngIf,t=e.oxw();e.xp6(2),e.AsE("",e.lcZ(3,3,"Files")," (",n.length,")"),e.xp6(2),e.Q6J("fileResults",t.fileResults)}}var j=function(a){(0,E.Z)(n,a);var r=(0,V.Z)(n);function n(t,o){var i;return(0,f.Z)(this,n),(i=r.call(this)).store=t,i.searchApi=o,i.completed=new e.vpe,i.referenceResults=new L.X([]),i.commitResults=new L.X([]),i.fileResults=new L.X([]),i}return(0,g.Z)(n,[{key:"ngOnInit",value:function(){var o=this;(0,se.a)([this.store.select(O.po.searchText),this.store.select(O.po.matchCase),this.store.select(O.po.useRegularExpression),this.store.select(T.E.selectedRepositoryPath).pipe((0,ce.h)(_e.$K))]).pipe((0,Re.w)(function(i){var l=(0,te.Z)(i,4),p=l[0],c=l[1],m=l[2],u=l[3];return o.referenceResults.next([]),o.commitResults.next([]),o.fileResults.next([]),o.completed.next(null),p?o.searchApi.search(u,c,m,p).pipe((0,Te.K)(function(h){return o.store.dispatch(new Se.hx("error","".concat(h))),Ze.E}),(0,me.x)(function(){o.completed.next(o.referenceResults.value.length+o.commitResults.value.length+o.fileResults.value.length)})):we.C}),(0,me.x)(function(){o.completed.next(null)}),(0,oe.R)(this.destroyed$)).subscribe(function(i){switch(i.type){case"reference":var l=o.formatReferenceResult(i);l&&o.referenceResults.next([].concat((0,C.Z)(o.referenceResults.value),[l]));break;case"commit":o.commitResults.next([].concat((0,C.Z)(o.commitResults.value),[i]));break;case"file":o.fileResults.next(o.addFileResult(o.fileResults.value,i))}})}},{key:"formatReferenceResult",value:function(o){var p,l=/^refs\/heads\/(.*)$/.exec(o.refName);if(l)return{type:"local",refName:o.refName,shortName:null!==(p=l[1])&&void 0!==p?p:"",sourceName:(0,ue.Iu)("local"),commitId:o.commitId};var u,h,m=/^refs\/remotes\/([^\/]+)\/(.*)$/.exec(o.refName);if(m)return{type:"remote",refName:o.refName,shortName:null!==(u=m[2])&&void 0!==u?u:"",sourceName:null!==(h=m[1])&&void 0!==h?h:"",commitId:o.commitId};var x,y=/^refs\/tags\/(.*)$/.exec(o.refName);return y?{type:"tag",refName:o.refName,shortName:null!==(x=y[1])&&void 0!==x?x:"",sourceName:(0,ue.Iu)("tag"),commitId:o.commitId}:null}},{key:"addFileResult",value:function(o,i){for(var l=!!i.oldPath,p=!!i.newPath,c=null,m=null,u=null,h=null,d=0;d<o.length;d++){var y=o[d];if(y.path===i.oldPath&&(c=d),y.path===i.newPath&&(m=d),i.oldPath&&y.path>i.oldPath&&(u=d),i.newPath&&y.path>i.newPath&&(h=d),!(l&&null===c&&null===u||p&&null===m&&null===h))break}var x=o;return l&&p?null!==c||null===u||null!==h&&u>h?(x=this.addFileSnippet(o,i,c,u),x=this.addFileSnippet(o,i,m,h)):(x=this.addFileSnippet(o,i,m,h),x=this.addFileSnippet(o,i,c,u)):l?x=this.addFileSnippet(o,i,c,u):p&&(x=this.addFileSnippet(o,i,m,h)),x}},{key:"addFileSnippet",value:function(o,i,l,p){var c,m;if(null!==l){var u=o[l];if(u)return[].concat((0,C.Z)(o.slice(0,l)),[(0,pe.Z)((0,pe.Z)({},u),{},{snippets:[].concat((0,C.Z)(u.snippets),[i])})],(0,C.Z)(o.slice(l+1)))}else if(null!==p){var h,d;return[].concat((0,C.Z)(o.slice(0,p)),[{path:null!==(h=null!==(d=i.newPath)&&void 0!==d?d:i.oldPath)&&void 0!==h?h:"",snippets:[i]}],(0,C.Z)(o.slice(p)))}return[].concat((0,C.Z)(o),[{path:null!==(c=null!==(m=i.newPath)&&void 0!==m?m:i.oldPath)&&void 0!==c?c:"",snippets:[i]}])}}]),n}((0,I.j)(b.A));j.\u0275fac=function(r){return new(r||j)(e.Y36(P.yh),e.Y36(k))},j.\u0275cmp=e.Xpm({type:j,selectors:[["app-search-results-view"]],outputs:{completed:"completed"},features:[e.qOj],decls:10,vars:15,consts:[["multi",""],["class","references","expanded","",4,"ngIf"],["class","commits","expanded","",4,"ngIf"],["class","files","expanded","",4,"ngIf"],["expanded","",1,"references"],[3,"referenceResults"],["expanded","",1,"commits"],[3,"commitResults"],["expanded","",1,"files"],[3,"fileResults"]],template:function(r,n){1&r&&(e.TgZ(0,"mat-accordion",0),e.YNc(1,Ye,5,5,"mat-expansion-panel",1),e.ALo(2,"nullEmpty"),e.ALo(3,"async"),e.YNc(4,We,5,5,"mat-expansion-panel",2),e.ALo(5,"nullEmpty"),e.ALo(6,"async"),e.YNc(7,Xe,5,5,"mat-expansion-panel",3),e.ALo(8,"nullEmpty"),e.ALo(9,"async"),e.qZA()),2&r&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,3,e.lcZ(3,5,n.referenceResults))),e.xp6(3),e.Q6J("ngIf",e.lcZ(5,7,e.lcZ(6,9,n.commitResults))),e.xp6(3),e.Q6J("ngIf",e.lcZ(8,11,e.lcZ(9,13,n.fileResults))))},dependencies:[S.pp,S.ib,S.yz,M.O5,be,je,He,M.Ov,Ke.x,ae.X],styles:["[_nghost-%COMP%]{display:block;height:calc(100% - 69px)}mat-accordion[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%}mat-expansion-panel[_ngcontent-%COMP%]{flex-shrink:3;display:flex;flex-direction:column;min-height:48px;background:transparent!important;box-shadow:none!important}mat-expansion-panel.mat-expansion-panel-spacing[_ngcontent-%COMP%]{min-height:96px}mat-expansion-panel.mat-expansion-panel-spacing[_ngcontent-%COMP%] + mat-expansion-panel.mat-expansion-panel-spacing[_ngcontent-%COMP%]{margin:0 0 16px}mat-expansion-panel.mat-expansion-panel-spacing.files[_ngcontent-%COMP%]{margin-bottom:0!important}mat-expansion-panel.mat-expanded.references[_ngcontent-%COMP%]{min-height:99px}mat-expansion-panel.mat-expanded.commits[_ngcontent-%COMP%]{min-height:216.75px}mat-expansion-panel.mat-expanded.files[_ngcontent-%COMP%]{min-height:248px}mat-expansion-panel[_ngcontent-%COMP%]   .references[_ngcontent-%COMP%]{flex-shrink:1}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header[_ngcontent-%COMP%]{height:48px;padding:0 20px;font-size:20px;flex:0 0 auto}mat-expansion-panel[_ngcontent-%COMP%]   mat-expansion-panel-header.mat-expanded[_ngcontent-%COMP%]{height:48px}mat-expansion-panel[_ngcontent-%COMP%]     .mat-expansion-panel-content{overflow:hidden}mat-expansion-panel[_ngcontent-%COMP%]     .mat-expansion-panel-content.ng-animating .item-list-container{overflow-y:hidden}mat-expansion-panel[_ngcontent-%COMP%]     .mat-expansion-panel-content .mat-expansion-panel-body{display:flex;flex-direction:column;overflow:hidden;padding:0 0 0 24px}mat-expansion-panel[_ngcontent-%COMP%]     .item-list-container{contain:content;scrollbar-gutter:stable}mat-expansion-panel[_ngcontent-%COMP%]     .item-list-container   .cdk-virtual-scroll-spacer{position:relative}"],changeDetection:0});var J=function(a){(0,E.Z)(n,a);var r=(0,V.Z)(n);function n(){var t;return(0,f.Z)(this,n),(t=r.apply(this,arguments)).completed=new ee.x,t}return(0,g.Z)(n)}((0,I.j)(b.A,ve.H));J.\u0275fac=function(){var a;return function(n){return(a||(a=e.n5z(J)))(n||J)}}(),J.\u0275cmp=e.Xpm({type:J,selectors:[["ng-component"]],features:[e.qOj],decls:2,vars:1,consts:[[3,"completed"]],template:function(r,n){1&r&&(e._UZ(0,"app-search-action-view",0),e.TgZ(1,"app-search-results-view",0),e.NdJ("completed",function(o){return n.completed.next(o)}),e.qZA()),2&r&&e.Q6J("completed",n.completed)},dependencies:[D,j],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:calc(100% - 50px)}"],changeDetection:0});var Ge=[{path:"",component:J}],U=(0,g.Z)(function a(){(0,f.Z)(this,a)});U.\u0275fac=function(r){return new(r||U)},U.\u0275mod=e.oAB({type:U}),U.\u0275inj=e.cJS({imports:[F.Bz.forChild(Ge),F.Bz]});var B=(0,g.Z)(function a(){(0,f.Z)(this,a)});B.\u0275fac=function(r){return new(r||B)},B.\u0275mod=e.oAB({type:B}),B.\u0275inj=e.cJS({imports:[H.I,U,A]})},57093:(fe,z,s)=>{s.d(z,{v:()=>R});var g=s(43144),f=s(15671),H=s(65412),w=s(59549),S=s(284),Z=s(51572),K=s(84385),q=s(33179),Q=s(94650),R=(0,g.Z)(function Y(){(0,f.Z)(this,Y)});R.\u0275fac=function(e){return new(e||R)},R.\u0275mod=Q.oAB({type:R}),R.\u0275inj=Q.cJS({imports:[H.Is,w.lN,S.c,Z.Cq,K.LD,q.I]})}}]);