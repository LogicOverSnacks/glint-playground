import{b as kt,c as It,d as Ft,e as ge}from"./chunk-DZWNELDV.js";import{a as N}from"./chunk-W4AEKMBR.js";import{G as ye,p as m,q as F,z as te}from"./chunk-ZK5OAROB.js";import{$a as De,$f as Dt,$i as qt,Aa as Pt,B as le,Ba as se,Bh as Ht,C as Ue,Ca as wt,Cb as _,Db as P,De as yt,E as Fe,Ea as xt,Eb as fe,Ee as Ke,Eg as ot,Fa as ae,Fb as me,Ff as Oe,G as Pe,Ga as b,Gb as vt,H as ft,Ia as ze,If as G,Ig as Bt,Ja as Ot,Jf as Se,Lf as Vt,M as mt,Mb as xe,Nb as Ne,Ng as ne,O as Ve,Oa as Z,Ob as $e,Og as Nt,Oi as He,P as _t,Pg as lt,Q as re,Qa as K,R as S,Ra as Xe,Ri as Ut,S as we,Sa as qe,Sb as ce,Sd as Je,Se as Lt,Sg as de,Ta as Ge,Tf as Tt,U as Ct,Ua as g,Ui as zt,Va as f,Vg as cn,Wa as M,Xa as B,Xi as Xt,Yf as Et,Z as Te,_ as Mt,_i as ue,a as V,aa as Ee,ab as Be,ag as et,ah as $t,aj as Gt,b as U,bj as be,cb as q,ch as rt,cj as Jt,d as an,da as W,dg as _e,dj as Yt,ea as Q,eb as z,eg as tt,fb as x,fg as nt,fi as Wt,ge as Ye,he as Ze,hh as Rt,i as ut,ii as Qt,j as X,jb as $,ji as je,kb as R,lb as A,lh as At,m as We,nb as j,nh as jt,o as L,p as oe,pa as ee,pj as Zt,q as D,qb as y,r as Y,rb as I,sd as bt,t as Ie,th as pe,u as Qe,ug as Ae,uh as he,va as p,vf as Re,wh as ve,x as gt,xh as ie,yb as St,yg as it,z as Me,za as k}from"./chunk-R5KNYV3F.js";var Kt=(()=>{class l{constructor(e,t,n){this.store=e,this.repositoriesApi=t,this.stashApi=n,this.discardAllChanges=i=>this.store.dispatch(new te(i,{name:"Discard",detail:ie("All changes"),do:o=>{let r=this.store.selectSnapshot(ye.openRepositoryIds);return this.stashApi.saveWorkingCopyState(i).pipe(le(()=>(o(),L(""))),re(s=>this.repositoriesApi.discardAllChanges(i).pipe(le(h=>Je.matches(h)?oe(()=>new rt(h)):oe(()=>h)),N(h=>{let a=h?.filter(c=>r.includes(c))??[];return this.store.dispatch([...a.map(c=>new F(c,[m.currentBranch,m.currentBranchCommitId,m.headCommitId])),new F(i,[m.unstagedChanges,m.submodules])]).pipe(D(()=>[a,s]))}))))},undo:([o,r])=>this.stashApi.restoreWorkingCopyState(i,r).pipe(N(()=>this.store.dispatch([...o.map(s=>new F(s,[m.currentBranch,m.currentBranchCommitId,m.headCommitId])),new F(i,[m.unstagedChanges,m.submodules])])))})),this.discardFiles=(i,o)=>this.store.dispatch(new te(i,{name:"Discard",detail:o.map(r=>r.newFilePath??r.oldFilePath).join(", "),do:r=>{let s=this.store.selectSnapshot(ye.openRepositoryIds);return this.stashApi.saveWorkingCopyState(i,o.map(h=>h.newFilePath??h.oldFilePath).filter($t)).pipe(le(()=>(r(),L(""))),re(h=>this.repositoriesApi.discardFiles(i,o).pipe(le(a=>Je.matches(a)?oe(()=>new rt(a)):oe(()=>a)),N(a=>{let c=a?.filter(d=>s.includes(d))??[];return this.store.dispatch([...c.map(d=>new F(d,[m.currentBranch,m.currentBranchCommitId,m.headCommitId])),new F(i,[m.unstagedChanges,m.submodules])]).pipe(D(()=>[c,h]))}))))},undo:([r,s])=>this.stashApi.restoreWorkingCopyState(i,s).pipe(N(()=>this.store.dispatch([...r.map(h=>new F(h,[m.currentBranch,m.currentBranchCommitId,m.headCommitId])),new F(i,[m.unstagedChanges,m.submodules])])))})),this.discardFileLines=(i,o,r,s)=>this.store.dispatch(new te(i,{name:"Discard lines",detail:ie("In _name_",{name:r??o}),do:()=>this.repositoriesApi.discardFileLines(i,o,r,s).pipe(N(()=>this.store.dispatch(new F(i,[m.unstagedChanges,m.submodules]))))})),this.stageAllChanges=i=>this.store.dispatch(new te(i,{name:"Stage",detail:ie("All changes"),do:()=>this.repositoriesApi.getUnstagedChanges(i).pipe(re(o=>this.repositoriesApi.stageAllChanges(i).pipe(N(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))),N(()=>L(o))))),undo:o=>this.repositoriesApi.unstageFiles(i,o).pipe(N(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))))})),this.stageFiles=(i,o)=>this.store.dispatch(new te(i,{name:"Stage",detail:o.map(r=>r.newFilePath??r.oldFilePath).join(", "),do:()=>this.repositoriesApi.stageFiles(i,o).pipe(N(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules])))),undo:()=>this.repositoriesApi.unstageFiles(i,o).pipe(N(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))))})),this.stageFileLines=(i,o,r,s)=>this.store.dispatch(new te(i,{name:"Stage lines",detail:ie("In _name_",{name:r??o}),do:()=>this.repositoriesApi.stageFileLines(i,o,r,s).pipe(N(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))))})),this.unstageAllChanges=i=>this.store.dispatch(new te(i,{name:"Unstage",detail:ie("All changes"),do:()=>this.repositoriesApi.getStagedChanges(i).pipe(re(o=>this.repositoriesApi.unstageAllChanges(i).pipe(N(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))),N(()=>L(o))))),undo:o=>this.repositoriesApi.stageFiles(i,o).pipe(N(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))))})),this.unstageFiles=(i,o)=>this.store.dispatch(new te(i,{name:"Unstage",detail:o.map(r=>r.newFilePath??r.oldFilePath).join(", "),do:()=>this.repositoriesApi.unstageFiles(i,o).pipe(N(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules])))),undo:()=>this.repositoriesApi.stageFiles(i,o).pipe(N(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))))})),this.unstageFileLines=(i,o,r,s)=>this.store.dispatch(new te(i,{name:"Unstage lines",detail:ie("In _name_",{name:r??o}),do:()=>this.repositoriesApi.unstageFileLines(i,o,r,s).pipe(N(()=>this.store.dispatch(new F(i,[m.stagedChanges,m.unstagedChanges,m.submodules]))))}))}static{this.\u0275fac=function(t){return new(t||l)(Ee(Ae),Ee(At),Ee(jt))}}static{this.\u0275prov=Te({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();var un=["contextMenu"];function gn(l,u){if(l&1&&(B(0,"app-condensed-path",15),_(1,"async")),l&2){let e=x(2);g("path",P(1,1,e.filePath))}}function fn(l,u){if(l&1){let e=q();f(0,"button",16),_(1,"translate"),z("click",function(){W(e);let n=x(2);return Q(n.modifyLinesStage("stage"))}),B(2,"mat-icon",17),M()}l&2&&g("matTooltip",P(1,1,"Stage selected lines"))}function mn(l,u){if(l&1){let e=q();f(0,"button",18),_(1,"translate"),z("click",function(){W(e);let n=x(2);return Q(n.modifyLinesStage("discard"))}),B(2,"mat-icon",19),M()}l&2&&g("matTooltip",P(1,1,"Discard selected lines"))}function _n(l,u){if(l&1){let e=q();f(0,"button",20),_(1,"translate"),z("click",function(){W(e);let n=x(2);return Q(n.modifyLinesStage("unstage"))}),B(2,"mat-icon",21),M()}l&2&&g("matTooltip",P(1,1,"Unstage selected lines"))}function Cn(l,u){if(l&1){let e=q();f(0,"button",22),z("click",function(){W(e);let n=x(2);return Q(n.edited.next())}),f(1,"mat-icon"),y(2,"edit"),M()()}}function Mn(l,u){if(l&1){let e=q();f(0,"button",23),z("click",function(){W(e);let n=x(2);return Q(n.closed.next())}),f(1,"mat-icon"),y(2,"close"),M()()}}function Pn(l,u){l&1&&(f(0,"main"),y(1),_(2,"translate"),M()),l&2&&(p(),I(P(2,1,"Loading...")))}function wn(l,u){l&1&&(f(0,"main"),y(1),_(2,"translate"),M()),l&2&&(p(),I(P(2,1,"Cannot load binary file.")))}function xn(l,u){l&1&&(f(0,"main"),y(1),_(2,"translate"),M()),l&2&&(p(),I(P(2,1,"Cannot load file.")))}function On(l,u){if(l&1&&B(0,"app-hunk-view",25),l&2){let e=x(3);g("diffLines",e.diffLines)}}function Sn(l,u){if(l&1&&B(0,"app-inline-view",25),l&2){let e=x(3);g("diffLines",e.diffLines)}}function vn(l,u){if(l&1&&B(0,"app-split-view",25),l&2){let e=x(3);g("diffLines",e.diffLines)}}function bn(l,u){if(l&1&&(f(0,"main"),b(1,On,1,1,"app-hunk-view",24)(2,Sn,1,1,"app-inline-view",24)(3,vn,1,1,"app-split-view",24),M()),l&2){let e=x().ngIf;p(),g("ngIf",e==="hunk"),p(),g("ngIf",e==="inline"),p(),g("ngIf",e==="split")}}function yn(l,u){if(l&1){let e=q();De(0),f(1,"header")(2,"app-find-control",2),_(3,"async"),z("focusin",function(){W(e);let n=x();return Q(n.findControlHasFocus$.next(!0))})("focusout",function(){W(e);let n=x();return Q(n.findControlHasFocus$.next(!1))}),M(),b(4,gn,2,3,"app-condensed-path",3),_(5,"async"),_(6,"async"),f(7,"div",4),b(8,fn,3,3,"button",5),_(9,"async"),b(10,mn,3,3,"button",6),_(11,"async"),b(12,_n,3,3,"button",7),_(13,"async"),f(14,"mat-button-toggle-group",8),z("change",function(n){W(e);let i=x();return Q(i.changeView(n.value))}),f(15,"mat-button-toggle",9),_(16,"translate"),f(17,"mat-icon"),y(18,"calendar_view_day"),M()(),f(19,"mat-button-toggle",10),_(20,"translate"),f(21,"mat-icon"),y(22,"view_headline"),M()(),f(23,"mat-button-toggle",11),_(24,"translate"),f(25,"mat-icon"),y(26,"vertical_split"),M()()(),f(27,"div",12),b(28,Cn,3,0,"button",13)(29,Mn,3,0,"button",14),M()()(),b(30,Pn,3,3,"main",1),_(31,"async"),b(32,wn,3,3,"main",1),_(33,"async"),b(34,xn,3,3,"main",1),_(35,"async"),b(36,bn,4,3,"main",1),_(37,"async"),Be()}if(l&2){let e=u.ngIf,t=x();p(2),g("@showFindControl",P(3,16,t.showFindControl))("initial",t.search),p(2),g("ngIf",!(P(5,18,t.showStage)||P(6,20,t.showUnstage))),p(4),g("ngIf",P(9,22,t.showStage)),p(2),g("ngIf",P(11,24,t.showStage)),p(2),g("ngIf",P(13,26,t.showUnstage)),p(2),g("value",e),p(),g("matTooltip",P(16,28,"Hunk View")),p(4),g("matTooltip",P(20,30,"Inline View")),p(4),g("matTooltip",P(24,32,"Split View")),p(5),g("ngIf",t.showEdit),p(),g("ngIf",!t.hideClose),p(),g("ngIf",P(31,34,t.currentView)==="loading"),p(2),g("ngIf",P(33,36,t.currentView)==="binary-file"),p(2),g("ngIf",P(35,38,t.currentView)==="error"),p(2),g("ngIf",P(37,40,t.currentView)==="normal")}}function Ln(l,u){if(l&1){let e=q();f(0,"button",28),_(1,"translate"),z("click",function(){W(e);let n=x(2);return n.modifyLinesStage("stage"),Q(n.closeContextMenu())}),B(2,"mat-icon",17),f(3,"span"),y(4),_(5,"translate"),M()()}l&2&&(g("matTooltip",P(1,2,"Stage selected lines")),p(4),I(P(5,4,"Stage")))}function kn(l,u){if(l&1){let e=q();f(0,"button",28),_(1,"translate"),z("click",function(){W(e);let n=x(2);return n.modifyLinesStage("discard"),Q(n.closeContextMenu())}),B(2,"mat-icon",17),f(3,"span"),y(4),_(5,"translate"),M()()}l&2&&(g("matTooltip",P(1,2,"Discard selected lines")),p(4),I(P(5,4,"Discard")))}function In(l,u){if(l&1){let e=q();f(0,"button",28),_(1,"translate"),z("click",function(){W(e);let n=x(2);return n.modifyLinesStage("unstage"),Q(n.closeContextMenu())}),B(2,"mat-icon",17),f(3,"span"),y(4),_(5,"translate"),M()()}l&2&&(g("matTooltip",P(1,2,"Unstage selected lines")),p(4),I(P(5,4,"Unstage")))}function Fn(l,u){if(l&1&&(f(0,"div",26),b(1,Ln,6,6,"button",27),_(2,"async"),b(3,kn,6,6,"button",27),_(4,"async"),b(5,In,6,6,"button",27),_(6,"async"),M()),l&2){let e=x();p(),g("ngIf",P(2,3,e.showStage)),p(2),g("ngIf",P(4,5,e.showStage)),p(2),g("ngIf",P(6,7,e.showUnstage))}}var en=(()=>{class l extends pe(he){constructor(e,t,n,i,o,r,s,h){super(),this.viewContainerRef=e,this.breakpointObserver=t,this.overlay=n,this.store=i,this.highlightApi=o,this.findSelectionService=r,this.diffSelectionService=s,this.stagingActionsService=h,this.hideClose=!1,this.showEdit=!1,this.search=null,this.closed=new ze,this.edited=new ze,this.currentView=new X("loading"),this.diffLines=new X(null),this.findControlHasFocus$=new X(!1),this.showFindControl=Y([this.findSelectionService.searchRegex,this.findControlHasFocus$,this.breakpointObserver.observe([Re.XSmall,Re.Small,Re.Medium])]).pipe(D(([a,c,d])=>!!a||c||!d.matches)),this.searchMatchesCount=new X(0),this.matchClicked=new ut,this.overlayRef=null,this.closeContextMenu=()=>{this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null)}}ngOnInit(){this.showStage=Y([this.patch,this.selectedCommitId,this.diffSelectionService.selectedFileLines]).pipe(D(([e,t,n])=>t==="head"&&e?.isUnstaged===!0&&!e.patch.newFileIsSubmodule&&!e.patch.oldFileIsSubmodule&&n.length>0)),this.showUnstage=Y([this.patch,this.selectedCommitId,this.diffSelectionService.selectedFileLines]).pipe(D(([e,t,n])=>t==="head"&&e?.isUnstaged===!1&&!e.patch.newFileIsSubmodule&&!e.patch.oldFileIsSubmodule&&n.length>0)),this.diffSelectionService.contextMenuOpened.pipe(S(this.destroyed$)).subscribe(e=>{this.closeContextMenu(),Y([this.showStage,this.showUnstage]).pipe(Fe(1),S(this.destroyed$)).subscribe(([t,n])=>{(t||n)&&(this.overlayRef=this.overlay.create({positionStrategy:this.overlay.position().flexibleConnectedTo({x:e.x,y:e.y}).withPositions([{originX:"end",originY:"bottom",overlayX:"start",overlayY:"top"}])}),this.overlayRef.attach(new Vt(this.menuTemplate,this.viewContainerRef)),gt(this.diffSelectionService.selectedRange.pipe(Ve(1)),Xt(this.overlayRef)).pipe(Fe(1),S(this.destroyed$)).subscribe(()=>this.closeContextMenu()))})}),this.filePath=this.patch.pipe(D(e=>e?.patch.newFilePath??e?.patch.oldFilePath??"")),this.patch.pipe(ft((e,t)=>!e||!t?!e&&!t:!(e.repositoryPath!==t.repositoryPath||e.isUnstaged!==t.isUnstaged||e.patch.newFileId!==t.patch.newFileId||e.patch.newFileIsDir!==t.patch.newFileIsDir||e.patch.newFileIsSubmodule!==t.patch.newFileIsSubmodule||e.patch.newFilePath!==t.patch.newFilePath||e.patch.oldFileId!==t.patch.oldFileId||e.patch.oldFileIsDir!==t.patch.oldFileIsDir||e.patch.oldFileIsSubmodule!==t.patch.oldFileIsSubmodule||e.patch.oldFilePath!==t.patch.oldFilePath||e.patch.status!==t.patch.status||e.patch.hunks.length!==t.patch.hunks.length||de(e.patch.hunks,t.patch.hunks).some(([n,i])=>n?.lines.length!==i?.lines.length||n?.newStart!==i?.newStart||n?.oldStart!==i?.oldStart||n?.header!==i?.header||n&&i&&de(n.lines,i.lines).some(([o,r])=>o?.content.length!==r?.content.length||o?.newLineNo!==r?.newLineNo||o?.oldLineNo!==r?.oldLineNo||o?.origin!==r?.origin||o?.content!==r?.content)))),we(()=>{this.currentView.next("loading")}),re(e=>e?Ie(this.getLines(e,!1)).pipe(S(this.currentView.pipe(Ve(1),Me(t=>t==="loading"))),S(this.destroyed$),D(([t,n])=>[e,t,n]),le(t=>Ye.matches(t)?(this.currentView.next("binary-file"),L(null)):Ze.matches(t)?(this.currentView.next("error"),L(null)):oe(()=>t))):L(null)),we(e=>{if(e){let[t,n,i]=e;this.diffLines.next({hunks:t.patch.hunks,oldLines:n,newLines:i,oldFilePath:t.patch.oldFilePath,newFilePath:t.patch.newFilePath,highlighted:!1}),this.currentView.next("normal")}else this.diffLines.next(null)}),re(e=>e?.[0]?Ie(this.getLines(e?.[0],!0)).pipe(S(this.currentView.pipe(Ve(1),Me(t=>t==="loading"))),S(this.destroyed$),D(([t,n])=>[e?.[0],t,n]),le(t=>Ye.matches(t)?(this.currentView.next("binary-file"),L(null)):Ze.matches(t)?(this.currentView.next("error"),L(null)):oe(()=>t))):L(null)),S(this.destroyed$)).subscribe(e=>{if(e){let[t,n,i]=e;this.diffLines.next({hunks:t.patch.hunks,oldLines:n,newLines:i,oldFilePath:t.patch.oldFilePath,newFilePath:t.patch.newFilePath,highlighted:!0}),this.currentView.next("normal")}else this.diffLines.next(null)})}changeView(e){this.store.dispatch(new Ht(e))}modifyLinesStage(e){let t=this.store.selectSnapshot(ye.selectedRepositoryPath);if(!t)throw new bt;this.patch.pipe(Fe(1)).subscribe(n=>{if(!n||!n.patch.oldFilePath)return;let i=[t,n.patch.oldFileId?n.patch.oldFilePath:null,n.patch.newFileId?n.patch.newFilePath:null,this.diffSelectionService.selectedFileLines.value];switch(e){case"discard":this.stagingActionsService.discardFileLines(...i).subscribe();break;case"stage":this.stagingActionsService.stageFileLines(...i).subscribe();break;default:this.stagingActionsService.unstageFileLines(...i).subscribe();break}})}getLines(e,t){if(e.patch.oldFileIsSubmodule||e.patch.newFileIsSubmodule){if(e.patch.hunks.length<=0)return[L([]),L([])];let n=e.patch.hunks[0]?.lines.find(o=>o.oldLineNo>0),i=e.patch.hunks[0]?.lines.find(o=>o.newLineNo>0);return[L([{lineNumber:1,text:n?.content??"",tokens:[{startIndex:0,endIndex:n?.content.length??0,scopes:["normal"]}]}]),L([{lineNumber:1,text:i?.content??"",tokens:[{startIndex:0,endIndex:i?.content.length??0,scopes:["normal"]}]}])]}return[e.patch.oldFileId?this.highlightApi.getHighlightedFile(e.repositoryPath,e.patch.oldFileId,e.patch.oldFilePath,t):L([]),e.isUnstaged?this.highlightApi.getHighlightedFile(e.repositoryPath,null,e.patch.newFilePath,t):e.patch.newFileId?this.highlightApi.getHighlightedFile(e.repositoryPath,e.patch.newFileId,e.patch.newFilePath,t):L([])]}static{this.\u0275fac=function(t){return new(t||l)(k(Pt),k(Lt),k(Tt),k(Ae),k(Rt),k(ue),k(ge),k(Kt))}}static{this.\u0275cmp=se({type:l,selectors:[["app-diff-view"]],viewQuery:function(t,n){if(t&1&&$(un,5),t&2){let i;R(i=A())&&(n.menuTemplate=i.first)}},inputs:{patch:"patch",hideClose:"hideClose",showEdit:"showEdit",search:"search"},outputs:{closed:"closed",edited:"edited"},standalone:!1,features:[ae],decls:4,vars:3,consts:[["contextMenu",""],[4,"ngIf"],[3,"focusin","focusout","initial"],[3,"path",4,"ngIf"],[1,"right"],["type","button","class","stage-button","mat-stroked-button","",3,"matTooltip","click",4,"ngIf"],["type","button","class","discard-button","mat-stroked-button","","color","warn",3,"matTooltip","click",4,"ngIf"],["type","button","class","unstage-button","mat-stroked-button","",3,"matTooltip","click",4,"ngIf"],[3,"change","value"],["value","hunk",3,"matTooltip"],["value","inline",3,"matTooltip"],["value","split",3,"matTooltip"],[1,"close-container"],["type","button","mat-icon-button","","class","edit-button app-icon-button-md",3,"click",4,"ngIf"],["type","button","mat-icon-button","","class","close-button app-icon-button-md",3,"click",4,"ngIf"],[3,"path"],["type","button","mat-stroked-button","",1,"stage-button",3,"click","matTooltip"],["svgIcon","tray-plus"],["type","button","mat-stroked-button","","color","warn",1,"discard-button",3,"click","matTooltip"],["svgIcon","tray-remove"],["type","button","mat-stroked-button","",1,"unstage-button",3,"click","matTooltip"],["svgIcon","tray-minus"],["type","button","mat-icon-button","",1,"edit-button","app-icon-button-md",3,"click"],["type","button","mat-icon-button","",1,"close-button","app-icon-button-md",3,"click"],[3,"diffLines",4,"ngIf"],[3,"diffLines"],[1,"menu-panel"],["type","button","class","menu-item",3,"matTooltip","click",4,"ngIf"],["type","button",1,"menu-item",3,"click","matTooltip"]],template:function(t,n){t&1&&(b(0,yn,38,42,"ng-container",1),_(1,"async"),b(2,Fn,7,9,"ng-template",null,0,vt)),t&2&&g("ngIf",P(1,1,n.view))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%;position:absolute}header[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:baseline;justify-content:space-between;margin-bottom:5px;outline:none;overflow-x:auto;overflow-y:hidden}header[_ngcontent-%COMP%]::-webkit-scrollbar{height:4px}header[_ngcontent-%COMP%]   app-find-control[_ngcontent-%COMP%]{min-width:340px;max-width:350px;overflow:hidden}header[_ngcontent-%COMP%]   app-condensed-path[_ngcontent-%COMP%]{min-width:150px}header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{display:flex;gap:5px;margin-left:auto}header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .stage-button[_ngcontent-%COMP%], header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .discard-button[_ngcontent-%COMP%], header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .unstage-button[_ngcontent-%COMP%]{height:40px}header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]{height:40px}header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{font-size:0}header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   mat-button-toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]     .mat-button-toggle-label-content{line-height:38px;padding:0 6px}header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .close-container[_ngcontent-%COMP%]{display:flex;align-items:center;align-self:baseline;overflow:hidden;height:40px}main[_ngcontent-%COMP%]{flex:1 0 auto;outline:none;overflow-x:auto;overflow-y:auto}.dark-theme   [_nghost-%COMP%]{background:#1e1e1e}.light-theme   [_nghost-%COMP%]{background:#fafafa}"],data:{animation:[Dt("showFindControl",[tt("true",_e({opacity:1})),tt("false",_e({opacity:0,position:"absolute",height:0})),nt("false -> true",[_e({opacity:0,position:"relative",height:"*"}),et("225ms ease-in-out",_e({opacity:1}))]),nt("true -> false",[_e({opacity:1}),et("225ms ease-in-out",_e({opacity:0}))])])]},changeDetection:0})}}return We([it(ye.selectedCommitId)],l.prototype,"selectedCommitId",void 0),We([it(Wt.diffView)],l.prototype,"view",void 0),l})();var J=an(cn());var Le=(()=>{class l{constructor(){this.calculateInlineLines=(e,t,n)=>{let i=[],o=0,r=0,s=[],h=(a,c)=>{(a>o||c>r)&&(i.push(...de(e.slice(o,a),t.slice(r,c)).map(([d,C])=>({oldLine:d??null,newLine:C??null,status:"unchanged"}))),o=a,r=c)};for(let a of n){h(a.oldStart-1,a.newStart-1),[s,o,r]=this.calculateGroups(e,t,o,r,a);for(let c of s)c.type==="modified"?i.push(...c.lines.flatMap(d=>d.status==="replaced"?[U(V({},d),{status:"removed",newLine:null}),U(V({},d),{status:"added",oldLine:null})]:[d]).sort((d,C)=>d.status==="removed"&&C.status==="removed"?0:d.status==="removed"?-1:C.status==="removed"?1:0)):i.push(...c.lines)}return h(e.length,t.length),L(i)},this.calculateHunkLines=(e,t,n)=>{let i=[],o=0,r=0,s=[],h=(a,c,d)=>{(a>o||c>r)&&(i.push({isSeparator:!0,separatorHeader:d,hiddenDiffLines:de(e.slice(o,a),t.slice(r,c)).map(([C,v])=>({oldLine:C??null,newLine:v??null,status:"unchanged"}))}),o=a,r=c)};for(let a of n){h(a.oldStart-1,a.newStart-1,a.header),[s,o,r]=this.calculateGroups(e,t,o,r,a);for(let c of s)c.type==="modified"?i.push(...c.lines.flatMap(d=>d.status==="replaced"?[{isSeparator:!1,diffLine:U(V({},d),{status:"removed",newLine:null})},{isSeparator:!1,diffLine:U(V({},d),{status:"added",oldLine:null})}]:[{isSeparator:!1,diffLine:d}]).sort((d,C)=>d.diffLine.status==="removed"&&C.diffLine.status==="removed"?0:d.diffLine.status==="removed"?-1:C.diffLine.status==="removed"?1:0)):i.push(...c.lines.map(d=>({isSeparator:!1,diffLine:d})))}return h(e.length,t.length,null),L(i)},this.calculateSplitLines=(e,t,n)=>{let i=[],o=0,r=0,s=[],h=(a,c)=>{(a>o||c>r)&&(i.push(...de(e.slice(o,a),t.slice(r,c)).map(([d,C])=>({oldLine:d??null,newLine:C??null,status:"unchanged"}))),o=a,r=c)};for(let a of n){h(a.oldStart-1,a.newStart-1),[s,o,r]=this.calculateGroups(e,t,o,r,a);for(let c of s)i.push(...c.lines)}return h(e.length,t.length),L(i)},this.calculateMergeLines=(e,t,n,i,o)=>{let r=[],s=this.calculateSplitLines(e,t,i),h=this.calculateSplitLines(e,n,o);return Ie([s,h]).pipe(D(([a,c])=>{let d=1,C=0,v=0;for(;C<a.length&&v<c.length;){let w=a[C],T=c[v];if(!w.oldLine&&!T.oldLine)r.push({baseLine:null,yoursLine:w.newLine,yoursStatus:w.status,theirsLine:T.newLine,theirsStatus:T.status}),C++,v++;else if(!w.oldLine&&T.oldLine)r.push({baseLine:null,yoursLine:w.newLine,yoursStatus:w.status,theirsLine:null,theirsStatus:null}),C++;else if(w.oldLine&&!T.oldLine)r.push({baseLine:null,yoursLine:null,yoursStatus:null,theirsLine:T.newLine,theirsStatus:T.status}),v++;else if(w.oldLine&&T.oldLine){if(d!==w.oldLine.lineNumber||d!==T.oldLine.lineNumber)throw new yt(w.oldLine.lineNumber,T.oldLine.lineNumber);r.push({baseLine:T.oldLine,yoursLine:w.newLine,yoursStatus:w.status,theirsLine:T.newLine,theirsStatus:T.status}),d++,C++,v++}}for(;C<a.length;){let w=a[C];r.push({baseLine:w.oldLine,yoursLine:w.newLine,yoursStatus:w.status,theirsLine:null,theirsStatus:null}),C++}for(;v<c.length;){let w=c[v];r.push({baseLine:w.oldLine,yoursLine:null,yoursStatus:null,theirsLine:w.newLine,theirsStatus:w.status}),v++}return r}))},this.calculateGroups=(e,t,n,i,o)=>{let r=o.lines.filter(d=>d.origin!==">"&&d.origin!=="<"),s=[],h=n,a=i,c=0;for(;c<r.length;)if(r[c]?.newLineNo===-1){let d=[];for(;c<r.length&&r[c]?.newLineNo===-1;){let C=e[h];C&&d.push(C),h++,c++}if(c<r.length&&r[c]?.oldLineNo===-1){let C=[];for(;c<r.length&&r[c]?.oldLineNo===-1;){let v=t[a];v&&C.push(v),a++,c++}s.push(this.createModifiedGroup(d,C))}else s.push({type:"removed",lines:d.map(C=>({oldLine:C,newLine:null,status:"removed"}))})}else if(r[c]?.oldLineNo===-1){let d=[];for(;c<r.length&&r[c]?.oldLineNo===-1;){let C=t[a];C&&d.push(C),a++,c++}if(c<r.length&&r[c]?.newLineNo===-1){let C=[];for(;c<r.length&&r[c]?.newLineNo===-1;){let v=e[h];v&&C.push(v),h++,c++}s.push(this.createModifiedGroup(C,d))}else s.push({type:"added",lines:d.map(C=>({oldLine:null,newLine:C,status:"added"}))})}else{let d=[],C=[];for(;c<r.length&&r[c]?.oldLineNo!==-1&&r[c]?.newLineNo!==-1;){let v=e[h];v&&d.push(v);let w=t[a];w&&C.push(w),h++,a++,c++}s.push({type:"unchanged",lines:de(d,C).map(([v,w])=>({oldLine:v??null,newLine:w??null,status:"unchanged"}))})}return[s,h,a]},this.createModifiedGroup=(e,t)=>{let n=e.map(H=>H.text.replace(`
`,"")).join(`
`),i=t.map(H=>H.text.replace(`
`,"")).join(`
`),o=new J.diff_match_patch,r=o.diff_main(n,i);o.diff_cleanupSemantic(r);let s=[],h=0,a=0,c=null,d=null,C=[],v=[],w=[],T=H=>{H===J.DIFF_EQUAL?(s.push({status:c!==null&&d!==null?"replaced":c!==null?"removed":"added",oldLine:c!==null?U(V({},e[h]),{tokens:[...e[h]?.tokens??[],...C]}):null,newLine:d!==null?U(V({},t[a]),{tokens:[...t[a]?.tokens??[],...v]}):null}),h++,a++,c=null,d=null,C=[],v=[]):H===J.DIFF_INSERT?(c===null&&(s.push(...w),w=[]),(c===null?s:w).push({status:"added",oldLine:null,newLine:U(V({},t[a]),{tokens:[...t[a]?.tokens??[],...v]})}),a++,d=null,v=[]):H===J.DIFF_DELETE&&(d===null&&(s.push(...w),w=[]),(d===null?s:w).push({status:"removed",oldLine:U(V({},e[h]),{tokens:[...e[h]?.tokens??[],...C]}),newLine:null}),h++,c=null,C=[])};for(let[H,sn]of r){let O=sn.split(`
`);if(H===J.DIFF_EQUAL){if(O.length>1){s.push(...w),w=[],c!==null||d!==null?(c=(c??0)+(O[0]?.length??0),d=(d??0)+(O[0]?.length??0),T(H)):(s.push({status:"unchanged",oldLine:e[h],newLine:t[a]}),h++,a++);for(let E=1;E<O.length-1;E++)s.push({status:"unchanged",oldLine:e[h],newLine:t[a]}),h++,a++}c=(c??0)+(O[O.length-1]?.length??0),d=(d??0)+(O[O.length-1]?.length??0)}else if(H===J.DIFF_INSERT){if(O.length>1)if(d!==null){O[0]&&O[0].length>0&&v.push({startIndex:d??0,endIndex:(d??0)+O[0].length,scopes:["diff-added"]}),d=d+(O[0]?.length??0),T(H);for(let E=1;E<O.length-1;E++)(c===null?s:w).push({status:"added",oldLine:null,newLine:U(V({},t[a]),{tokens:[...t[a]?.tokens??[],{startIndex:0,endIndex:O[E]?.length??0,scopes:["diff-added"]}]})}),a++}else for(let E=0;E<O.length-1;E++)(c===null?s:w).push({status:"added",oldLine:null,newLine:U(V({},t[a]),{tokens:[...t[a]?.tokens??[],{startIndex:0,endIndex:O[E]?.length??0,scopes:["diff-added"]}]})}),a++;(O[O.length-1]?.length??0)>0&&v.push({startIndex:d??0,endIndex:(d??0)+(O[O.length-1]?.length??0),scopes:["diff-added"]}),d=(d??0)+(O[O.length-1]?.length??0)}else if(H===J.DIFF_DELETE){if(O.length>1)if(c!==null){(O[0]?.length??0)>0&&C.push({startIndex:c??0,endIndex:(c??0)+(O[0]?.length??0),scopes:["diff-removed"]}),c=c+(O[0]?.length??0),T(H);for(let E=1;E<O.length-1;E++)(d===null?s:w).push({status:"removed",oldLine:U(V({},e[h]),{tokens:[...e[h]?.tokens??[],{startIndex:0,endIndex:O[E]?.length??0,scopes:["diff-removed"]}]}),newLine:null}),h++}else for(let E=0;E<O.length-1;E++)(d===null?s:w).push({status:"removed",oldLine:U(V({},e[h]),{tokens:[...e[h]?.tokens??[],{startIndex:0,endIndex:O[E]?.length??0,scopes:["diff-removed"]}]}),newLine:null}),h++;(O[O.length-1]?.length??0)>0&&C.push({startIndex:c??0,endIndex:(c??0)+(O[O.length-1]?.length??0),scopes:["diff-removed"]}),c=(c??0)+(O[O.length-1]?.length??0)}}return s.push(...w),(c!==null||d!==null)&&(n.length===0&&(c=c??0),i.length===0&&(d=d??0),T(J.DIFF_EQUAL)),{type:"modified",lines:s}}}static{this.lineNumberCharacterWidth=8.3}static{this.lineNumberSpacing=10}calculateMargin(e,t=!1){return l.lineNumberSpacing+e*l.lineNumberCharacterWidth*(t?1:2)}getFileExtension(e){if(!e)return null;let t=e.lastIndexOf(".");return t>0?e.substring(t+1):null}static{this.\u0275fac=function(t){return new(t||l)}}static{this.\u0275prov=Te({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();var tn=1e4,ke=(()=>{class l{constructor(){this.renderScopes=e=>e.map(t=>this.renderScope(t)).join(" "),this.areEqual=(e,t)=>{if(e.length!==t.length)return!1;let n=new Set(e);for(let i of t)if(!n.has(i))return!1;return!0}}transform(e,t=""){if(!t)return[];if(t.length>tn)return[{class:"normal",text:t.slice(0,tn)+ie("... Max line length reached!")}];let n=Nt(e,s=>s.startIndex),i=[],o=0,r=n.filter(s=>s.startIndex<=o&&s.endIndex>o);for(;o<t.length;){let s=n.filter(a=>a.startIndex<=o&&a.endIndex>o),h=o;for(;this.areEqual(r,s)&&o<t.length;)o++,s=n.filter(a=>a.startIndex<=o&&a.endIndex>o);i.push({class:this.renderScopes(r.map(a=>a.scopes)),text:t.substring(h,o)||`
`}),r=s}return i}renderScope(e){let t=e[e.length-1];if(!t)return"";let n=t.split(".");return ne(1,n.length+1).map(i=>n.slice(0,i).join("-")).join(" ")}static{this.\u0275fac=function(t){return new(t||l)}}static{this.\u0275pipe=xt({name:"tokens",type:l,pure:!0,standalone:!1})}}return l})();var En=["scrollContainer"],Dn=["code"];function Bn(l,u){if(l&1&&B(0,"span",7),l&2){let e=u;j("left",e.left)("width",e.width)}}function Nn(l,u){if(l&1){let e=q();f(0,"button",8),z("click",function(){W(e);let n=x().$implicit,i=x();return Q(i.expandSeparator(n))}),f(1,"mat-icon",9),y(2),M()(),f(3,"span",10),y(4),M()}if(l&2){let e=x(),t=e.$implicit,n=e.first,i=e.last,o=x();j("width",o.lineNumberMargin+26,"px"),p(2),I(n?"expand_less":i?"expand_more":"unfold_more"),p(2),I(t.separatorHeader)}}function $n(l,u){if(l&1&&(f(0,"span",13),y(1),M()),l&2){let e=u.$implicit;g("ngClass",e.class),p(),I(e.text)}}function Rn(l,u){if(l&1&&(b(0,$n,2,2,"span",14),_(1,"findToken"),_(2,"tokens")),l&2){let e=u,t=x(2).index;g("ngForOf",fe(2,5,me(1,1,e.tokens,e.text,t),e.text))}}function An(l,u){if(l&1&&(f(0,"span",11),y(1),M(),f(2,"span",12),y(3),M(),Z(4,Rn,3,8,"span",13)),l&2){let e,t=x().$implicit,n=x();j("right","calc(100% + 26px + "+(n.lineNumberMargin/2).toString()+"px)")("width",n.lineNumberMargin/2-5,"px"),p(),I(t.diffLine.oldLine==null?null:t.diffLine.oldLine.lineNumber),p(),j("width",n.lineNumberMargin/2-5,"px"),p(),I(t.diffLine.newLine==null?null:t.diffLine.newLine.lineNumber),p(),K((e=n.getLineView(t.diffLine))?4:-1,e)}}function jn(l,u){if(l&1&&(f(0,"li",5),Z(1,Bn,1,4,"span",6),_(2,"async"),Z(3,Nn,5,4)(4,An,5,9),M()),l&2){let e,t=u.$implicit,n=u.index,i=x();g("ngClass","line-"+(t.isSeparator?"separator":t.diffLine.status)),p(),K((e=P(2,3,i.getSelection(n)))?1:-1,e),p(2),K(t.isSeparator?3:4)}}var on=(()=>{class l extends pe(he,ve){constructor(e,t,n){super(),this.diffService=e,this.diffSelectionService=t,this.findSelectionService=n,this.lineNumberMargin=0,this.lines$=new X([]),this.currentPatch=null,this.getSelection=i=>this.diffSelectionService.selectedRange.pipe(D(o=>{if(!o)return null;let[r,s]=o[0].line>o[1].line||o[0].line===o[1].line&&o[0].char>o[1].char?[o[1],o[0]]:o;return i<r.line||i>s.line?null:i===r.line?{left:`${r.char*this.diffSelectionService.charWidth}px`,width:r.line===s.line?`${(s.char-r.char)*this.diffSelectionService.charWidth}px`:"100%"}:i===s.line?{left:"0px",width:`${s.char*this.diffSelectionService.charWidth}px`}:{left:"0px",width:"100%"}}))}ngOnInit(){let e=this.scrollContainer.elementRef.nativeElement;this.diffLines.pipe(_t(null),mt(),Pe(0),S(this.destroyed$)).subscribe(([t,n])=>{let i=this.currentPatch?V({},this.currentPatch):null;if(n){this.currentPatch={newFilePath:n.newFilePath,oldFilePath:n.oldFilePath};let o=Bt([n.oldLines.length,n.newLines.length])??0;this.lineNumberMargin=this.diffService.calculateMargin(o.toString().length),this.diffService.calculateHunkLines(n.oldLines,n.newLines,n.hunks).pipe(S(this.destroyed$)).subscribe(r=>{t&&t.newFilePath===n.newFilePath&&t.oldFilePath===n.oldFilePath&&!t.highlighted&&n.highlighted?this.updateLines(r):this.lines$.next(r),(!i||i.oldFilePath!==this.currentPatch?.oldFilePath||i.newFilePath!==this.currentPatch?.newFilePath)&&this.scrollContainer.elementRef?.nativeElement?.scrollTo(0,0)})}else this.currentPatch=null,this.lineNumberMargin=0,this.lines$.next([]),i&&this.scrollContainer.elementRef?.nativeElement?.scrollTo(0,0)}),Y([this.lines$,this.findSelectionService.searchRegex]).pipe(S(this.destroyed$)).subscribe(([t,n])=>{if(!n){this.findSelectionService.setMatches([]);return}let i=t.map((o,r)=>[o.isSeparator?null:this.getLineView(o.diffLine),r]).flatMap(([o,r])=>o?Array.from(o.text.matchAll(n),s=>({lineId:r,startIndex:s.index??0,endIndex:(s.index??0)+(s[0]?.length??0)})):[]);this.findSelectionService.setMatches(i)}),this.findSelectionService.selectedMatch.pipe(S(this.destroyed$)).subscribe(t=>{if(!t||typeof t.lineId!="number")return;let n=this.lineNumberMargin+26+t.startIndex*this.diffSelectionService.charWidth,i=this.lineNumberMargin+26+t.endIndex*this.diffSelectionService.charWidth,o=e.scrollLeft,r=e.scrollLeft+e.clientWidth,s=n<o?n:n>r?i-e.clientWidth:e.scrollLeft;e.scrollTo(s,t.lineId*19)}),this.diffSelectionService.captureSelections(this.codeElement.nativeElement,(t,n)=>({line:Math.floor((e.scrollTop+n-e.getBoundingClientRect().top)/19),char:Math.max(0,Math.round((e.scrollLeft+t-e.getBoundingClientRect().left-(this.lineNumberMargin+26))/this.diffSelectionService.charWidth))}),(t,n)=>this.lines$.value.filter((i,o)=>o>=t&&o<=n).map(i=>i.isSeparator?i.separatorHeader??void 0:this.getLineView(i.diffLine)?.text),()=>{let t=this.lines$.value,n=t[t.length-1];return{line:t.length-1,char:n?(n.isSeparator?n.separatorHeader:this.getLineView(n.diffLine)?.text)?.length??0:0}},([t,n])=>ne(t.line,n.line+1).flatMap(i=>{let o=this.lines$.value[i];return!o||o.isSeparator?[]:[{oldLineNo:o.diffLine.oldLine?.lineNumber??-1,newLineNo:o.diffLine.newLine?.lineNumber??-1}]})).pipe(S(this.destroyed$)).subscribe()}expandSeparator(e){let n=this.lines$.value;this.lines$.next(n.flatMap((i,o)=>{if(i!==e)return i;if(e.hiddenDiffLines.length<=25)return e.hiddenDiffLines.map(a=>({isSeparator:!1,diffLine:a}));if(o===0)return[{isSeparator:!0,separatorHeader:e.separatorHeader,hiddenDiffLines:ot(e.hiddenDiffLines,20)},...lt(e.hiddenDiffLines,20).map(a=>({isSeparator:!1,diffLine:a}))];if(o===n.length-1)return[...e.hiddenDiffLines.slice(0,20).map(a=>({isSeparator:!1,diffLine:a})),{isSeparator:!0,separatorHeader:null,hiddenDiffLines:e.hiddenDiffLines.slice(20)}];let r=e.hiddenDiffLines.slice(0,10),s=ot(e.hiddenDiffLines.slice(10),10),h=lt(e.hiddenDiffLines,10);return[...r.map(a=>({isSeparator:!1,diffLine:a})),{isSeparator:!0,separatorHeader:e.separatorHeader,hiddenDiffLines:s},...h.map(a=>({isSeparator:!1,diffLine:a}))]}))}getLineView(e){return e.status==="added"?e.newLine:e.status==="removed"?e.oldLine:e.status==="unchanged"?e.newLine??e.oldLine:null}trackByHunkLine(e,t){return t.isSeparator?t.separatorHeader:`${t.diffLine.oldLine?.text}:::${t.diffLine.newLine?.text}`}updateLines(e){let t=this.lines$.value,n=0,i=0,o=[];for(;i<e.length;){let r=t[n],s=e[i];if(!r||!s)throw new Ke;if(s.isSeparator){if(r.isSeparator){if(r.hiddenDiffLines.length===s.hiddenDiffLines.length){o.push(s),n++,i++;continue}o.push({isSeparator:!0,separatorHeader:s.separatorHeader,hiddenDiffLines:s.hiddenDiffLines.slice(0,r.hiddenDiffLines.length)}),s.hiddenDiffLines=s.hiddenDiffLines.slice(r.hiddenDiffLines.length),n++;continue}let h=s.hiddenDiffLines[0];if(!h){i++;continue}o.push({isSeparator:!1,diffLine:h}),s.hiddenDiffLines=s.hiddenDiffLines.slice(1),n++;continue}if(!r.isSeparator){o.push(s),n++,i++;continue}throw new Ke}this.lines$.next(o)}static{this.\u0275fac=function(t){return new(t||l)(k(Le),k(ge),k(ue))}}static{this.\u0275cmp=se({type:l,selectors:[["app-hunk-view"]],viewQuery:function(t,n){if(t&1&&($(En,7),$(Dn,7,ee),$(G,5)),t&2){let i;R(i=A())&&(n.scrollContainer=i.first),R(i=A())&&(n.codeElement=i.first),R(i=A())&&(n.viewports=i)}},inputs:{diffLines:"diffLines"},standalone:!1,features:[ae],decls:7,vars:9,consts:[["scrollContainer",""],["code",""],[1,"viewport",3,"itemSize","maxBufferPx","minBufferPx"],["tabindex","0",1,"vs-code-theme"],["class","line",3,"ngClass",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"line",3,"ngClass"],[1,"selection",3,"left","width"],[1,"selection"],["mat-button","",1,"separator-icon",3,"click"],["inline",""],[1,"separator-header"],[1,"old-line-number"],[1,"new-line-number"],[3,"ngClass"],[3,"ngClass",4,"ngFor","ngForOf"]],template:function(t,n){t&1&&(f(0,"cdk-virtual-scroll-viewport",2,0)(2,"code",3,1)(4,"ul"),b(5,jn,5,5,"li",4),_(6,"async"),M()()()),t&2&&(g("itemSize",19)("maxBufferPx",1e3)("minBufferPx",200),p(4),j("margin-left",n.lineNumberMargin+26,"px"),p(),g("cdkVirtualForOf",P(6,7,n.lines$))("cdkVirtualForTrackBy",n.trackByHunkLine))},dependencies:[Oe,Se,G,xe,Ne,je,He,ce,be,ke],styles:['code[_ngcontent-%COMP%]{display:block;white-space:pre;user-select:none;cursor:text;outline:none}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]{position:absolute;text-align:right;user-select:none}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{right:calc(100% + 26px)}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{position:absolute;display:block;height:19px;opacity:.5}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]{right:100%}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]{cursor:pointer;height:19px;line-height:19px;padding:0;text-align:center;min-width:0}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:0;height:100%;width:100%;z-index:-1}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{line-height:19px}.viewport[_ngcontent-%COMP%]{height:100%;width:100%}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-separator[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-separator[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]:before, .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]:before{background:#252525}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]{color:#858585}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{background-color:#53789b!important}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-separator[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-separator[_ngcontent-%COMP%], .light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]:before, .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]:before{background:#eee}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .separator-icon[_ngcontent-%COMP%]{color:#5e5e5e}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{background-color:#add6ff!important}'],changeDetection:0})}}return l})();var Hn=["scrollContainer"],Wn=["code"];function Qn(l,u){if(l&1&&B(0,"span",10),l&2){let e=u.ngIf;j("left",e.left)("width",e.width)}}function Un(l,u){if(l&1&&(f(0,"span",12),y(1),M()),l&2){let e=u.$implicit;g("ngClass",e.class),p(),I(e.text)}}function zn(l,u){if(l&1&&(De(0),b(1,Un,2,2,"span",11),_(2,"findToken"),_(3,"tokens"),Be()),l&2){let e=u.ngIf,t=x().index;p(),g("ngForOf",fe(3,5,me(2,1,e.tokens,e.text,t),e.text))}}function Xn(l,u){if(l&1&&(f(0,"li",5),b(1,Qn,1,4,"span",6),_(2,"async"),f(3,"span",7),y(4),M(),f(5,"span",8),y(6),M(),b(7,zn,4,8,"ng-container",9),M()),l&2){let e=u.$implicit,t=u.index,n=x();g("ngClass","line-"+e.status),p(),g("ngIf",P(2,11,n.getSelection(t))),p(2),j("right","calc(100% + 26px + "+(n.lineNumberMargin/2).toString()+"px)")("width",n.lineNumberMargin/2-5,"px"),p(),I(e.oldLine==null?null:e.oldLine.lineNumber),p(),j("width",n.lineNumberMargin/2-5,"px"),p(),I(e.newLine==null?null:e.newLine.lineNumber),p(),g("ngIf",n.getLineView(e))}}var ln=(()=>{class l extends pe(he,ve){constructor(e,t,n){super(),this.diffService=e,this.diffSelectionService=t,this.findSelectionService=n,this.lineNumberMargin=0,this.lines$=new X([]),this.currentPatch=null,this.getSelection=i=>this.diffSelectionService.selectedRange.pipe(D(o=>{if(!o)return null;let[r,s]=o[0].line>o[1].line||o[0].line===o[1].line&&o[0].char>o[1].char?[o[1],o[0]]:o;return i<r.line||i>s.line?null:i===r.line?{left:`${r.char*this.diffSelectionService.charWidth}px`,width:r.line===s.line?`${(s.char-r.char)*this.diffSelectionService.charWidth}px`:"100%"}:i===s.line?{left:"0px",width:`${s.char*this.diffSelectionService.charWidth}px`}:{left:"0px",width:"100%"}}))}ngOnInit(){let e=this.scrollContainer.nativeElement;this.diffLines.pipe(Pe(0),S(this.destroyed$)).subscribe(t=>{let n=this.currentPatch?V({},this.currentPatch):null;if(t){this.currentPatch={newFilePath:t.newFilePath,oldFilePath:t.oldFilePath};let i=Math.max(t.oldLines.length,t.newLines.length)??0;this.lineNumberMargin=this.diffService.calculateMargin(i.toString().length),this.diffService.calculateInlineLines(t.oldLines,t.newLines,t.hunks).pipe(S(this.destroyed$)).subscribe(o=>{this.lines$.next(o),(!n||n.oldFilePath!==this.currentPatch?.oldFilePath||n.newFilePath!==this.currentPatch?.newFilePath)&&this.scrollContainer.nativeElement?.scrollTo(0,0)})}else this.currentPatch=null,this.lineNumberMargin=0,this.lines$.next([]),n&&this.scrollContainer.nativeElement?.scrollTo(0,0)}),Y([this.lines$,this.findSelectionService.searchRegex]).pipe(S(this.destroyed$)).subscribe(([t,n])=>{if(!n){this.findSelectionService.setMatches([]);return}let i=t.map((o,r)=>[this.getLineView(o),r]).flatMap(([o,r])=>o?Array.from(o.text.matchAll(n),s=>({lineId:r,startIndex:s.index??0,endIndex:(s.index??0)+(s[0]?.length??0)})):[]);this.findSelectionService.setMatches(i)}),this.findSelectionService.selectedMatch.pipe(S(this.destroyed$)).subscribe(t=>{if(!t||typeof t.lineId!="number")return;let n=this.lineNumberMargin+26+t.startIndex*this.diffSelectionService.charWidth,i=this.lineNumberMargin+26+t.endIndex*this.diffSelectionService.charWidth,o=e.scrollLeft,r=e.scrollLeft+e.clientWidth,s=n<o?n:n>r?i-e.clientWidth:e.scrollLeft;e.scrollTo(s,t.lineId*19)}),this.diffSelectionService.captureSelections(this.codeElement.nativeElement,(t,n)=>({line:Math.floor((e.scrollTop+n-e.getBoundingClientRect().top)/19),char:Math.max(0,Math.round((e.scrollLeft+t-e.getBoundingClientRect().left-(this.lineNumberMargin+26))/this.diffSelectionService.charWidth))}),(t,n)=>this.lines$.value.filter((i,o)=>o>=t&&o<=n).map(i=>this.getLineView(i)?.text),()=>{let t=this.lines$.value[this.lines$.value.length-1];return{line:this.lines$.value.length-1,char:t?this.getLineView(t)?.text.length??0:0}},([t,n])=>ne(t.line,n.line+1).map(i=>({oldLineNo:this.lines$.value[i]?.oldLine?.lineNumber??-1,newLineNo:this.lines$.value[i]?.newLine?.lineNumber??-1}))).pipe(S(this.destroyed$)).subscribe()}getLineView(e){return e.status==="added"?e.newLine:e.status==="removed"?e.oldLine:e.status==="unchanged"?e.newLine??e.oldLine:null}trackByDiffLine(e,t){return e}static{this.\u0275fac=function(t){return new(t||l)(k(Le),k(ge),k(ue))}}static{this.\u0275cmp=se({type:l,selectors:[["app-inline-view"]],viewQuery:function(t,n){if(t&1&&($(Hn,7,ee),$(Wn,7,ee),$(G,5)),t&2){let i;R(i=A())&&(n.scrollContainer=i.first),R(i=A())&&(n.codeElement=i.first),R(i=A())&&(n.viewports=i)}},inputs:{diffLines:"diffLines"},standalone:!1,features:[ae],decls:7,vars:9,consts:[["scrollContainer",""],["code",""],[1,"viewport",3,"itemSize","maxBufferPx","minBufferPx"],["tabindex","0",1,"vs-code-theme"],["class","line",3,"ngClass",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"line",3,"ngClass"],["class","selection",3,"left","width",4,"ngIf"],[1,"old-line-number"],[1,"new-line-number"],[4,"ngIf"],[1,"selection"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(t,n){t&1&&(f(0,"cdk-virtual-scroll-viewport",2,0)(2,"code",3,1)(4,"ul"),b(5,Xn,8,13,"li",4),_(6,"async"),M()()()),t&2&&(g("itemSize",19)("maxBufferPx",1e3)("minBufferPx",200),p(4),j("margin-left",n.lineNumberMargin+26,"px"),p(),g("cdkVirtualForOf",P(6,7,n.lines$))("cdkVirtualForTrackBy",n.trackByDiffLine))},dependencies:[Oe,Se,G,xe,Ne,$e,ce,be,ke],styles:["code[_ngcontent-%COMP%]{display:block;white-space:pre;user-select:none;cursor:text;outline:none}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{position:absolute;text-align:right;user-select:none}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{right:calc(100% + 26px)}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{position:absolute;display:block;height:19px;opacity:.5}.viewport[_ngcontent-%COMP%]{height:100%;width:100%}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{color:#858585}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{background-color:#53789b!important}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .old-line-number[_ngcontent-%COMP%], .light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .new-line-number[_ngcontent-%COMP%]{color:#5e5e5e}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{background-color:#add6ff!important}"],changeDetection:0})}}return l})();var qn=["leftScrollContainer"],Gn=["rightScrollContainer"],Jn=["leftCode"],Yn=["rightCode"];function Zn(l,u){if(l&1&&B(0,"span",12),l&2){let e=u;j("left",e.left)("width",e.width)}}function Kn(l,u){if(l&1&&(f(0,"span",14),y(1),M()),l&2){let e=u.$implicit;g("ngClass",e.class),p(),I(e.text)}}function ei(l,u){if(l&1&&(qe(0,Kn,2,2,"span",14,Xe),_(2,"findToken"),_(3,"tokens")),l&2){let e=x(2),t=e.$implicit,n=e.index;Ge(fe(3,4,me(2,0,t.oldLine.tokens,t.oldLine.text,"l:"+n),t.oldLine.text))}}function ti(l,u){if(l&1&&(f(0,"span",13),y(1),M(),Z(2,ei,4,7)),l&2){let e=x().$implicit;p(),I(e.oldLine==null?null:e.oldLine.lineNumber),p(),K(e.oldLine?2:-1)}}function ni(l,u){if(l&1&&(f(0,"li",10),Z(1,Zn,1,4,"span",11),_(2,"async"),Z(3,ti,3,2),M()),l&2){let e,t=u.$implicit,n=u.index,i=x();g("ngClass","line-"+t.status),p(),K((e=P(2,3,i.getSelection(n,"left")))?1:-1,e),p(2),K(t.status!=="added"?3:-1)}}function ii(l,u){if(l&1&&B(0,"span",12),l&2){let e=u;j("left",e.left)("width",e.width)}}function oi(l,u){if(l&1&&(f(0,"span",14),y(1),M()),l&2){let e=u.$implicit;g("ngClass",e.class),p(),I(e.text)}}function li(l,u){if(l&1&&(qe(0,oi,2,2,"span",14,Xe),_(2,"findToken"),_(3,"tokens")),l&2){let e=x(2),t=e.$implicit,n=e.index;Ge(fe(3,4,me(2,0,t.newLine.tokens,t.newLine.text,"r:"+n),t.newLine.text))}}function ri(l,u){if(l&1&&(f(0,"span",13),y(1),M(),Z(2,li,4,7)),l&2){let e=x().$implicit;p(),I(e.newLine==null?null:e.newLine.lineNumber),p(),K(e.newLine?2:-1)}}function si(l,u){if(l&1&&(f(0,"li",10),Z(1,ii,1,4,"span",11),_(2,"async"),Z(3,ri,3,2),M()),l&2){let e,t=u.$implicit,n=u.index,i=x();g("ngClass","line-"+t.status),p(),K((e=P(2,3,i.getSelection(n,"right")))?1:-1,e),p(2),K(t.status!=="removed"?3:-1)}}var rn=(()=>{class l extends pe(he,ve){constructor(e,t,n,i){super(),this.zone=e,this.diffService=t,this.diffSelectionService=n,this.findSelectionService=i,this.leftLineNumberMargin=0,this.rightLineNumberMargin=0,this.lines$=new X([]),this.currentPatch=null,this.selectionSide=new X("right"),this.getSelection=(o,r)=>this.diffSelectionService.selectedRange.pipe(Ct(this.selectionSide),D(([s,h])=>{if(!s||h!==r)return null;let[a,c]=s[0].line>s[1].line||s[0].line===s[1].line&&s[0].char>s[1].char?[s[1],s[0]]:s;return o<a.line||o>c.line?null:o===a.line?{left:`${a.char*this.diffSelectionService.charWidth}px`,width:a.line===c.line?`${(c.char-a.char)*this.diffSelectionService.charWidth}px`:"100%"}:o===c.line?{left:"0px",width:`${c.char*this.diffSelectionService.charWidth}px`}:{left:"0px",width:"100%"}}))}ngOnInit(){let e=this.leftScrollContainer.nativeElement,t=this.rightScrollContainer.nativeElement;this.diffLines.pipe(Pe(0),S(this.destroyed$)).subscribe(n=>{let i=this.currentPatch?V({},this.currentPatch):null;n?(this.currentPatch={newFilePath:n.newFilePath,oldFilePath:n.oldFilePath},this.leftLineNumberMargin=this.diffService.calculateMargin(n.oldLines.length.toString().length,!0),this.rightLineNumberMargin=this.diffService.calculateMargin(n.newLines.length.toString().length,!0),this.diffService.calculateSplitLines(n.oldLines,n.newLines,n.hunks).pipe(S(this.destroyed$)).subscribe(o=>{this.lines$.next(o),(!i||i.oldFilePath!==this.currentPatch?.oldFilePath||i.newFilePath!==this.currentPatch?.newFilePath)&&(this.leftScrollContainer?.nativeElement?.scrollTo(0,0),this.rightScrollContainer?.nativeElement?.scrollTo(0,0))})):(this.currentPatch=null,this.leftLineNumberMargin=0,this.rightLineNumberMargin=0,this.lines$.next([]),i&&(this.leftScrollContainer?.nativeElement?.scrollTo(0,0),this.rightScrollContainer?.nativeElement?.scrollTo(0,0)))}),this.zone.runOutsideAngular(()=>{let n=!1,i=!1;Qe(this.leftScrollContainer.nativeElement,"scroll",{passive:!0}).pipe(Me(()=>!i),we(()=>{n=!0,this.rightScrollContainer.nativeElement.scrollTo(this.leftScrollContainer.nativeElement.scrollLeft,this.leftScrollContainer.nativeElement.scrollTop)}),Ue(100),S(this.destroyed$)).subscribe(()=>{n=!1}),Qe(this.rightScrollContainer.nativeElement,"scroll",{passive:!0}).pipe(Me(()=>!n),we(()=>{i=!0,this.leftScrollContainer.nativeElement.scrollTo(this.rightScrollContainer.nativeElement.scrollLeft,this.rightScrollContainer.nativeElement.scrollTop)}),Ue(100),S(this.destroyed$)).subscribe(()=>{i=!1})}),Y([this.lines$,this.findSelectionService.searchRegex]).pipe(S(this.destroyed$)).subscribe(([n,i])=>{if(!i){this.findSelectionService.setMatches([]);return}let o=n.map((a,c)=>[a,c]),r=o.filter(([a])=>a.status!=="added").map(([a,c])=>[a.oldLine,c]),s=o.filter(([a])=>a.status!=="removed").map(([a,c])=>[a.newLine,c]),h=[...r.flatMap(([a,c])=>a?Array.from(a.text.matchAll(i),d=>({lineId:`l:${c}`,startIndex:d.index??0,endIndex:(d.index??0)+(d[0]?.length??0)})):[]),...s.flatMap(([a,c])=>a?Array.from(a.text.matchAll(i),d=>({lineId:`r:${c}`,startIndex:d.index??0,endIndex:(d.index??0)+(d[0]?.length??0)})):[])];this.findSelectionService.setMatches(h)}),this.findSelectionService.selectedMatch.pipe(S(this.destroyed$)).subscribe(n=>{if(!n||typeof n.lineId!="string")return;let i=n.lineId.startsWith("l")?e:t,o=26+(n.lineId.startsWith("l")?this.leftLineNumberMargin:this.rightLineNumberMargin),r=o+n.startIndex*this.diffSelectionService.charWidth,s=o+n.endIndex*this.diffSelectionService.charWidth,h=i.scrollLeft,a=i.scrollLeft+i.clientWidth,c=r<h?r:r>a?s-i.clientWidth:i.scrollLeft;i.scrollTo(c,+n.lineId.slice(2)*19)}),this.diffSelectionService.captureSelections(this.leftCodeElement.nativeElement,(n,i)=>({line:Math.floor((e.scrollTop+i-e.getBoundingClientRect().top)/19),char:Math.max(0,Math.round((e.scrollLeft+n-e.getBoundingClientRect().left-(this.leftLineNumberMargin+26))/this.diffSelectionService.charWidth))}),(n,i)=>this.lines$.value.filter((o,r)=>r>=n&&r<=i).map(o=>o.oldLine?.text),()=>({line:this.lines$.value.length-1,char:this.lines$.value[this.lines$.value.length-1]?.oldLine?.text.length??0}),([n,i])=>ne(n.line,i.line+1).map(o=>({oldLineNo:this.lines$.value[o]?.oldLine?.lineNumber??-1,newLineNo:this.lines$.value[o]?.newLine?.lineNumber??-1}))).pipe(S(this.destroyed$)).subscribe(()=>{this.selectionSide.next("left")}),this.diffSelectionService.captureSelections(this.rightCodeElement.nativeElement,(n,i)=>({line:Math.floor((t.scrollTop+i-t.getBoundingClientRect().top)/19),char:Math.max(0,Math.round((t.scrollLeft+n-t.getBoundingClientRect().left-(this.rightLineNumberMargin+26))/this.diffSelectionService.charWidth))}),(n,i)=>this.lines$.value.filter((o,r)=>r>=n&&r<=i).map(o=>o.newLine?.text),()=>({line:this.lines$.value.length-1,char:this.lines$.value[this.lines$.value.length-1]?.newLine?.text.length??0}),([n,i])=>ne(n.line,i.line+1).map(o=>({oldLineNo:this.lines$.value[o]?.oldLine?.lineNumber??-1,newLineNo:this.lines$.value[o]?.newLine?.lineNumber??-1}))).pipe(S(this.destroyed$)).subscribe(()=>{this.selectionSide.next("right")})}trackByDiffLine(e,t){return e}static{this.\u0275fac=function(t){return new(t||l)(k(Ot),k(Le),k(ge),k(ue))}}static{this.\u0275cmp=se({type:l,selectors:[["app-split-view"]],viewQuery:function(t,n){if(t&1&&($(qn,7,ee),$(Gn,7,ee),$(Jn,7,ee),$(Yn,7,ee),$(G,5)),t&2){let i;R(i=A())&&(n.leftScrollContainer=i.first),R(i=A())&&(n.rightScrollContainer=i.first),R(i=A())&&(n.leftCodeElement=i.first),R(i=A())&&(n.rightCodeElement=i.first),R(i=A())&&(n.viewports=i)}},inputs:{diffLines:"diffLines"},standalone:!1,features:[ae],decls:17,vars:18,consts:[["leftScrollContainer",""],["leftCode",""],["rightScrollContainer",""],["rightCode",""],["id","diff-view_split-left"],[1,"viewport",3,"itemSize","maxBufferPx","minBufferPx"],["tabindex","0",1,"vs-code-theme","left-code"],["class","line",3,"ngClass",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["id","diff-view_split-right"],["tabindex","1",1,"vs-code-theme","right-code"],[1,"line",3,"ngClass"],[1,"selection",3,"left","width"],[1,"selection"],[1,"line-number"],[3,"ngClass"]],template:function(t,n){t&1&&(f(0,"app-grid")(1,"app-grid-cell",4)(2,"cdk-virtual-scroll-viewport",5,0)(4,"code",6,1)(6,"ul"),b(7,ni,4,5,"li",7),_(8,"async"),M()()()(),f(9,"app-grid-cell",8)(10,"cdk-virtual-scroll-viewport",5,2)(12,"code",9,3)(14,"ul"),b(15,si,4,5,"li",7),_(16,"async"),M()()()()()),t&2&&(p(2),g("itemSize",19)("maxBufferPx",1e3)("minBufferPx",200),p(4),j("margin-left",n.leftLineNumberMargin+26,"px"),p(),g("cdkVirtualForOf",P(8,14,n.lines$))("cdkVirtualForTrackBy",n.trackByDiffLine),p(3),g("itemSize",19)("maxBufferPx",1e3)("minBufferPx",200),p(4),j("margin-left",n.rightLineNumberMargin+26,"px"),p(),g("cdkVirtualForOf",P(16,16,n.lines$))("cdkVirtualForTrackBy",n.trackByDiffLine))},dependencies:[Oe,Se,G,xe,Jt,Yt,ce,be,ke],styles:["code[_ngcontent-%COMP%]{display:block;white-space:pre;user-select:none;cursor:text;outline:none}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .line-number[_ngcontent-%COMP%]{position:absolute;text-align:right;user-select:none;right:calc(100% + 26px)}code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{position:absolute;display:block;height:19px;opacity:.5}.viewport[_ngcontent-%COMP%]{height:100%;width:100%;overflow-x:scroll}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .line-number[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .line-number[_ngcontent-%COMP%]{color:#858585}.dark-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{background-color:#53789b!important}.dark-theme[_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-added[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-added[_ngcontent-%COMP%]{background:#111}.dark-theme[_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%]{background:#501515}.dark-theme[_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-removed[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-removed[_ngcontent-%COMP%]{background:#111}.dark-theme[_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%]{background:#1f2c19}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .line-number[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .line-number[_ngcontent-%COMP%]{color:#5e5e5e}.light-theme[_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > .selection[_ngcontent-%COMP%]{background-color:#add6ff!important}.light-theme[_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-added[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-added[_ngcontent-%COMP%]{background:#f0f0f0}.light-theme[_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code.left-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%]{background:#ee7e7e}.light-theme[_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-removed[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-removed[_ngcontent-%COMP%]{background:#f0f0f0}.light-theme[_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%], .light-theme   [_nghost-%COMP%]   code.right-code[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li.line-replaced[_ngcontent-%COMP%]{background:#0cd086}"],changeDetection:0})}}return l})();var Xo=(()=>{class l{static{this.\u0275fac=function(t){return new(t||l)}}static{this.\u0275mod=wt({type:l})}static{this.\u0275inj=Mt({imports:[Ft,Ut,Zt]})}}return l})();St(en,[kt,It,$e,je,Qt,He,Et,zt,Gt,on,ln,rn],[ce,qt]);export{Kt as a,en as b,Le as c,ke as d,Xo as e};
