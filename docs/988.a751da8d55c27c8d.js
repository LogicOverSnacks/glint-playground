"use strict";(self.webpackChunkgit_glint=self.webpackChunkgit_glint||[]).push([[988],{6988:(ln,K,s)=>{s.r(K),s.d(K,{SettingsLayoutModule:()=>sn});var G=s(6338),t=s(4650),A=s(3238),ct=s(3353),g=s(6895);const pt=["*",[["mat-toolbar-row"]]],mt=["*","mat-toolbar-row"],dt=(0,A.pj)(class{constructor(n){this._elementRef=n}});let gt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=t.lG2({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),n})(),ut=(()=>{class n extends dt{constructor(e,o,r){super(e),this._platform=o,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.SBq),t.Y36(ct.t4),t.Y36(g.K0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["mat-toolbar"]],contentQueries:function(e,o,r){if(1&e&&t.Suo(r,gt,5),2&e){let l;t.iGM(l=t.CRH())&&(o._toolbarRows=l)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(e,o){2&e&&t.ekj("mat-toolbar-multiple-rows",o._toolbarRows.length>0)("mat-toolbar-single-row",0===o._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[t.qOj],ngContentSelectors:mt,decls:2,vars:0,template:function(e,o){1&e&&(t.F$t(pt),t.Hsn(0),t.Hsn(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),n})(),_t=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[A.BQ,A.BQ]}),n})();var I=s(3179),ft=s(7646),m=s(5412),d=s(9549),v=s(284),P=s(4385);let ht=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.Is,d.lN,v.c,P.LD,I.I]}),n})();var Q=s(6709),$=s(1572);let Ct=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[Q.p9,m.Is,d.lN,v.c,$.Cq,I.I]}),n})(),wt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[Q.p9,m.Is,d.lN,v.c,P.LD,I.I]}),n})();var q=s(7084),xt=s(6093),yt=s(3612);let bt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.Is,q.To,d.lN,v.c,P.LD,I.I,xt.i,yt.e]}),n})(),Zt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.lN,v.c,P.LD,I.I]}),n})();var M=s(7237),f=s(655),a=s(4006),u=s(9253),C=s(7625),j=s(537),O=s(4810),S=s(9967),Y=s(1336),T=s(9578),w=s(9077),vt=s(2333),Tt=s(6271),J=s(4859),y=s(3546),k=s(7392),V=s(266),B=s(3051);const Pt=["dialog"];function Mt(n,i){if(1&n&&t._UZ(0,"app-avatar",12),2&n){const e=t.oxw().$implicit;t.Q6J("email",e.value.credentialName)}}function At(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().$implicit,l=t.oxw();return t.KtG(l.copyPublicKey(r.value.publicKeyPath))}),t.TgZ(1,"mat-icon"),t._uU(2,"content_copy"),t.qZA()()}}function Ot(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"mat-card",6)(1,"mat-card-header"),t.YNc(2,Mt,1,1,"app-avatar",7),t.TgZ(3,"mat-card-title",8),t._uU(4),t.qZA(),t.TgZ(5,"mat-card-subtitle",8),t._uU(6),t.qZA()(),t.TgZ(7,"mat-card-actions"),t.YNc(8,At,3,0,"button",9),t.TgZ(9,"button",10),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.editCredential(l.key,l.value))}),t.TgZ(10,"mat-icon"),t._uU(11,"edit"),t.qZA()(),t.TgZ(12,"button",11),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.deleteCredential(l.key))}),t.TgZ(13,"mat-icon"),t._uU(14,"delete"),t.qZA()()()()}if(2&n){const e=i.$implicit;t.xp6(2),t.Q6J("ngIf",e.value.credentialName),t.xp6(1),t.Q6J("matTooltip",e.value.credentialName),t.xp6(1),t.Oqu(e.value.credentialName),t.xp6(1),t.Q6J("matTooltip",e.value.description||""),t.xp6(1),t.Oqu(e.value.description),t.xp6(2),t.Q6J("ngIf","ssh"===e.value.type)}}function St(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Credential name is required "),t.qZA())}function Nt(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Invalid key or password "),t.qZA())}function Ut(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Private key is required "),t.qZA())}function It(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Invalid key or password "),t.qZA())}function kt(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Public key is required "),t.qZA())}function Rt(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Invalid key or password "),t.qZA())}function qt(n,i){if(1&n){const e=t.EpF();t.ynx(0,27),t.TgZ(1,"mat-form-field",16)(2,"mat-label"),t._uU(3,"Password"),t.qZA(),t._UZ(4,"input",28),t.TgZ(5,"mat-icon",29),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.showPassword=!r.showPassword)}),t._uU(6),t.qZA(),t.YNc(7,Nt,2,0,"mat-error",21),t.qZA(),t.TgZ(8,"mat-form-field",16)(9,"mat-label"),t._uU(10,"Private key"),t.qZA(),t.TgZ(11,"input",30),t.NdJ("focus",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.openDialogIfEmpty("privateKeyPath"))}),t.qZA(),t.TgZ(12,"mat-icon",31),t.NdJ("click",function(r){return t.CHM(e),t.oxw(2).openDialog("privateKeyPath"),t.KtG(r.stopPropagation())}),t._uU(13,"folder"),t.qZA(),t.YNc(14,Ut,2,0,"mat-error",21),t.YNc(15,It,2,0,"mat-error",21),t.qZA(),t.TgZ(16,"mat-form-field",16)(17,"mat-label"),t._uU(18,"Public key"),t.qZA(),t.TgZ(19,"input",32),t.NdJ("focus",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.openDialogIfEmpty("publicKeyPath"))}),t.qZA(),t.TgZ(20,"mat-icon",31),t.NdJ("click",function(r){return t.CHM(e),t.oxw(2).openDialog("publicKeyPath"),t.KtG(r.stopPropagation())}),t._uU(21,"folder"),t.qZA(),t.YNc(22,kt,2,0,"mat-error",21),t.YNc(23,Rt,2,0,"mat-error",21),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("type",e.showPassword?"text":"password"),t.xp6(2),t.hij(" ",e.showPassword?"visibility_off":"visibility"," "),t.xp6(1),t.Q6J("ngIf",e.form.controls.ssh.controls.password.hasError("invalid")),t.xp6(7),t.Q6J("ngIf",e.form.controls.ssh.controls.privateKeyPath.hasError("required")),t.xp6(1),t.Q6J("ngIf",e.form.controls.ssh.controls.privateKeyPath.hasError("invalid")),t.xp6(7),t.Q6J("ngIf",e.form.controls.ssh.controls.publicKeyPath.hasError("required")),t.xp6(1),t.Q6J("ngIf",e.form.controls.ssh.controls.publicKeyPath.hasError("invalid"))}}function Jt(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Username is required "),t.qZA())}function Vt(n,i){if(1&n){const e=t.EpF();t.ynx(0,33),t.TgZ(1,"mat-form-field",16)(2,"mat-label"),t._uU(3,"Username"),t.qZA(),t._UZ(4,"input",34),t.YNc(5,Jt,2,0,"mat-error",21),t.qZA(),t.TgZ(6,"mat-form-field",16)(7,"mat-label"),t._uU(8,"Password"),t.qZA(),t._UZ(9,"input",35),t.TgZ(10,"mat-icon",29),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.showPassword=!r.showPassword)}),t._uU(11),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(5),t.Q6J("ngIf",e.form.controls.password.controls.username.hasError("required")),t.xp6(4),t.Q6J("type",e.showPassword?"text":"password"),t.xp6(2),t.hij(" ",e.showPassword?"visibility_off":"visibility"," ")}}function Ft(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"h2",14),t._uU(1),t.qZA(),t.TgZ(2,"form",15)(3,"mat-dialog-content")(4,"mat-form-field",16)(5,"mat-label"),t._uU(6,"Credential Type"),t.qZA(),t.TgZ(7,"mat-select",17)(8,"mat-option",18),t._uU(9,"SSH Key"),t.qZA(),t.TgZ(10,"mat-option",19),t._uU(11,"Password"),t.qZA()()(),t.TgZ(12,"mat-form-field",16)(13,"mat-label"),t._uU(14,"Credential Name"),t.qZA(),t._UZ(15,"input",20),t.YNc(16,St,2,0,"mat-error",21),t.qZA(),t.TgZ(17,"mat-form-field",16)(18,"mat-label"),t._uU(19,"Description"),t.qZA(),t._UZ(20,"input",22),t.qZA(),t.YNc(21,qt,24,7,"ng-container",23),t.YNc(22,Vt,12,3,"ng-container",24),t.qZA(),t.TgZ(23,"mat-dialog-actions")(24,"button",25),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.closeCredentialDialog(!1))}),t._uU(25,"Cancel"),t.qZA(),t.TgZ(26,"button",26),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.closeCredentialDialog(!0))}),t._uU(27,"Save"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(1),t.Oqu(e.dialogTitle),t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(14),t.Q6J("ngIf",e.form.controls.credentialName.hasError("required")),t.xp6(5),t.Q6J("ngIf","ssh"===e.form.controls.type.value),t.xp6(1),t.Q6J("ngIf","password"===e.form.controls.type.value),t.xp6(4),t.Q6J("disabled",e.form.invalid)}}let Qt=(()=>{class n extends((0,O.j)(S.A)){constructor(e,o,r,l){super(),this.dialog=e,this.store=o,this.encryptionApi=r,this.filesApi=l,this.form=new a.cw({type:new a.NI("ssh",{nonNullable:!0}),credentialName:new a.NI(null,a.kI.required),description:new a.NI(null),ssh:new a.cw({password:new a.NI(null),privateKeyPath:new a.NI(null,a.kI.required),publicKeyPath:new a.NI(null,a.kI.required)}),password:new a.cw({username:new a.NI(null,a.kI.required),password:new a.NI(null)})}),this.dialogTitle="Add new credential",this.showPassword=!1,this.editingCredentialId=null,this.dialogRef=null,this.findFolderDialogDisabled=!1}ngOnInit(){this.form.controls.type.valueChanges.pipe((0,C.R)(this.destroyed$)).subscribe(e=>{"ssh"===e?(this.form.controls.ssh.enable(),this.form.controls.password.disable()):(this.form.controls.ssh.disable(),this.form.controls.password.enable())})}addNewCredential(){this.dialogRef?.close(),this.dialogTitle="Add new credential",this.showPassword=!1,this.editingCredentialId=null,this.form.reset({type:"ssh"}),this.dialogRef=this.dialog.open(this.dialogTemplateRef)}editCredential(e,o){this.dialogRef?.close(),this.dialogTitle="Edit credential",this.showPassword=!1,this.editingCredentialId=e,this.encryptionApi.decrypt(o.password).subscribe(r=>{this.form.setValue({type:o.type,credentialName:o.credentialName,description:o.description,ssh:{password:"ssh"===o.type?r:null,privateKeyPath:"ssh"===o.type?o.privateKeyPath:null,publicKeyPath:"ssh"===o.type?o.publicKeyPath:null},password:{username:"password"===o.type?o.username:null,password:"password"===o.type?r:null}}),this.dialogRef=this.dialog.open(this.dialogTemplateRef)})}closeCredentialDialog(e){if(!e)return void this.dialogRef?.close();const o=this.form.value,r="ssh"===o.type?{type:"ssh",credentialName:o.credentialName??null,description:o.description??null,password:o.ssh?.password??null,privateKeyPath:o.ssh?.privateKeyPath??null,publicKeyPath:o.ssh?.publicKeyPath??null}:{type:"password",credentialName:o.credentialName??null,description:o.description??null,username:o.password?.username??null,password:o.password?.password??null};w.$.validateCredential(r)?"ssh"===r.type?this.encryptionApi.isSshCredentialValid(r).subscribe(l=>{l?(this.store.dispatch(new T.Vh(this.editingCredentialId??this.store.selectSnapshot(w.$.maxCredentialId)+1,r)),this.dialogRef?.close()):(this.store.dispatch(new Y.NN("warn","SSH key is not valid. Check that the password is correct, and that the keys are valid and accessible")),this.form.controls.ssh.controls.password.setErrors({invalid:!0}),this.form.controls.ssh.controls.privateKeyPath.setErrors({invalid:!0}),this.form.controls.ssh.controls.publicKeyPath.setErrors({invalid:!0}))}):(this.store.dispatch(new T.Vh(this.editingCredentialId??this.store.selectSnapshot(w.$.maxCredentialId)+1,r)),this.dialogRef?.close()):(this.store.dispatch(new Y.NN("warn",`Credential form failed validation: ${JSON.stringify(o)}`)),this.dialogRef?.close())}deleteCredential(e){this.store.dispatch(new T.Tz(e))}copyPublicKey(e){this.filesApi.getFileContents([e]).subscribe(o=>{o&&navigator.clipboard.writeText(o).then(()=>{})})}openDialog(e){this.findFolderDialogDisabled||(this.findFolderDialogDisabled=!0,this.filesApi.openFileDialog().pipe((0,C.R)(this.destroyed$),(0,j.x)(()=>{this.findFolderDialogDisabled=!1})).subscribe(o=>{this.form.controls.ssh.controls[e].setValue(o)}))}openDialogIfEmpty(e){this.form.controls.ssh.controls[e].value||this.openDialog(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.uw),t.Y36(u.yh),t.Y36(vt.B),t.Y36(Tt.k))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(e,o){if(1&e&&t.Gf(Pt,5),2&e){let r;t.iGM(r=t.CRH())&&(o.dialogTemplateRef=r.first)}},features:[t.qOj],decls:10,vars:5,consts:[[1,"cards"],["class","credential",4,"ngFor","ngForOf"],["matTooltip","Add new credential",1,"add-new-credential",3,"click"],["mat-icon-button",""],["inline",""],["dialog",""],[1,"credential"],["mat-card-avatar","",3,"email",4,"ngIf"],[3,"matTooltip"],["mat-mini-fab","","color","accent","matTooltip","Copy public key to clipboard",3,"click",4,"ngIf"],["mat-mini-fab","","color","primary","matTooltip","Edit",3,"click"],["mat-mini-fab","","color","warn","matTooltip","Delete",3,"click"],["mat-card-avatar","",3,"email"],["mat-mini-fab","","color","accent","matTooltip","Copy public key to clipboard",3,"click"],["mat-dialog-title",""],[3,"formGroup"],[1,"full-width"],["required","","formControlName","type"],["value","ssh"],["value","password"],["type","text","matInput","","required","","placeholder","Enter credential name..","name","credentialName","formControlName","credentialName","cdkFocusInitial",""],[4,"ngIf"],["type","text","matInput","","placeholder","Enter description...","name","description","formControlName","description"],["formGroupName","ssh",4,"ngIf"],["formGroupName","password",4,"ngIf"],["type","button","mat-button","",3,"click"],["type","submit","mat-flat-button","","color","primary",3,"disabled","click"],["formGroupName","ssh"],["matInput","","placeholder","Leave blank for no password","name","password","formControlName","password",3,"type"],["matSuffix","",1,"password-icon",3,"click"],["type","text","matInput","","required","","placeholder","Private key path...","name","privateKeyPath","formControlName","privateKeyPath",3,"focus"],["matSuffix","",1,"file-input-icon",3,"click"],["type","text","matInput","","required","","placeholder","Public key path...","name","publicKeyPath","formControlName","publicKeyPath",3,"focus"],["formGroupName","password"],["type","text","matInput","","required","","placeholder","Enter username...","name","username","formControlName","username"],["matInput","","placeholder","Enter password...","name","password","formControlName","password",3,"type"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,Ot,15,6,"mat-card",1),t.ALo(2,"keyvalue"),t.ALo(3,"async"),t.TgZ(4,"mat-card",2),t.NdJ("click",function(){return o.addNewCredential()}),t.TgZ(5,"button",3)(6,"mat-icon",4),t._uU(7,"add"),t.qZA()()()(),t.YNc(8,Ft,28,6,"ng-template",null,5,t.W1O)),2&e&&(t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,1,t.lcZ(3,3,o.credentials))))},dependencies:[m.uh,m.xY,m.H8,d.TO,d.KE,d.hX,d.R9,v.Nt,P.gD,A.ey,g.sg,g.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.sg,a.u,a.x0,J.lW,y.a8,y.dk,y.n5,y.$j,y.hq,y.kc,k.Hw,V.gM,B.A,g.Ov,g.Nd],styles:["[_nghost-%COMP%]{padding:20px}.cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.credential[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{height:64px}.credential[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]     .mat-card-header-text{overflow:hidden}.credential[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.credential[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{margin-bottom:0;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.credential[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:10px}.add-new-credential[_ngcontent-%COMP%]{border:2px solid transparent;height:140px;text-align:center;line-height:100px;cursor:pointer}.add-new-credential[_ngcontent-%COMP%]:hover{background:#515151}.add-new-credential[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{width:104px;height:104px}.add-new-credential[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:40px}.file-input-icon[_ngcontent-%COMP%], .password-icon[_ngcontent-%COMP%]{cursor:pointer}.full-width[_ngcontent-%COMP%]{width:100%}"],changeDetection:0}),(0,f.gn)([(0,u.Ph)(w.$.credentials)],n.prototype,"credentials",void 0),(0,f.gn)([(0,u.Ph)(w.$.maxCredentialId)],n.prototype,"maxCredentialId",void 0),n})();var N=s(591),Lt=s(1737),Et=s(7221),D=s(850),L=s(7573),Gt=s(1129),h=s(4889),Yt=s(4454),Dt=s(2464),H=s(3779),Ht=s(468);let X=(()=>{class n{constructor(e){this.baseApi=e}getVersion(){return this.baseApi.single(H.w.updates.getVersion)}getUpdateChannel(){return this.baseApi.single(H.w.updates.getUpdateChannel)}setUpdateChannel(e){return this.baseApi.single(H.w.updates.setUpdateChannel,e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(Ht._))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Kt=["factoryResetDialog"];function $t(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.upgrade())}),t.ALo(1,"async"),t.TgZ(2,"span",15),t.ALo(3,"async"),t._uU(4,"Upgrade"),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("disabled",null===t.lcZ(1,2,e.user)),t.xp6(2),t.Q6J("matTooltip",t.lcZ(3,4,e.user)?"Click to purchase a subscription":"Must be logged in first")}}function jt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.manage())}),t._uU(1,"Manage"),t.qZA()}}function Bt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.logout())}),t._uU(1,"Logout"),t.qZA()}}function Xt(n,i){if(1&n&&(t.TgZ(0,"h3"),t._uU(1),t.qZA()),2&n){const e=i.ngIf;t.xp6(1),t.hij("Logged in as: ",e.email,"")}}function zt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"p"),t._uU(1,"Don't have an account? Click "),t.TgZ(2,"a",34),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.register())}),t._uU(3,"here"),t.qZA(),t._uU(4," to register."),t.qZA()}}function Wt(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Invalid email address "),t.qZA())}function te(n,i){if(1&n&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.loginForm.controls.email.getError("server").join(", ")," ")}}function ee(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Password must have at least 10 characters "),t.qZA())}function ne(n,i){if(1&n&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.loginForm.controls.password.getError("server").join(", ")," ")}}function oe(n,i){1&n&&t._UZ(0,"mat-spinner",43)}function ie(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"form",35),t.NdJ("ngSubmit",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.login())}),t.TgZ(1,"mat-form-field",36)(2,"mat-label"),t._uU(3,"Email"),t.qZA(),t._UZ(4,"input",37),t.YNc(5,Wt,2,0,"mat-error",4),t.YNc(6,te,2,1,"mat-error",4),t.qZA(),t.TgZ(7,"mat-form-field",36)(8,"mat-label"),t._uU(9,"Password"),t.qZA(),t._UZ(10,"input",38),t.ALo(11,"async"),t.TgZ(12,"button",39),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.passwordHidden.next(!r.passwordHidden.value))}),t.ALo(13,"async"),t.TgZ(14,"mat-icon"),t._uU(15),t.qZA()(),t.YNc(16,ee,2,0,"mat-error",4),t.YNc(17,ne,2,1,"mat-error",4),t.qZA(),t.TgZ(18,"button",40),t.YNc(19,oe,1,0,"mat-spinner",41),t._uU(20," Login "),t.qZA(),t.TgZ(21,"p"),t._uU(22,"Forgot your password? Click "),t.TgZ(23,"a",42),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.lostPassword())}),t._uU(24,"here"),t.qZA(),t._uU(25," to reset it."),t.qZA(),t.TgZ(26,"p"),t._uU(27,"Don't have an account? Click "),t.TgZ(28,"a",34),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.register())}),t._uU(29,"here"),t.qZA(),t._uU(30," to register."),t.qZA()()}if(2&n){const e=t.oxw(2);t.Q6J("formGroup",e.loginForm),t.xp6(5),t.Q6J("ngIf",e.loginForm.controls.email.hasError("invalid")),t.xp6(1),t.Q6J("ngIf",e.loginForm.controls.email.hasError("server")),t.xp6(4),t.uIk("type",t.lcZ(11,10,e.passwordHidden)?"password":"text"),t.xp6(2),t.Q6J("matTooltip",t.lcZ(13,12,e.passwordHidden)?"Show":"Hide"),t.xp6(3),t.Oqu(e.passwordHidden.value?"visibility":"visibility_off"),t.xp6(1),t.Q6J("ngIf",e.loginForm.controls.password.hasError("invalid")),t.xp6(1),t.Q6J("ngIf",e.loginForm.controls.password.hasError("server")),t.xp6(1),t.Q6J("disabled",e.processingLogin),t.xp6(1),t.Q6J("ngIf",e.processingLogin)}}function re(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",18)(1,"div",19)(2,"button",20),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.showLoginForm.next(!r.showLoginForm.value))}),t.ALo(3,"async"),t.TgZ(4,"mat-icon"),t._uU(5,"mail"),t.qZA(),t.TgZ(6,"span"),t._uU(7,"Login with Email"),t.qZA()(),t.TgZ(8,"button",20),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.githubLogin())}),t.O4$(),t.TgZ(9,"svg",21),t._UZ(10,"path",22),t.qZA(),t.kcU(),t.TgZ(11,"span"),t._uU(12,"Login with GitHub"),t.qZA()(),t.TgZ(13,"button",23),t.O4$(),t.TgZ(14,"svg",24)(15,"defs"),t._UZ(16,"path",25),t.qZA(),t.TgZ(17,"clipPath",26),t._UZ(18,"use",27),t.qZA(),t.TgZ(19,"g",28),t._UZ(20,"path",29)(21,"path",30)(22,"path",31)(23,"path",32),t.qZA()(),t.kcU(),t.TgZ(24,"span"),t._uU(25,"Login with Google"),t.qZA()()(),t.YNc(26,zt,5,0,"p",4),t.ALo(27,"async"),t.YNc(28,ie,31,14,"form",33),t.ALo(29,"async"),t.qZA()}if(2&n){const e=t.oxw();t.xp6(2),t.ekj("selected",t.lcZ(3,7,e.showLoginForm)),t.Q6J("disabled",e.processingLogin),t.xp6(6),t.Q6J("disabled",e.processingLogin),t.xp6(5),t.Q6J("disabled",!0),t.xp6(13),t.Q6J("ngIf",!1===t.lcZ(27,9,e.showLoginForm)),t.xp6(2),t.Q6J("ngIf",t.lcZ(29,11,e.showLoginForm))}}function ae(n,i){1&n&&(t.TgZ(0,"h2",44),t._uU(1,"Factory Reset"),t.qZA(),t.TgZ(2,"mat-dialog-content"),t._uU(3," All application settings will be erased, are you sure you want to continue? "),t.qZA(),t.TgZ(4,"mat-dialog-actions")(5,"button",45),t._uU(6,"Cancel"),t.qZA(),t.TgZ(7,"button",46),t._uU(8,"Confirm"),t.qZA()()),2&n&&(t.xp6(5),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.Q6J("mat-dialog-close",!0))}function se(n,i){1&n&&(t.TgZ(0,"span",47),t._uU(1,"s"),t.qZA())}function le(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Cannot be less than 10 seconds"),t.qZA())}let ce=(()=>{class n extends((0,O.j)(S.A)){constructor(e,o,r,l,c){super(),this.cdr=e,this.dialog=o,this.store=r,this.authService=l,this.updatesApiService=c,this.loginForm=new a.cw({email:new a.NI(null,[a.kI.email,a.kI.required]),password:new a.NI(null,[a.kI.minLength(10),a.kI.required])}),this.passwordHidden=new N.X(!0),this.processingLogin=!1,this.version=new N.X(""),this.autoFetchControl=new a.NI(null,a.kI.min(10)),this.factoryResetDialogRef=null,this.telemetryControl=new a.NI(!0,{nonNullable:!0}),this.showLoginForm=new N.X(!1)}ngOnInit(){this.accessLevel=this.authService.accessLevel,this.updatesApiService.getVersion().subscribe(e=>{this.version.next(e)}),this.autoFetchInterval.pipe((0,C.R)(this.destroyed$)).subscribe(e=>{this.autoFetchControl.setValue(e?e/1e3:null,{emitEvent:!1})}),this.autoFetchControl.valueChanges.pipe((0,C.R)(this.destroyed$)).subscribe(e=>{e&&e<10||this.store.dispatch(new T.aZ(e?1e3*e:null))}),this.telemetryEnabled.pipe((0,C.R)(this.destroyed$)).subscribe(e=>{this.telemetryControl.setValue(e,{emitEvent:!1})}),this.telemetryControl.valueChanges.pipe((0,C.R)(this.destroyed$)).subscribe(e=>{this.store.dispatch(new D.Wb(e))})}login(){this.processingLogin||!this.loginForm.controls.email.value||!this.loginForm.controls.password.value||(this.processingLogin=!0,this.authService.emailLogin(this.loginForm.controls.email.value,this.loginForm.controls.password.value).pipe((0,Et.K)(e=>{if(400===e.status){const o=[],r=[];for(const l of e.error.errors)"email"===l.param?o.push(l.msg):"password"===l.param&&r.push(l.msg);this.loginForm.controls.email.setErrors(o.length>0?{server:o}:null),this.loginForm.controls.password.setErrors(r.length>0?{server:r}:null)}else this.loginForm.controls.email.setErrors({server:["Server error. Please try again."]}),this.loginForm.controls.password.setErrors({server:["Server error. Please try again."]});return(0,Lt._)(e)}),(0,j.x)(()=>{this.processingLogin=!1,this.cdr.markForCheck()})).subscribe(()=>{this.loginForm.reset()}))}githubLogin(){this.authService.githubLogin()}logout(){this.store.dispatch(new L.RD)}lostPassword(){this.authService.emailLostPassword()}register(){this.authService.emailRegister()}upgrade(){if(!this.store.selectSnapshot(L.jq.user))throw new Error("Can only upgrade once logged in.");this.authService.purchase().subscribe()}manage(){this.authService.manageAccount()}factoryReset(){this.factoryResetDialogRef&&this.factoryResetDialogRef.close(),this.factoryResetDialogRef=this.dialog.open(this.factoryResetDialog),this.factoryResetDialogRef.afterClosed().pipe((0,C.R)(this.destroyed$)).subscribe(e=>{e&&this.store.dispatch([D.AN,L.AN,Y.AN,Gt.AN,h.AN,Yt.AN,T.AN])})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO),t.Y36(m.uw),t.Y36(u.yh),t.Y36(Dt.e),t.Y36(X))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(e,o){if(1&e&&t.Gf(Kt,5),2&e){let r;t.iGM(r=t.CRH())&&(o.factoryResetDialog=r.first)}},features:[t.qOj],decls:39,vars:26,consts:[[1,"your-plan"],["class","upgrade-button","mat-stroked-button","","color","accent",3,"disabled","click",4,"ngIf"],["type","button","mat-stroked-button","","color","primary",3,"click",4,"ngIf"],["type","button","mat-stroked-button","","color","warn",3,"click",4,"ngIf"],[4,"ngIf"],["class","login",4,"ngIf"],[1,"settings"],["type","button","mat-stroked-button","","color","warn","matTooltip","Erase all settings and reset the app to the default state",1,"factory-reset-button",3,"click"],["factoryResetDialog",""],["appearance","outline","floatLabel","always","matTooltip","Auto fetch polling interval (in seconds)",1,"form-field"],["matInput","","type","number","placeholder","Enter seconds...",1,"text-align-right",3,"formControl"],["matSuffix","",4,"ngIf"],[1,"form-field"],["matTooltip","Telemetry helps us better understand how to improve Glint. Read more in our data collection & privacy statement",3,"formControl"],["mat-stroked-button","","color","accent",1,"upgrade-button",3,"disabled","click"],[3,"matTooltip"],["type","button","mat-stroked-button","","color","primary",3,"click"],["type","button","mat-stroked-button","","color","warn",3,"click"],[1,"login"],[1,"choose-login-buttons"],["type","button","mat-stroked-button","",3,"disabled","click"],["version","1.1","width","22","height","22","aria-hidden","true","viewBox","0 0 16 16","fill","currentColor"],["fill-rule","evenodd","d","M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"],["type","button","mat-stroked-button","",3,"disabled"],["version","1.1","width","22","height","22","aria-hidden","true","viewBox","0 0 32 32","fill","currentColor"],["id","A","d","M44.5 20H24v8.5h11.8C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z"],["id","B"],[0,"xlink","href","#A"],["transform","matrix(.727273 0 0 .727273 -.954545 -1.45455)"],["d","M0 37V11l17 13z","clip-path","url(#B)"],["d","M0 11l17 13 7-6.1L48 14V0H0z","clip-path","url(#B)"],["d","M0 37l30-23 7.9 1L48 0v48H0z","clip-path","url(#B)"],["d","M48 48L17 24l-4-3 35-10z","clip-path","url(#B)"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"click"],[3,"formGroup","ngSubmit"],["appearance","outline",1,"form-field"],["type","email","matInput","","required","","formControlName","email","placeholder","Enter your email address..."],["matInput","","required","","formControlName","password","placeholder","Enter your password..."],["type","button","matSuffix","","mat-icon-button","",3,"matTooltip","click"],["type","submit","mat-stroked-button","",1,"submit-btn",3,"disabled"],["diameter","18",4,"ngIf"],[1,"link",3,"click"],["diameter","18"],["mat-dialog-title",""],["type","button","mat-button","",3,"mat-dialog-close"],["type","button","mat-button","","color","warn",3,"mat-dialog-close"],["matSuffix",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2," Your plan: "),t.TgZ(3,"span"),t.ALo(4,"async"),t._uU(5),t.ALo(6,"async"),t.qZA(),t.YNc(7,$t,5,6,"button",1),t.ALo(8,"async"),t.YNc(9,jt,2,0,"button",2),t.ALo(10,"async"),t.YNc(11,Bt,2,0,"button",3),t.ALo(12,"async"),t.qZA(),t.YNc(13,Xt,2,1,"h3",4),t.ALo(14,"async"),t.qZA(),t.YNc(15,re,30,13,"div",5),t.ALo(16,"async"),t.TgZ(17,"main",6)(18,"h2")(19,"mat-icon"),t._uU(20,"settings"),t.qZA(),t._uU(21,"Settings"),t.qZA(),t.TgZ(22,"button",7),t.NdJ("click",function(){return o.factoryReset()}),t.TgZ(23,"mat-icon"),t._uU(24,"error_outline"),t.qZA(),t._uU(25,"Factory Reset"),t.qZA(),t.YNc(26,ae,9,2,"ng-template",null,8,t.W1O),t.TgZ(28,"mat-form-field",9)(29,"mat-label"),t._uU(30,"Auto fetch every"),t.qZA(),t._UZ(31,"input",10),t.YNc(32,se,2,0,"span",11),t.TgZ(33,"mat-hint"),t._uU(34,"Leave blank to disable"),t.qZA(),t.YNc(35,le,2,0,"mat-error",4),t.qZA(),t.TgZ(36,"div",12)(37,"mat-checkbox",13),t._uU(38,"Enable telemetry"),t.qZA()()()),2&e&&(t.xp6(3),t.ekj("highlight","pro"===t.lcZ(4,12,o.accessLevel)),t.xp6(2),t.Oqu("pro"===t.lcZ(6,14,o.accessLevel)?"Premium":"Free"),t.xp6(2),t.Q6J("ngIf","free"===t.lcZ(8,16,o.accessLevel)),t.xp6(2),t.Q6J("ngIf",t.lcZ(10,18,o.user)),t.xp6(2),t.Q6J("ngIf",t.lcZ(12,20,o.user)),t.xp6(2),t.Q6J("ngIf",t.lcZ(14,22,o.user)),t.xp6(2),t.Q6J("ngIf",null===t.lcZ(16,24,o.user)),t.xp6(16),t.Q6J("formControl",o.autoFetchControl),t.xp6(1),t.Q6J("ngIf",o.autoFetchControl.value),t.xp6(3),t.Q6J("ngIf",o.autoFetchControl.hasError("min")),t.xp6(2),t.Q6J("formControl",o.telemetryControl))},dependencies:[Q.oG,m.ZT,m.uh,m.xY,m.H8,d.TO,d.KE,d.bx,d.hX,d.R9,v.Nt,$.Ou,g.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.oH,a.sg,a.u,J.lW,k.Hw,V.gM,g.Ov],styles:["[_nghost-%COMP%]{padding:10px}.your-plan[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:10px}.your-plan[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:0}.your-plan[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]{color:#ffd180}.your-plan[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:20px;vertical-align:middle}.login[_ngcontent-%COMP%]   .choose-login-buttons[_ngcontent-%COMP%]{display:flex;gap:10px;margin-bottom:10px}.login[_ngcontent-%COMP%]   .choose-login-buttons[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{background-color:#37474f}.login[_ngcontent-%COMP%]   .choose-login-buttons[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .login[_ngcontent-%COMP%]   .choose-login-buttons[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-right:10px;margin-top:-1px}.login[_ngcontent-%COMP%]   .choose-login-buttons[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}.login[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.login[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{min-width:250px;max-width:400px;width:100%}.login[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]{margin-bottom:22px}.login[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{display:inline-block;margin-right:5px;margin-top:-2px}a[_ngcontent-%COMP%]{color:#90a4ae;cursor:pointer}.settings[_ngcontent-%COMP%]{margin-top:40px}.settings[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%]{display:flex;align-items:center}.settings[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{margin-right:10px}.settings[_ngcontent-%COMP%]   .text-align-right[_ngcontent-%COMP%]{text-align:right}.settings[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, .settings[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{display:none}.settings[_ngcontent-%COMP%]     .mat-form-field-suffix{top:0}.settings[_ngcontent-%COMP%]   .factory-reset-button[_ngcontent-%COMP%]{display:block;margin-bottom:20px}.settings[_ngcontent-%COMP%]   .factory-reset-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:10px}.settings[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{margin-bottom:20px}"],changeDetection:0}),(0,f.gn)([(0,u.Ph)(L.jq.user)],n.prototype,"user",void 0),(0,f.gn)([(0,u.Ph)(w.$.autoFetchInterval)],n.prototype,"autoFetchInterval",void 0),(0,f.gn)([(0,u.Ph)(D.ie.enabled)],n.prototype,"telemetryEnabled",void 0),n})();var pe=s(567),me=s(2986),z=s(7545),F=s(4850),E=s(6197),W=s(3058);const de=["dialog"];function ge(n,i){if(1&n&&t._UZ(0,"app-avatar",13),2&n){const e=t.oxw().$implicit;t.Q6J("email",e.value.email)}}function ue(n,i){if(1&n&&(t.TgZ(0,"mat-card-subtitle")(1,"div",14),t._uU(2),t.qZA(),t.TgZ(3,"div",15),t._uU(4),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("matTooltip",e.value.name||""),t.xp6(1),t.Oqu(e.value.name),t.xp6(1),t.Q6J("matTooltip",e.value.email||""),t.xp6(1),t.Oqu(e.value.email)}}function _e(n,i){1&n&&(t.TgZ(0,"mat-card-subtitle")(1,"div",16),t._uU(2," Uses the default username and email from your git config. "),t.qZA(),t._UZ(3,"div",17),t.qZA())}function fe(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().$implicit,l=t.oxw();return t.KtG(l.setSelectedProfile(r.key))}),t.TgZ(1,"mat-icon"),t._uU(2,"app_registration"),t.qZA()()}}function he(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().$implicit,l=t.oxw();return t.KtG(l.editProfile(r.key,r.value))}),t.TgZ(1,"mat-icon"),t._uU(2,"edit"),t.qZA()()}}function Ce(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().$implicit,l=t.oxw();return t.KtG(l.deleteProfile(r.key))}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA()()}}function we(n,i){if(1&n&&(t.TgZ(0,"mat-card",6),t.ALo(1,"async"),t.TgZ(2,"mat-card-header"),t.YNc(3,ge,1,1,"app-avatar",7),t.TgZ(4,"mat-card-title",8),t._uU(5),t.qZA(),t.YNc(6,ue,5,4,"mat-card-subtitle",9),t.YNc(7,_e,4,0,"mat-card-subtitle",9),t.qZA(),t.TgZ(8,"mat-card-actions"),t.YNc(9,fe,3,0,"button",10),t.ALo(10,"async"),t.YNc(11,he,3,0,"button",11),t.YNc(12,Ce,3,0,"button",12),t.qZA()()),2&n){const e=i.$implicit,o=t.oxw();t.ekj("git-config",0===e.key)("is-default",e.key===t.lcZ(1,12,o.selectedProfileId)),t.xp6(3),t.Q6J("ngIf",e.value.email),t.xp6(1),t.Q6J("matTooltip",e.value.profileName),t.xp6(1),t.Oqu(e.value.profileName),t.xp6(1),t.Q6J("ngIf",0!==e.key),t.xp6(1),t.Q6J("ngIf",0===e.key),t.xp6(2),t.Q6J("ngIf",e.key!==t.lcZ(10,14,o.selectedProfileId)),t.xp6(2),t.Q6J("ngIf",0!==e.key),t.xp6(1),t.Q6J("ngIf",0!==e.key)}}function xe(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Profile name is required "),t.qZA())}function ye(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Name is required "),t.qZA())}function be(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Email is required "),t.qZA())}function Ze(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Invalid email "),t.qZA())}function ve(n,i){if(1&n&&(t.TgZ(0,"mat-option",34),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.Q6J("value",e.key),t.xp6(1),t.hij(" ",e.value.credentialName," ")}}function Te(n,i){if(1&n&&(t.TgZ(0,"mat-form-field",23)(1,"mat-label"),t._uU(2,"Credentials"),t.qZA(),t.TgZ(3,"mat-select",32),t.YNc(4,ve,2,2,"mat-option",33),t.ALo(5,"keyvalue"),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"mat-hint"),t._uU(8,"Choose which credentials this profile can use"),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",t.lcZ(5,1,t.lcZ(6,3,e.credentials)))}}function Pe(n,i){if(1&n&&(t.TgZ(0,"mat-option",37),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.Q6J("value",e.key)("matTooltip",e.key),t.xp6(1),t.hij(" ",e.value," ")}}function Me(n,i){if(1&n&&(t.TgZ(0,"mat-form-field",23)(1,"mat-label"),t._uU(2,"Repositories"),t.qZA(),t.TgZ(3,"mat-select",35),t.YNc(4,Pe,2,3,"mat-option",36),t.ALo(5,"keyvalue"),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"mat-hint"),t._uU(8,"Choose which repositories this profile can use"),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",t.lcZ(5,1,t.lcZ(6,3,e.repositories)))}}function Ae(n,i){if(1&n&&(t.TgZ(0,"h2",21),t._uU(1),t.qZA(),t.TgZ(2,"form",22)(3,"mat-dialog-content")(4,"mat-form-field",23)(5,"mat-label"),t._uU(6,"Profile Name"),t.qZA(),t._UZ(7,"input",24),t.YNc(8,xe,2,0,"mat-error",9),t.qZA(),t.TgZ(9,"mat-form-field",23)(10,"mat-label"),t._uU(11,"Name"),t.qZA(),t._UZ(12,"input",25),t.YNc(13,ye,2,0,"mat-error",9),t.qZA(),t.TgZ(14,"mat-form-field",23)(15,"mat-label"),t._uU(16,"Email"),t.qZA(),t._UZ(17,"input",26),t.YNc(18,be,2,0,"mat-error",9),t.YNc(19,Ze,2,0,"mat-error",9),t.qZA(),t.TgZ(20,"mat-checkbox",27),t._uU(21,"Allow access to all credentials"),t.qZA(),t.YNc(22,Te,9,5,"mat-form-field",28),t.TgZ(23,"mat-checkbox",29),t._uU(24,"Allow access to all repositories"),t.qZA(),t.YNc(25,Me,9,5,"mat-form-field",28),t.qZA(),t.TgZ(26,"mat-dialog-actions")(27,"button",30),t._uU(28,"Cancel"),t.qZA(),t.TgZ(29,"button",31),t._uU(30,"Save"),t.qZA()()()),2&n){const e=t.oxw();t.xp6(1),t.Oqu(e.dialogTitle),t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(6),t.Q6J("ngIf",e.form.controls.profileName.hasError("required")),t.xp6(5),t.Q6J("ngIf",e.form.controls.name.hasError("required")),t.xp6(5),t.Q6J("ngIf",e.form.controls.email.hasError("required")),t.xp6(1),t.Q6J("ngIf",e.form.controls.email.hasError("email")),t.xp6(3),t.Q6J("ngIf",!0!==e.form.controls.allCredentials.value),t.xp6(3),t.Q6J("ngIf",!0!==e.form.controls.allRepositories.value),t.xp6(2),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.Q6J("mat-dialog-close",!0)("disabled",e.form.invalid)}}let Oe=(()=>{class n extends((0,O.j)(S.A)){constructor(e,o,r){super(),this.dialog=e,this.store=o,this.repositoriesApi=r,this.form=new a.cw({profileName:new a.NI(null,[a.kI.required]),name:new a.NI(null,[a.kI.required]),email:new a.NI(null,[a.kI.required,a.kI.email]),allCredentials:new a.NI(!0,{nonNullable:!0}),credentials:new a.NI([],{nonNullable:!0}),allRepositories:new a.NI(!0,{nonNullable:!0}),repositories:new a.NI([],{nonNullable:!0})}),this.dialogTitle="Add new profile",this.addNewProfile=()=>{this.dialogTitle="Add new profile",this.form.reset({allCredentials:!0,credentials:[],allRepositories:!0,repositories:[]}),this.dialog.open(this.dialogTemplateRef).afterClosed().pipe((0,C.R)(this.destroyed$)).subscribe(c=>{c&&this.maxProfileId.pipe((0,me.q)(1)).subscribe(x=>{const _=this.form.value,p={profileName:_.profileName??null,name:_.name??null,email:_.email??null,credentialIds:_.allCredentials?"all":_.credentials??[],allowedRepositories:_.allRepositories?"all":_.repositories??[]};if(!w.$.validateProfile(p))throw new Error(`Profile form failed validation: ${JSON.stringify(_)}`);this.store.dispatch(new T.Bu(x+1,p))})})},this.editProfile=(l,c)=>{this.dialogTitle="Edit profile",this.form.setValue({profileName:c.profileName,name:c.name,email:c.email,allCredentials:"all"===c.credentialIds,credentials:"all"===c.credentialIds?[]:c.credentialIds,allRepositories:"all"===c.allowedRepositories,repositories:"all"===c.allowedRepositories?[]:c.allowedRepositories}),this.dialog.open(this.dialogTemplateRef).afterClosed().pipe((0,C.R)(this.destroyed$)).subscribe(_=>{if(_){const p=this.form.value,Z={...c,profileName:p.profileName??null,name:p.name??null,email:p.email??null,credentialIds:p.allCredentials?"all":p.credentials??[],allowedRepositories:p.allRepositories?"all":p.repositories??[]};if(!w.$.validateProfile(Z))throw new Error(`Profile form failed validation: ${JSON.stringify(p)}`);this.store.dispatch(new T.Bu(l,Z))}})},this.deleteProfile=l=>{this.store.dispatch(new T.p3(l))},this.setSelectedProfile=l=>{this.store.dispatch(new T.Pt(l))}}ngOnInit(){this.repositories=this.repositorySettings.pipe((0,z.w)(e=>(0,pe.D)(Object.keys(e).map(o=>this.repositoriesApi.getRepositoryName(o).pipe((0,F.U)(r=>[o,r]))))),(0,F.U)(Object.fromEntries))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.uw),t.Y36(u.yh),t.Y36(W.a))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(e,o){if(1&e&&t.Gf(de,5),2&e){let r;t.iGM(r=t.CRH())&&(o.dialogTemplateRef=r.first)}},features:[t.qOj],decls:10,vars:5,consts:[[1,"cards"],["class","profile",3,"git-config","is-default",4,"ngFor","ngForOf"],["matTooltip","Add new profile",1,"add-new-profile",3,"click"],["mat-icon-button",""],["inline",""],["dialog",""],[1,"profile"],["mat-card-avatar","",3,"email",4,"ngIf"],[3,"matTooltip"],[4,"ngIf"],["type","button","mat-mini-fab","","color","primary","matTooltip","Select profile",3,"click",4,"ngIf"],["type","button","mat-mini-fab","","color","primary","matTooltip","Edit",3,"click",4,"ngIf"],["type","button","mat-mini-fab","","color","warn","matTooltip","Delete",3,"click",4,"ngIf"],["mat-card-avatar","",3,"email"],[1,"subtitle-name",3,"matTooltip"],[1,"subtitle-email",3,"matTooltip"],["matTooltip","Uses the default username and email from your git config",1,"subtitle-name"],[1,"subtitle-email"],["type","button","mat-mini-fab","","color","primary","matTooltip","Select profile",3,"click"],["type","button","mat-mini-fab","","color","primary","matTooltip","Edit",3,"click"],["type","button","mat-mini-fab","","color","warn","matTooltip","Delete",3,"click"],["mat-dialog-title",""],[1,"dialog-form",3,"formGroup"],[1,"full-width"],["type","text","matInput","","required","","placeholder","Enter profile name..","name","profileName","formControlName","profileName","cdkFocusInitial",""],["type","text","matInput","","required","","placeholder","Enter name...","name","name","formControlName","name"],["type","email","email","","matInput","","required","","placeholder","Enter email...","name","email","formControlName","email"],["formControlName","allCredentials"],["class","full-width",4,"ngIf"],["formControlName","allRepositories"],["type","button","mat-button","",3,"mat-dialog-close"],["type","submit","mat-flat-button","","color","primary",3,"mat-dialog-close","disabled"],["formControlName","credentials","multiple",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","repositories","multiple",""],[3,"value","matTooltip",4,"ngFor","ngForOf"],[3,"value","matTooltip"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,we,13,16,"mat-card",1),t.ALo(2,"keyvalue"),t.ALo(3,"async"),t.TgZ(4,"mat-card",2),t.NdJ("click",function(){return o.addNewProfile()}),t.TgZ(5,"button",3)(6,"mat-icon",4),t._uU(7,"add"),t.qZA()()()(),t.YNc(8,Ae,31,11,"ng-template",null,5,t.W1O)),2&e&&(t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,1,t.lcZ(3,3,o.profiles))))},dependencies:[Q.oG,m.ZT,m.uh,m.xY,m.H8,d.TO,d.KE,d.bx,d.hX,v.Nt,P.gD,A.ey,g.sg,g.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.on,a.sg,a.u,J.lW,y.a8,y.dk,y.n5,y.$j,y.hq,y.kc,k.Hw,V.gM,B.A,g.Ov,g.Nd],styles:["[_nghost-%COMP%]{padding:20px}.cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.profile[_ngcontent-%COMP%]{border:2px solid transparent}.profile.is-default[_ngcontent-%COMP%]{border-color:#607d8b}.profile.git-config[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]   .subtitle-name[_ngcontent-%COMP%]{overflow:auto;white-space:normal}.profile[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{height:66px;margin-bottom:10px}.profile[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]     .mat-card-header-text{overflow:hidden}.profile[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.1}.profile[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{margin-bottom:0}.profile[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]   .subtitle-name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.profile[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]   .subtitle-email[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.profile[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:10px}.add-new-profile[_ngcontent-%COMP%]{border:2px solid transparent;height:142px;text-align:center;cursor:pointer}.add-new-profile[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{width:106px;height:106px}.add-new-profile[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:40px}.full-width[_ngcontent-%COMP%]{width:100%}.dialog-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:50vw}.dialog-form[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{display:block;margin:8px 0}"],changeDetection:0}),(0,f.gn)([(0,u.Ph)(w.$.profiles)],n.prototype,"profiles",void 0),(0,f.gn)([(0,u.Ph)(w.$.credentials)],n.prototype,"credentials",void 0),(0,f.gn)([(0,u.Ph)(w.$.selectedProfileId)],n.prototype,"selectedProfileId",void 0),(0,f.gn)([(0,u.Ph)(w.$.maxProfileId)],n.prototype,"maxProfileId",void 0),(0,f.gn)([(0,u.Ph)(E.E.repositorySettings)],n.prototype,"repositorySettings",void 0),n})();var tt=s(9251),et=s(9160),nt=s(5724),ot=s(3943),Se=s(5174),Ne=s(8929),it=s(6053),Ue=s(2198),rt=s(1059),at=s(6792),st=s(1307),Ie=s(2120),lt=s(744);const ke=["addRemoteDialog"];function Re(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().$implicit,l=t.oxw(2);return t.KtG(l.setSelectedRemote(r.name))}),t.TgZ(1,"mat-icon"),t._uU(2,"app_registration"),t.qZA()()}}function qe(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"tr",6)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td")(4,"mat-form-field",7)(5,"mat-label"),t._uU(6,"URL"),t.qZA(),t._UZ(7,"input",8),t.qZA()(),t.TgZ(8,"td"),t.YNc(9,Re,3,0,"button",9),t.TgZ(10,"button",10),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.deleteRemote(l.name))}),t.TgZ(11,"mat-icon"),t._uU(12,"delete"),t.qZA()()()()}if(2&n){const e=i.$implicit,o=t.oxw().ngIf;t.ekj("selected",o.selectedRemote===e.name),t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Q6J("matTooltip","The URL for "+e.name),t.xp6(3),t.Q6J("formControl",e.control),t.xp6(2),t.Q6J("ngIf",o.selectedRemote!==e.name)}}function Je(n,i){if(1&n&&(t.TgZ(0,"h2",12),t._uU(1,"Add Remote"),t.qZA(),t.TgZ(2,"form",13)(3,"mat-dialog-content")(4,"mat-form-field",14)(5,"mat-label"),t._uU(6,"Name"),t.qZA(),t._UZ(7,"input",15),t.qZA(),t.TgZ(8,"mat-form-field",14)(9,"mat-label"),t._uU(10,"Url"),t.qZA(),t._UZ(11,"input",16),t.qZA()(),t.TgZ(12,"mat-dialog-actions")(13,"button",17),t._uU(14,"Cancel"),t.qZA(),t.TgZ(15,"button",18),t._uU(16,"Save"),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("formGroup",e.addRemoteForm),t.xp6(11),t.Q6J("mat-dialog-close",null),t.xp6(2),t.Q6J("mat-dialog-close",e.addRemoteForm.value)("disabled",e.addRemoteForm.invalid)}}function Ve(n,i){if(1&n&&(t.TgZ(0,"mat-option",29),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}function Fe(n,i){if(1&n&&(t.TgZ(0,"mat-form-field",25)(1,"mat-label"),t._uU(2),t.qZA(),t.TgZ(3,"mat-select",26)(4,"mat-option",27),t._uU(5,"None"),t.qZA(),t.YNc(6,Ve,2,2,"mat-option",28),t.qZA()()),2&n){const e=i.$implicit,o=t.oxw().$implicit,r=t.oxw(3);t.Q6J("matTooltip","Credential to use for "+e.key+" when using the "+o.name+" profile"),t.xp6(2),t.Oqu(e.key),t.xp6(1),t.Q6J("formControl",e.value.control),t.xp6(3),t.Q6J("ngForOf",r.getValidCredentials(o.credentials,e.value.url))}}function Qe(n,i){if(1&n&&(t.TgZ(0,"tr",23)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t.YNc(4,Fe,7,4,"mat-form-field",24),t.ALo(5,"keyvalue"),t.qZA()()),2&n){const e=i.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Q6J("ngForOf",t.lcZ(5,2,e.remotes))}}function Le(n,i){if(1&n&&(t.TgZ(0,"section",19)(1,"h2")(2,"mat-icon"),t._uU(3,"key"),t.qZA(),t._uU(4,"Credentials"),t.qZA(),t.TgZ(5,"table")(6,"thead")(7,"tr",20)(8,"td",21),t._uU(9,"Profile"),t.qZA(),t.TgZ(10,"td"),t._uU(11,"Credential to use"),t.qZA()()(),t.TgZ(12,"tbody"),t.YNc(13,Qe,6,4,"tr",22),t.ALo(14,"async"),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(13),t.Q6J("ngForOf",t.lcZ(14,1,e.profiles))}}function Ee(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"section",1)(2,"h2")(3,"mat-icon"),t._uU(4,"cloud_queue"),t.qZA(),t._uU(5,"Remotes"),t.qZA(),t.TgZ(6,"table")(7,"tbody"),t.YNc(8,qe,13,6,"tr",2),t.ALo(9,"async"),t.qZA()(),t.TgZ(10,"button",3),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.addRemote())}),t.TgZ(11,"mat-icon"),t._uU(12,"add"),t.qZA()(),t.YNc(13,Je,17,4,"ng-template",null,4,t.W1O),t.qZA(),t.YNc(15,Le,15,3,"section",5),t.ALo(16,"nullEmpty"),t.ALo(17,"async"),t.BQk()}if(2&n){const e=t.oxw();t.xp6(8),t.Q6J("ngForOf",t.lcZ(9,3,e.remotes))("ngForTrackBy",e.trackRemote),t.xp6(7),t.Q6J("ngIf",t.lcZ(16,5,t.lcZ(17,7,e.remotes)))}}let Ge=(()=>{class n extends((0,O.j)(S.A)){constructor(e,o,r,l){super(),this.dialog=e,this.store=o,this.remotesApi=r,this.repositoriesApi=l,this.remotes=new N.X([]),this.repositorySettings=new N.X(null),this.profiles=new N.X([]),this.addRemoteForm=new a.cw({name:new a.NI("origin",{nonNullable:!0}),url:new a.NI(null)}),this.addRemoteDialogRef=null,this.remoteUpdates$=new Ne.xQ,this.getValidCredentials=(c,x)=>/^https?:\/\//.test(x)?c.filter(_=>"password"===_.type):/^(git|file)?:\/\//.test(x)||/^\//.test(x)||!/:/.test(x)?[]:c.filter(_=>"ssh"===_.type),this.deleteRemote=c=>{this.remotesApi.deleteRemote(this.lastRepositoryId,c).subscribe(()=>{this.store.dispatch(new h.Vu(this.lastRepositoryId,[h.nh.commits,h.nh.currentBranchUpstreamBranch,h.nh.merges,h.nh.references,h.nh.remotes,h.nh.selectedMerge])),this.remoteUpdates$.next()})},this.setSelectedRemote=c=>{this.store.dispatch(new h.J2(this.lastRepositoryId,c))},this.addRemote=()=>{this.addRemoteDialogRef&&this.addRemoteDialogRef.close(),this.addRemoteForm.reset({name:"origin"}),this.addRemoteDialogRef=this.dialog.open(this.addRemoteDialog),this.addRemoteDialogRef.afterClosed().pipe((0,C.R)(this.destroyed$)).subscribe(c=>{if(c){if(!c.name)throw new Error("Cannot add a remote with no name");if(!c.url)throw new Error("Cannot add a remote with no url");this.remotesApi.addRemote(this.lastRepositoryId,c.name,c.url).subscribe(()=>{this.store.dispatch(new h.Vu(this.lastRepositoryId,[h.nh.commits,h.nh.currentBranchUpstreamBranch,h.nh.references,h.nh.remotes])),this.remoteUpdates$.next()})}})}}ngOnInit(){const e=(0,it.aj)([this.repositoryId.pipe((0,Ue.h)(Ie.Nf)),this.allRepositorySettings,this.allProfiles,this.allCredentials,this.remoteUpdates$.pipe((0,rt.O)(void 0))]);e.pipe((0,z.w)(([o,r,l,c])=>this.remotesApi.getRemotes(o).pipe((0,F.U)(x=>[o,x,r[o],l,c]))),(0,C.R)(this.destroyed$),(0,at.g)(0)).subscribe(([o,r,l,c,x])=>{this.lastRepositoryId=o,this.repositorySettings.next(l),this.remotes.next(r.map(p=>({name:p.name,control:new a.NI(p.url,{nonNullable:!0,validators:a.kI.required})}))),this.remotes.value.forEach(p=>{p.control.valueChanges.subscribe(Z=>{this.remotesApi.updateRemoteUrl(o,p.name,Z).subscribe(),this.remoteUpdates$.next()})});const _=[...c].map(([p,Z])=>{const R="all"===Z.credentialIds?[...x]:[...x].filter(([b])=>Z.credentialIds.includes(b));return{id:p,name:Z.profileName,credentials:R.map(([b,U])=>({id:b,name:U.credentialName,type:U.type})),remotes:Object.fromEntries(r.map(b=>[b.name,{url:b.url,control:new a.NI(l.profiles.get(p)?.remotes[b.name]?.credentialId??"none",{nonNullable:!0})}]))}});this.profiles.next(_),_.forEach(p=>{const Z=Object.entries(p.remotes).map(([R,{control:b}])=>b.valueChanges.pipe((0,rt.O)(p.remotes[R].control.value),(0,F.U)(U=>[R,U])));(0,it.aj)(Z).pipe((0,at.g)(0),(0,st.T)(1),(0,C.R)(e.pipe((0,st.T)(1))),(0,C.R)(this.destroyed$)).subscribe(R=>{this.store.dispatch(new h.xs(l.path,p.id,{remotes:Object.fromEntries(R.map(([b,U])=>[b,{credentialId:"none"===U?null:U}]))}))})})})}trackRemote(e,o){return o.name}trackProfile(e,o){return o.id}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.uw),t.Y36(u.yh),t.Y36(et.G),t.Y36(W.a))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-repository-settings-view"]],viewQuery:function(e,o){if(1&e&&t.Gf(ke,5),2&e){let r;t.iGM(r=t.CRH())&&(o.addRemoteDialog=r.first)}},inputs:{repositoryId:"repositoryId"},features:[t.qOj],decls:2,vars:3,consts:[[4,"ngIf"],[1,"remotes"],["class","remote",3,"selected",4,"ngFor","ngForOf","ngForTrackBy"],["type","button","mat-stroked-button","","matTooltip","Add remote",1,"add-remote-button",3,"click"],["addRemoteDialog",""],["class","credentials",4,"ngIf"],[1,"remote"],[1,"full-width",3,"matTooltip"],["type","url","matInput","","required","",3,"formControl"],["mat-mini-fab","","color","primary","matTooltip","Set as default remote",3,"click",4,"ngIf"],["mat-mini-fab","","color","primary","matTooltip","Delete remote",3,"click"],["mat-mini-fab","","color","primary","matTooltip","Set as default remote",3,"click"],["mat-dialog-title",""],[3,"formGroup"],[1,"full-width"],["type","text","matInput","","required","","formControlName","name"],["type","url","matInput","","required","","formControlName","url"],["mat-button","",3,"mat-dialog-close"],["mat-flat-button","","type","submit","color","primary",3,"mat-dialog-close","disabled"],[1,"credentials"],[1,"heading"],[1,"credentials-profile-name"],["class","profile",4,"ngFor","ngForOf"],[1,"profile"],["class","credential-selector full-width",3,"matTooltip",4,"ngFor","ngForOf"],[1,"credential-selector","full-width",3,"matTooltip"],["placeholder","Select credential",3,"formControl"],["value","none"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,o){1&e&&(t.YNc(0,Ee,18,9,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,o.repositorySettings))},dependencies:[m.ZT,m.uh,m.xY,m.H8,d.KE,d.hX,v.Nt,P.gD,A.ey,g.sg,g.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.oH,a.sg,a.u,J.lW,k.Hw,V.gM,g.Ov,g.Nd,lt.x],styles:["[_nghost-%COMP%]{display:block;padding:0 5px}.full-width[_ngcontent-%COMP%]{width:100%}.remotes[_ngcontent-%COMP%]{margin-bottom:20px}.remotes[_ngcontent-%COMP%]     .mat-form-field-wrapper{padding-bottom:0}.remotes[_ngcontent-%COMP%]   .add-remote-button[_ngcontent-%COMP%]{margin-top:10px}.remotes[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%], .credentials[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%]{display:flex;align-items:center}.remotes[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%], .credentials[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%] > mat-icon[_ngcontent-%COMP%]{margin-right:10px}.remotes[_ngcontent-%COMP%]   table[_ngcontent-%COMP%], .credentials[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-collapse:separate;border-spacing:0;width:100%}.remotes[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .credentials[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{font-weight:700}.remotes[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .credentials[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-top:0}.remotes[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .credentials[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:2px solid transparent;border-bottom:2px solid transparent;padding:15px 7.5px}.remotes[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child, .credentials[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{border-left:2px solid transparent;border-top-left-radius:4px;border-bottom-left-radius:4px;padding-left:15px}.remotes[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child, .credentials[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-right:2px solid transparent;border-top-right-radius:4px;border-bottom-right-radius:4px;padding-right:15px}.remotes[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%] > td[_ngcontent-%COMP%], .credentials[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{border-color:#607d8b}.remotes[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{width:115px;text-align:right}.remotes[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child   button[_ngcontent-%COMP%]{margin-left:10px}.remotes[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child   button[_ngcontent-%COMP%]:first-child{margin-left:0}"],changeDetection:0}),(0,f.gn)([(0,u.Ph)(E.E.repositorySettings)],n.prototype,"allRepositorySettings",void 0),(0,f.gn)([(0,u.Ph)(w.$.profiles)],n.prototype,"allProfiles",void 0),(0,f.gn)([(0,u.Ph)(w.$.credentials)],n.prototype,"allCredentials",void 0),n})();function Ye(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"li",8),t.NdJ("click",function(){const l=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.selectRepository(l.path))})("dragstart",function(r){const c=t.CHM(e).$implicit,x=t.oxw(2);return t.KtG(x.dragstartListener(r,c.path))}),t.ALo(1,"async"),t._uU(2),t.qZA()}if(2&n){const e=i.$implicit,o=t.oxw(2);t.ekj("selected",e.path===t.lcZ(1,4,o.repositoryId)),t.Q6J("matTooltip",e.path),t.xp6(2),t.hij(" ",e.name," ")}}function De(n,i){if(1&n&&(t.TgZ(0,"mat-expansion-panel",4)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"mat-icon",5),t._uU(4,"view_list"),t.qZA(),t._uU(5,"Currently open"),t.qZA()(),t.TgZ(6,"ul",6),t.YNc(7,Ye,3,6,"li",7),t.qZA()()),2&n){const e=i.ngIf;t.xp6(7),t.Q6J("ngForOf",e)}}function He(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"mat-expansion-panel",4)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"mat-icon",5),t._uU(4,"bookmarks"),t.qZA(),t._uU(5,"Bookmarks"),t.qZA()(),t.TgZ(6,"app-repository-bookmarks-view",9),t.NdJ("nodeClick",function(r){t.CHM(e);const l=t.oxw();return t.KtG(l.selectBookmark(r))}),t.ALo(7,"async"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(6),t.Q6J("selectedNodeId",t.lcZ(7,1,e.repositoryId))}}function Ke(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"mat-expansion-panel",4)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"mat-icon",5),t._uU(4,"history"),t.qZA(),t._uU(5,"Recently opened"),t.qZA()(),t.TgZ(6,"app-repository-history-view",10),t.NdJ("clicked",function(r){t.CHM(e);const l=t.oxw();return t.KtG(l.selectRepository(r))})("dragStarted",function(r){t.CHM(e);const l=t.oxw();return t.KtG(l.dragstartListener(r[0],r[1]))}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(6),t.Q6J("selectedId",e.repositoryId)}}function $e(n,i){if(1&n&&t._UZ(0,"app-repository-settings-view",11),2&n){const e=t.oxw();t.Q6J("repositoryId",e.repositoryId)}}let je=(()=>{class n extends((0,O.j)(S.A)){constructor(e,o,r){super(),this.route=e,this.router=o,this.remotesApi=r,this.repositoryId=this.route.queryParamMap.pipe((0,F.U)(l=>l.get("id"))),this.dragstartListener=(l,c)=>{l.dataTransfer&&(l.dataTransfer.setData("app/repository",c),l.dataTransfer.effectAllowed="move")}}selectRepository(e){this.remotesApi.getRemotes(e).subscribe(()=>{this.router.navigate([],{relativeTo:this.route,queryParams:{id:e}})})}selectBookmark(e){(0,tt.b)(e)||this.selectRepository(e.id)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(M.gz),t.Y36(M.F0),t.Y36(et.G))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],features:[t.qOj],decls:13,vars:14,consts:[["id","repositories-settings-view"],["multi","",1,"repositories"],["expanded","",4,"ngIf"],["class","settings",3,"repositoryId",4,"ngIf"],["expanded",""],[1,"title-icon"],[1,"open-repositories"],["draggable","true",3,"selected","matTooltip","click","dragstart",4,"ngFor","ngForOf"],["draggable","true",3,"matTooltip","click","dragstart"],[3,"selectedNodeId","nodeClick"],[3,"selectedId","clicked","dragStarted"],[1,"settings",3,"repositoryId"]],template:function(e,o){1&e&&(t.TgZ(0,"app-grid",0)(1,"app-grid-cell")(2,"mat-accordion",1),t.YNc(3,De,8,1,"mat-expansion-panel",2),t.ALo(4,"nullEmpty"),t.ALo(5,"async"),t.YNc(6,He,8,3,"mat-expansion-panel",2),t.YNc(7,Ke,7,1,"mat-expansion-panel",2),t.ALo(8,"nullEmpty"),t.ALo(9,"async"),t.qZA()(),t.TgZ(10,"app-grid-cell"),t.YNc(11,$e,1,1,"app-repository-settings-view",3),t.ALo(12,"async"),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("ngIf",t.lcZ(4,4,t.lcZ(5,6,o.openRepositories))),t.xp6(3),t.Q6J("ngIf",!0),t.xp6(1),t.Q6J("ngIf",t.lcZ(8,8,t.lcZ(9,10,o.recentRepositories))),t.xp6(4),t.Q6J("ngIf",t.lcZ(12,12,o.repositoryId)))},dependencies:[q.pp,q.ib,q.yz,q.yK,g.sg,g.O5,k.Hw,V.gM,nt.Y,ot.M,tt.j,Se.J,Ge,g.Ov,lt.x],styles:[".repositories[_ngcontent-%COMP%], .settings[_ngcontent-%COMP%]{display:block;padding:5px}.open-repositories[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:10px;cursor:pointer}.open-repositories[_ngcontent-%COMP%] > li.selected[_ngcontent-%COMP%]{background:#78909c}mat-panel-title[_ngcontent-%COMP%]{line-height:24px}mat-panel-title[_ngcontent-%COMP%]   .title-icon[_ngcontent-%COMP%]{margin-right:10px}"],changeDetection:0}),(0,f.gn)([(0,u.Ph)(E.E.openRepositories)],n.prototype,"openRepositories",void 0),(0,f.gn)([(0,u.Ph)(E.E.recentRepositories)],n.prototype,"recentRepositories",void 0),n})(),Be=(()=>{class n extends((0,O.j)(S.A)){constructor(e){super(),this.updatesApiService=e,this.channelControl=new a.NI("latest",{nonNullable:!0}),this.version=new N.X("")}ngOnInit(){this.updatesApiService.getVersion().subscribe(e=>{this.version.next(e)}),this.updatesApiService.getUpdateChannel().subscribe(e=>{this.channelControl.setValue(e,{emitEvent:!1})}),this.channelControl.valueChanges.pipe((0,C.R)(this.destroyed$)).subscribe(e=>{this.channelControl.disable({emitEvent:!1}),this.updatesApiService.setUpdateChannel(e).subscribe(()=>{this.channelControl.enable({emitEvent:!1})})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(X))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],features:[t.qOj],decls:13,vars:4,consts:[[3,"formControl"],["value","alpha"],["value","beta"],["value","latest"]],template:function(e,o){1&e&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"async"),t.qZA(),t.TgZ(3,"mat-form-field")(4,"mat-label"),t._uU(5,"Update Channel"),t.qZA(),t.TgZ(6,"mat-select",0)(7,"mat-option",1),t._uU(8,"alpha"),t.qZA(),t.TgZ(9,"mat-option",2),t._uU(10,"beta"),t.qZA(),t.TgZ(11,"mat-option",3),t._uU(12,"latest"),t.qZA()()()),2&e&&(t.xp6(1),t.hij("Version: ",t.lcZ(2,2,o.version),""),t.xp6(5),t.Q6J("formControl",o.channelControl))},dependencies:[d.KE,d.hX,P.gD,A.ey,a.JJ,a.oH,g.Ov],styles:["[_nghost-%COMP%]{padding:10px}"],changeDetection:0}),n})();var Xe=s(7784),ze=s(2049);const We=function(){return["./general"]},tn=function(){return["./profiles"]},en=function(){return["./credentials"]},nn=function(){return["./repositories"]},on=function(){return["./about"]},rn=[{path:"",component:(()=>{class n extends((0,O.j)(S.A)){constructor(e,o){super(),this.router=e,this.routerHistoryService=o,this.previousUrl=null,this.close=()=>{this.router.navigate([this.previousUrl??"/"])}}ngOnInit(){this.previousUrl=this.routerHistoryService.history.length>=2?this.routerHistoryService.history.slice(-2)[0]:null}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(M.F0),t.Y36(Xe.X))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ng-component"]],features:[t.qOj],decls:34,vars:10,consts:[[1,"spacer"],["mat-icon-button","",3,"click"],[1,"mat-app-background"],["id","settings-layout"],["min","200px"],[1,"links"],["routerLinkActive","active",3,"routerLink"],["svgIcon","source-repository"],["min","500px"]],template:function(e,o){1&e&&(t.TgZ(0,"header")(1,"mat-toolbar")(2,"span"),t._uU(3,"Settings"),t.qZA(),t._UZ(4,"span",0),t.TgZ(5,"button",1),t.NdJ("click",function(){return o.close()}),t.TgZ(6,"mat-icon"),t._uU(7,"close"),t.qZA()()()(),t.TgZ(8,"main",2)(9,"app-grid",3)(10,"app-grid-cell",4)(11,"mat-list",5)(12,"mat-list-item",6)(13,"mat-icon"),t._uU(14,"build"),t.qZA(),t._uU(15,"General"),t.qZA(),t.TgZ(16,"mat-list-item",6)(17,"mat-icon"),t._uU(18,"person"),t.qZA(),t._uU(19,"Profiles"),t.qZA(),t.TgZ(20,"mat-list-item",6)(21,"mat-icon"),t._uU(22,"key"),t.qZA(),t._uU(23,"Credentials"),t.qZA(),t.TgZ(24,"mat-list-item",6),t._UZ(25,"mat-icon",7),t._uU(26,"Repositories "),t.qZA(),t.TgZ(27,"mat-list-item",6)(28,"mat-icon"),t._uU(29,"info"),t.qZA(),t._uU(30,"About"),t.qZA()()(),t.TgZ(31,"app-grid-cell",8),t._UZ(32,"router-outlet"),t.qZA()()(),t._UZ(33,"app-errors-tray-view")),2&e&&(t.xp6(12),t.Q6J("routerLink",t.DdM(5,We)),t.xp6(4),t.Q6J("routerLink",t.DdM(6,tn)),t.xp6(4),t.Q6J("routerLink",t.DdM(7,en)),t.xp6(4),t.Q6J("routerLink",t.DdM(8,nn)),t.xp6(3),t.Q6J("routerLink",t.DdM(9,on)))},dependencies:[G.i$,G.Tg,ut,J.lW,k.Hw,nt.Y,ot.M,ze.c,M.lC,M.rH,M.Od],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}header[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:1 1 auto}main[_ngcontent-%COMP%]{height:100%;overflow:hidden}main[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]{padding-top:0}main[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{outline:none;cursor:pointer}main[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]   mat-list-item.active[_ngcontent-%COMP%]{background:#78909c}main[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:10px}main[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]   .exit-icon[_ngcontent-%COMP%]{line-height:48px;margin-right:10px}app-errors-tray-view[_ngcontent-%COMP%]{position:fixed;bottom:10px;left:10px;margin-right:10px;margin-top:10px;z-index:6000}"],changeDetection:0}),n})(),children:[{path:"general",component:ce},{path:"repositories",component:je},{path:"profiles",component:Oe},{path:"credentials",component:Qt},{path:"about",component:Be},{path:"",redirectTo:"general",pathMatch:"full"}]}];let an=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[M.Bz.forChild(rn),M.Bz]}),n})(),sn=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[G.ie,_t,I.I,ft.P,an,ht,Ct,wt,bt,Zt]}),n})()}}]);