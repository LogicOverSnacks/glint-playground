"use strict";(global.webpackChunkgit_glint=global.webpackChunkgit_glint||[]).push([[5934],{55934:(ht,N,n)=>{n.r(N),n.d(N,{OpenRepositoryLayoutModule:()=>gt});var M=n(42663),R=n(16400),T=n(1869),c=n(28167),Z=n(10138),t=n(83668);let k=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[c.lN,Z.c,R.LD,T.I]]}),e})(),j=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[c.lN,Z.c,T.I]]}),e})();var Q=n(56690),D=n(81947);let E=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[c.lN,Z.c,T.I,Q.i,D.e]]}),e})();var g=n(31818),L=n(61855),O=n(52324),h=n(44496),b=n(20373),$=n(37810),H=n(40452),P=n(43334),z=n(85148),X=n(98771),y=n(35634),G=n(67254),u=n(7060),K=n(30366),q=n(83912),f=n(50499),F=n(35956),l=n(83664),B=n(42328),A=n(8537),v=n(86019),p=n(49133),_=n(59112),V=n(90086),W=n(6731);function tt(e,i){if(1&e&&(t.TgZ(0,"mat-option",11),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.Q6J("value",+o.key),t.xp6(1),t.Oqu(o.value.credentialName)}}function et(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"form",2),t.NdJ("ngSubmit",function(){return t.CHM(o),t.oxw().clone()}),t.TgZ(1,"mat-form-field",3),t.TgZ(2,"mat-label"),t._uU(3,"URL"),t.qZA(),t.TgZ(4,"mat-icon",4),t._uU(5,"public"),t.qZA(),t._UZ(6,"input",5),t.qZA(),t.TgZ(7,"mat-form-field",6),t.TgZ(8,"mat-label"),t._uU(9,"Path to clone to"),t.qZA(),t.TgZ(10,"mat-icon",4),t._uU(11,"folder"),t.qZA(),t._UZ(12,"input",7),t.TgZ(13,"button",8),t.NdJ("click",function(){return t.CHM(o),t.oxw().browsePath()}),t._uU(14,"Browse"),t.qZA(),t.qZA(),t.TgZ(15,"mat-form-field",9),t.TgZ(16,"mat-label"),t._uU(17,"Credential"),t.qZA(),t.TgZ(18,"mat-icon",4),t._uU(19,"key"),t.qZA(),t.TgZ(20,"mat-select",10),t.TgZ(21,"mat-option",11),t._uU(22,"None"),t.qZA(),t.YNc(23,tt,2,2,"mat-option",12),t.ALo(24,"keyvalue"),t.ALo(25,"async"),t.qZA(),t.qZA(),t.TgZ(26,"button",13),t._uU(27,"Clone"),t.qZA(),t.qZA()}if(2&e){const o=t.oxw();t.Q6J("formGroup",o.form.ng),t.xp6(21),t.Q6J("value",null),t.xp6(2),t.Q6J("ngForOf",t.lcZ(24,4,t.lcZ(25,6,o.validCredentials))),t.xp6(3),t.Q6J("disabled",o.form.invalid)}}function ot(e,i){1&e&&(t.TgZ(0,"div"),t._uU(1," Cloning...\n"),t.qZA())}class w extends((0,f.jB)(f.Aw)){constructor(i,o,s,r){super(),this.router=i,this.store=o,this.filesApi=s,this.repositoriesApi=r,this.cloning=new $.X(!1),this.form=new h.CN({url:new h.rV(null,b.Y$.required),path:new h.rV(null,b.Y$.required),credential:new h.rV(null)}),this.validCredentials=(0,H.aj)([this.allCredentials,this.form.controls.url.valueChanges.pipe((0,z.O)(null))]).pipe((0,X.U)(([m,a])=>{const C=[...m.entries()];return Object.fromEntries(a?/^https?:\/\//.test(a)?C.filter(([U,d])=>"password"===d.type):/^(git|file)?:\/\//.test(a)||/^\//.test(a)||!/:/.test(a)?[]:C.filter(([U,d])=>"ssh"===d.type):C)})),this.browsePath=()=>{this.filesApi.openFolderDialog().pipe((0,y.R)(this.destroyed$)).subscribe(m=>{m&&this.form.controls.path.setValue(m)})},this.clone=()=>{if(this.cloning.value)throw new Error("Already cloning");const{url:m,path:a,credential:C}=this.form.value;if(!m)throw new Error("Cannot clone repository with no url");if(!a)throw new Error("Cannot clone repository with no local path");const U=this.store.selectSnapshot(B.$.credentials);this.cloning.next(!0),this.repositoriesApi.cloneRepository(m,a,C?U.get(C):void 0).pipe((0,G.K)(d=>q.Ay.matches(d)||q.T0.matches(d)?this.store.dispatch(new F.NN("error",d.message)).pipe((0,u.w)(()=>(0,P._)(d))):(0,P._)(d)),(0,u.w)(()=>this.store.dispatch(new l.gz(a))),(0,u.w)(()=>this.store.dispatch(new l.he(a))),(0,y.R)(this.destroyed$),(0,u.w)(()=>this.store.dispatch(new l.BZ(a))),(0,K.x)(()=>{this.cloning.next(!1)})).subscribe(()=>{this.router.navigate(["/"])})}}}w.\u0275fac=function(i){return new(i||w)(t.Y36(g.F0),t.Y36(O.yh),t.Y36(A.kI),t.Y36(A.aM))},w.\u0275cmp=t.Xpm({type:w,selectors:[["app-clone-repository-view"]],features:[t.qOj],decls:4,vars:6,consts:[[3,"formGroup","ngSubmit",4,"ngIf"],[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"url"],["matPrefix",""],["type","text","matInput","","required","","formControlName","url"],[1,"path"],["type","text","matInput","","required","","formControlName","path"],["type","button","matSuffix","","mat-button","",3,"click"],[1,"credential"],["formControlName","credential","placeholder","Select credential"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["type","submit","mat-raised-button","","color","primary",3,"disabled"]],template:function(i,o){1&i&&(t.YNc(0,et,28,8,"form",0),t.ALo(1,"async"),t.YNc(2,ot,2,0,"div",1),t.ALo(3,"async")),2&i&&(t.Q6J("ngIf",!1===t.lcZ(1,2,o.cloning)),t.xp6(2),t.Q6J("ngIf",t.lcZ(3,4,o.cloning)))},directives:[v.O5,p._Y,p.JL,p.sg,c.KE,c.hX,_.Hw,c.qo,Z.Nt,p.Fj,p.Q7,p.JJ,p.u,V.lW,c.R9,R.gD,W.ey,v.sg],pipes:[v.Ov,v.Nd],styles:["form[_ngcontent-%COMP%]{margin:10px;max-width:500px}form[_ngcontent-%COMP%]   .url[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   .path[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   .credential[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]     .mat-form-field-prefix{margin-right:10px}form[_ngcontent-%COMP%]   .path[_ngcontent-%COMP%]     .mat-form-field-suffix{top:-.25em}"],changeDetection:0}),(0,L.gn)([(0,O.Ph)(B.$.credentials)],w.prototype,"allCredentials",void 0);let nt=(()=>{class e extends((0,f.jB)(f.Aw)){constructor(o,s,r,m){super(),this.router=o,this.store=s,this.filesApi=r,this.repositoriesApi=m,this.form=new h.CN({path:new h.rV(null,b.Y$.required),defaultBranch:new h.rV("main")}),this.browsePath=()=>{this.filesApi.openFolderDialog().pipe((0,y.R)(this.destroyed$)).subscribe(a=>{a&&this.form.controls.path.setValue(a)})},this.create=()=>{const{path:a,defaultBranch:C}=this.form.value;if(!a)throw new Error("Cannot create repository with no local path");this.repositoriesApi.createRepository(a,C??"main").pipe((0,u.w)(()=>this.store.dispatch(new l.gz(a))),(0,u.w)(()=>this.store.dispatch(new l.he(a))),(0,u.w)(()=>this.store.dispatch(new l.BZ(a))),(0,y.R)(this.destroyed$)).subscribe(()=>{this.router.navigate(["/"])})}}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(g.F0),t.Y36(O.yh),t.Y36(A.kI),t.Y36(A.aM))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-create-repository-view"]],features:[t.qOj],decls:16,vars:2,consts:[[3,"formGroup","ngSubmit"],[1,"path"],["matPrefix",""],["type","text","matInput","","required","","formControlName","path"],["type","button","matSuffix","","mat-button","",3,"click"],[1,"default-branch"],["matPrefix","","svgIcon","source-branch"],["type","text","placeholder","main","matInput","","formControlName","defaultBranch"],["type","submit","mat-raised-button","","color","primary",3,"disabled"]],template:function(o,s){1&o&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return s.create()}),t.TgZ(1,"mat-form-field",1),t.TgZ(2,"mat-label"),t._uU(3,"Path to create in"),t.qZA(),t.TgZ(4,"mat-icon",2),t._uU(5,"folder"),t.qZA(),t._UZ(6,"input",3),t.TgZ(7,"button",4),t.NdJ("click",function(){return s.browsePath()}),t._uU(8,"Browse"),t.qZA(),t.qZA(),t.TgZ(9,"mat-form-field",5),t.TgZ(10,"mat-label"),t._uU(11,"Default branch"),t.qZA(),t._UZ(12,"mat-icon",6),t._UZ(13,"input",7),t.qZA(),t.TgZ(14,"button",8),t._uU(15,"Create"),t.qZA(),t.qZA()),2&o&&(t.Q6J("formGroup",s.form.ng),t.xp6(14),t.Q6J("disabled",s.form.invalid))},directives:[p._Y,p.JL,p.sg,c.KE,c.hX,_.Hw,c.qo,Z.Nt,p.Fj,p.Q7,p.JJ,p.u,V.lW,c.R9],styles:["form[_ngcontent-%COMP%]{margin:10px;max-width:500px}form[_ngcontent-%COMP%]   .path[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   .default-branch[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]     .mat-form-field-prefix{margin-right:10px}form[_ngcontent-%COMP%]     .mat-form-field-suffix{top:-.25em}"],changeDetection:0}),e})();var it=n(84475),Y=n(64841),I=n(6939),S=n(33116),J=n(80888),rt=n(20630),st=n(51552);function at(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){return t.CHM(o),t.oxw(2).searchControl.setValue(null)}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA(),t.qZA()}}function pt(e,i){if(1&e&&(t.TgZ(0,"mat-form-field",7),t.TgZ(1,"mat-label"),t._uU(2,"Search"),t.qZA(),t.TgZ(3,"span",8),t.TgZ(4,"mat-icon"),t._uU(5,"search"),t.qZA(),t._uU(6,"\xa0"),t.qZA(),t._UZ(7,"input",9),t.YNc(8,at,3,0,"button",10),t.qZA()),2&e){const o=t.oxw();t.xp6(7),t.Q6J("formControl",o.searchControl.ng),t.xp6(1),t.Q6J("ngIf",o.searchControl.value)}}function ct(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"mat-card"),t.TgZ(1,"mat-card-title"),t.TgZ(2,"mat-icon"),t._uU(3,"history"),t.qZA(),t._uU(4," Recently opened"),t.qZA(),t.TgZ(5,"mat-card-content"),t.TgZ(6,"app-repository-history-view",12),t.NdJ("clicked",function(r){return t.CHM(o),t.oxw().openRecent(r)})("dragStarted",function(r){return t.CHM(o),t.oxw().dragstartListener(r[0],r[1])}),t.qZA(),t.qZA(),t.qZA()}}class x extends((0,f.jB)(f.Aw)){constructor(i,o,s){super(),this.router=i,this.store=o,this.filesApi=s,this.searchControl=new h.rV,this.openBookmark=r=>{(0,Y.b)(r)||this.store.dispatch(new l.he(r.id)).pipe((0,u.w)(()=>this.store.dispatch(new l.BZ(r.id))),(0,y.R)(this.destroyed$)).subscribe(()=>{this.router.navigate(["/"])})},this.openRecent=r=>{this.store.dispatch(new l.he(r)).pipe((0,u.w)(()=>this.store.dispatch(new l.BZ(r))),(0,y.R)(this.destroyed$)).subscribe(()=>{this.router.navigate(["/"])})},this.openFromDisk=()=>{this.filesApi.openFolderDialog().pipe((0,y.R)(this.destroyed$)).subscribe(r=>{r&&this.store.dispatch(new l.gz(r)).pipe((0,u.w)(()=>this.store.dispatch(new l.he(r))),(0,u.w)(()=>this.store.dispatch(new l.BZ(r))),(0,y.R)(this.destroyed$)).subscribe(()=>{this.router.navigate(["/"])})})},this.dragstartListener=(r,m)=>{r.dataTransfer&&(r.dataTransfer.setData("app/repository",m),r.dataTransfer.effectAllowed="move")}}}x.\u0275fac=function(i){return new(i||x)(t.Y36(g.F0),t.Y36(O.yh),t.Y36(A.kI))},x.\u0275cmp=t.Xpm({type:x,selectors:[["app-open-repository-view"]],features:[t.qOj],decls:20,vars:6,consts:[["type","button","mat-flat-button","",1,"open-from-disk-button",3,"click"],["class","search-box",4,"ngIf"],["id","open-repository-view"],["min","210px"],[3,"nodeClick"],["min","300px"],[4,"ngIf"],[1,"search-box"],["matPrefix",""],["matInput","","type","text",3,"formControl"],["matSuffix","","mat-icon-button","",3,"click",4,"ngIf"],["matSuffix","","mat-icon-button","",3,"click"],[3,"clicked","dragStarted"]],template:function(i,o){1&i&&(t.TgZ(0,"header"),t.TgZ(1,"button",0),t.NdJ("click",function(){return o.openFromDisk()}),t.TgZ(2,"mat-icon"),t._uU(3,"folder_open"),t.qZA(),t._uU(4," Open from disk "),t.qZA(),t.YNc(5,pt,9,2,"mat-form-field",1),t.qZA(),t.TgZ(6,"main"),t.TgZ(7,"app-grid",2),t.TgZ(8,"app-grid-cell",3),t.TgZ(9,"mat-card"),t.TgZ(10,"mat-card-title"),t.TgZ(11,"mat-icon"),t._uU(12,"bookmarks"),t.qZA(),t._uU(13," Bookmarks"),t.qZA(),t.TgZ(14,"mat-card-content"),t.TgZ(15,"app-repository-bookmarks-view",4),t.NdJ("nodeClick",function(r){return o.openBookmark(r)}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(16,"app-grid-cell",5),t.YNc(17,ct,7,0,"mat-card",6),t.ALo(18,"nullEmpty"),t.ALo(19,"async"),t.qZA(),t.qZA(),t.qZA()),2&i&&(t.xp6(5),t.Q6J("ngIf",!1),t.xp6(12),t.Q6J("ngIf",t.lcZ(18,2,t.lcZ(19,4,o.recentRepositories))))},directives:[V.lW,_.Hw,v.O5,I.M,S.Y,J.a8,J.n5,J.dn,Y.j,c.KE,c.hX,c.qo,Z.Nt,p.Fj,p.JJ,p.oH,c.R9,rt.J],pipes:[st.x,v.Ov],styles:["header[_ngcontent-%COMP%]{margin:10px 10px 0;display:flex;align-items:baseline}header[_ngcontent-%COMP%]   .open-from-disk-button[_ngcontent-%COMP%]{margin-bottom:26px}header[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]{flex:auto;margin-left:10px}main[_ngcontent-%COMP%]{padding:0 5px 10px}main[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{margin:0 5px}"],changeDetection:0}),(0,L.gn)([(0,O.Ph)(it.E.recentRepositories)],x.prototype,"recentRepositories",void 0);const lt=function(){return["./open"]},mt=function(){return["./clone"]},ut=function(){return["./create"]},dt=[{path:"",component:(()=>{class e extends((0,f.jB)(f.Aw,f.Hi)){}return e.\u0275fac=function(){let i;return function(s){return(i||(i=t.n5z(e)))(s||e)}}(),e.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],features:[t.qOj],decls:12,vars:6,consts:[[1,"mat-app-background"],["id","open-repository-layout"],["min","150px"],[1,"links"],["routerLinkActive","active",3,"routerLink"]],template:function(o,s){1&o&&(t.TgZ(0,"main",0),t.TgZ(1,"app-grid",1),t.TgZ(2,"app-grid-cell",2),t.TgZ(3,"mat-list",3),t.TgZ(4,"mat-list-item",4),t._uU(5,"Open"),t.qZA(),t.TgZ(6,"mat-list-item",4),t._uU(7,"Clone"),t.qZA(),t.TgZ(8,"mat-list-item",4),t._uU(9,"Create"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"app-grid-cell"),t._UZ(11,"router-outlet"),t.qZA(),t.qZA(),t.qZA()),2&o&&(t.xp6(4),t.Q6J("routerLink",t.DdM(3,lt)),t.xp6(2),t.Q6J("routerLink",t.DdM(4,mt)),t.xp6(2),t.Q6J("routerLink",t.DdM(5,ut)))},directives:[I.M,S.Y,M.i$,M.Tg,g.Od,g.rH,g.lC],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.dark-theme[_nghost-%COMP%]   header[_ngcontent-%COMP%]{border-bottom-color:#ffffff1f}header[_ngcontent-%COMP%]{display:flex;border-bottom:1px solid transparent}header[_ngcontent-%COMP%]   app-repository-tabs-view[_ngcontent-%COMP%]{flex:1 0 auto}header[_ngcontent-%COMP%]   app-repository-tabs-view[_ngcontent-%COMP%]     .mat-tab-nav-bar{border:none}header[_ngcontent-%COMP%]   .settings-icon[_ngcontent-%COMP%]{margin:12px;cursor:pointer}main[_ngcontent-%COMP%]{height:100%;overflow:hidden}main[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]{padding-top:0}main[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{outline:none;cursor:pointer}main[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]   mat-list-item.active[_ngcontent-%COMP%]{background:#78909c}app-errors-tray-view[_ngcontent-%COMP%]{position:fixed;bottom:10px;left:10px;margin-right:10px;margin-top:10px;z-index:600}"],changeDetection:0}),e})(),children:[{path:"open",component:x},{path:"clone",component:w},{path:"create",component:nt},{path:"",redirectTo:"open",pathMatch:"full"}]}];let ft=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[g.Bz.forChild(dt)],g.Bz]}),e})(),gt=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[M.ie,R.LD,T.I,k,j,E,ft]]}),e})()}}]);