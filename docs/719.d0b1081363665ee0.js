"use strict";(self.webpackChunkgit_glint=self.webpackChunkgit_glint||[]).push([[719],{3178:(F,M,s)=>{s.d(M,{l:()=>T});var v=s(4080),e=s(5698),l=s(2722),P=s(9967),x=s(8926),C=s(8310),c=s(4650),B=s(8184);class T extends((0,x.j)(P.A)){constructor(u,y){super(),this.overlay=u,this.viewContainerRef=y,this.overlayRef=null,this.closeMenu=()=>{this.overlayRef?.dispose(),this.overlayRef=null},this.openMenu=(p,k)=>{this.closeMenu(),this.overlayRef=this.overlay.create({positionStrategy:this.overlay.position().flexibleConnectedTo({x:p,y:k}).withPositions([{originX:"end",originY:"bottom",overlayX:"start",overlayY:"top"}])}),this.overlayRef.attach(new v.UE(this.menuTemplate,this.viewContainerRef,{data:this.data})),(0,C.t)(this.overlayRef).pipe((0,e.q)(1),(0,l.R)(this.destroyed$)).subscribe(this.closeMenu)},this.toggleMenu=(p,k)=>{this.overlayRef?this.closeMenu():this.openMenu(p,k)}}contextmenuListener(u){u.preventDefault(),u.stopPropagation(),this.openMenu(u.x,u.y)}ngOnDestroy(){super.ngOnDestroy(),this.closeMenu()}static{this.\u0275fac=function(y){return new(y||T)(c.Y36(B.aV),c.Y36(c.s_b))}}static{this.\u0275dir=c.lG2({type:T,selectors:[["","appContextMenu",""]],hostBindings:function(y,p){1&y&&c.NdJ("contextmenu",function(g){return p.contextmenuListener(g)})},inputs:{menuTemplate:["appContextMenu","menuTemplate"],data:["appContextMenuData","data"]},exportAs:["appContextMenu"],features:[c.qOj]})}}},9251:(F,M,s)=>{s.d(M,{j:()=>pe,b:()=>K});var v=s(655),e=s(4650),l=s(4006),P=s(9867),x=s(4128),C=s(4004),c=s(5698),B=s(2722),T=s(8926),L=s(9967),u=s(4889),y=s(6966),p=s(5412),k=s(9549),g=s(284),_=s(6895),f=s(4859),D=s(7392),w=s(266),J=s(3178);class R{constructor(r){this.template=r}static{this.\u0275fac=function(t){return new(t||R)(e.Y36(e.Rgc))}}static{this.\u0275dir=e.lG2({type:R,selectors:[["","appTreeLeafNode",""]]})}}class A{constructor(r){this.template=r}static{this.\u0275fac=function(t){return new(t||A)(e.Y36(e.Rgc))}}static{this.\u0275dir=e.lG2({type:A,selectors:[["","appTreeNode",""]]})}}var O=s(7340);function $(a,r){1&a&&e.GkF(0)}const V=function(a){return{$implicit:a}};class I{constructor(r){this.element=r,this.dragListeners=[],this.attrDraggable=!0,this.dragstartListener=t=>{t.dataTransfer&&(t.dataTransfer.setData("app/tree",this.node.id),t.dataTransfer.effectAllowed="move")},this.dragenterListener=t=>{this.dragoverPosition=this.getDragoverPosition(t.offsetY)},this.dragleaveListener=t=>{this.dragoverPosition="none"},this.dragoverListener=t=>{if(t.dataTransfer){const n=t.dataTransfer;["app/tree",...this.dragListeners.map(([i])=>i)].some(i=>n.types.includes(i)&&n.getData(i)!==this.node.id)&&(t.preventDefault(),t.dataTransfer.dropEffect="move",this.dragoverPosition=this.getDragoverPosition(t.offsetY))}},this.dropListener=t=>{if(t.dataTransfer){const n=t.dataTransfer,o=this.getDragoverPosition(t.offsetY);if(n.types.includes("app/tree")){const i=n.getData("app/tree");this.isDescendant(i,this.node.id)||(t.preventDefault(),this.update(i,this.node.id,o))}this.dragListeners.forEach(([i,d])=>{n.types.includes(i)&&(t.preventDefault(),d(n.getData(i),this.node.id,o,!0))})}this.dragoverPosition="none"},this.dragoverPosition="none",this.getDragoverPosition=t=>t/this.element.nativeElement.clientHeight<.5?"above":"below"}get classDragAbove(){return"above"===this.dragoverPosition}get classDragBelow(){return"below"===this.dragoverPosition}static{this.\u0275fac=function(t){return new(t||I)(e.Y36(e.SBq))}}static{this.\u0275cmp=e.Xpm({type:I,selectors:[["app-tree-leaf-node"]],hostVars:5,hostBindings:function(t,n){1&t&&e.NdJ("dragstart",function(i){return n.dragstartListener(i)})("dragenter",function(i){return n.dragenterListener(i)})("dragleave",function(i){return n.dragleaveListener(i)})("dragover",function(i){return n.dragoverListener(i)})("drop",function(i){return n.dropListener(i)}),2&t&&(e.uIk("draggable",n.attrDraggable),e.ekj("drag-above",n.classDragAbove)("drag-below",n.classDragBelow))},inputs:{node:"node",update:"update",isDescendant:"isDescendant",template:"template",dragListeners:"dragListeners"},decls:1,vars:4,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,n){1&t&&e.YNc(0,$,1,0,"ng-container",0),2&t&&e.Q6J("ngTemplateOutlet",n.template)("ngTemplateOutletContext",e.VKq(2,V,n.node))},dependencies:[_.tP],styles:["[_nghost-%COMP%]{display:block;border-top:5px solid transparent;border-bottom:5px solid transparent}.drag-above[_nghost-%COMP%]{border-top-color:#3c3c3c}.drag-below[_nghost-%COMP%]{border-bottom-color:#3c3c3c}"],changeDetection:0})}}function W(a,r){1&a&&e.GkF(0)}function Y(a,r){if(1&a&&e._UZ(0,"app-tree-node",7),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.Q6J("node",t)("update",n.update)("updateExpanded",n.updateExpanded)("isDescendant",n.isDescendant)("templates",n.templates)("dragListeners",n.dragListeners)}}function Q(a,r){if(1&a&&e._UZ(0,"app-tree-leaf-node",8),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.Q6J("node",t)("update",n.update)("isDescendant",n.isDescendant)("template",n.templates.leafNode)("dragListeners",n.dragListeners)}}function G(a,r){if(1&a&&(e.ynx(0),e.YNc(1,Y,1,6,"app-tree-node",5),e.YNc(2,Q,1,5,"app-tree-leaf-node",6),e.BQk()),2&a){const t=r.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",n.isNode(t)),e.xp6(1),e.Q6J("ngIf",n.isLeaf(t))}}function S(a,r){if(1&a&&(e.TgZ(0,"div",3),e.YNc(1,G,3,2,"ng-container",4),e.qZA()),2&a){const t=e.oxw();e.Q6J("@.disabled",t.animationsDisabled)("@slide",void 0),e.xp6(1),e.Q6J("ngForOf",t.node.children)("ngForTrackBy",t.trackById)}}const j=function(a){return{$implicit:a}};class E{constructor(r){this.element=r,this.dragListeners=[],this.animationsDisabled=!0,this.dragoverPosition="none",this.dragoverStarted=null,this.dragstartListener=t=>{t.dataTransfer&&(t.dataTransfer.setData("app/tree",this.node.id),t.dataTransfer.effectAllowed="move")},this.dragenterListener=t=>{this.dragoverPosition=this.getDragoverPosition(t.offsetY),this.dragoverStarted=(new Date).getTime()},this.dragleaveListener=t=>{this.dragoverPosition="none",this.dragoverStarted=null},this.dragoverListener=t=>{if(t.dataTransfer){const n=t.dataTransfer;if(["app/tree",...this.dragListeners.map(([i])=>i)].some(i=>n.types.includes(i)&&n.getData(i)!==this.node.id)&&(t.preventDefault(),t.dataTransfer.dropEffect="move",this.dragoverPosition=this.getDragoverPosition(t.offsetY),!this.node.expanded))if("center"===this.dragoverPosition){const i=(new Date).getTime();null===this.dragoverStarted?this.dragoverStarted=i:i-this.dragoverStarted>E.expandWaitPeriod&&(this.node.expanded=!0)}else this.dragoverStarted=null}},this.dropListener=t=>{if(t.dataTransfer){const n=t.dataTransfer,o=this.getDragoverPosition(t.offsetY);if(n.types.includes("app/tree")){const i=n.getData("app/tree");this.isDescendant(i,this.node.id)||(t.preventDefault(),this.update(i,this.node.id,o))}this.dragListeners.forEach(([i,d])=>{n.types.includes(i)&&(t.preventDefault(),d(n.getData(i),this.node.id,o,!1))})}this.dragoverPosition="none",this.dragoverStarted=null},this.clickListener=t=>{t.preventDefault(),this.node.expanded=!this.node.expanded,this.updateExpanded(this.node.id,this.node.expanded)},this.isLeaf=t=>!t.children,this.isNode=t=>!!t.children,this.getDragoverPosition=t=>t<0?"above":t<this.element.nativeElement.clientHeight-2*E.padding?"center":"below"}static{this.padding=5}static{this.expandWaitPeriod=750}ngAfterViewInit(){this.animationsDisabled=!1}trackById(r,t){return t.id}static{this.\u0275fac=function(t){return new(t||E)(e.Y36(e.SBq))}}static{this.\u0275cmp=e.Xpm({type:E,selectors:[["app-tree-node"]],inputs:{node:"node",update:"update",updateExpanded:"updateExpanded",isDescendant:"isDescendant",templates:"templates",dragListeners:"dragListeners"},decls:3,vars:11,consts:[["draggable","true",1,"tree-node-heading",3,"dragstart","dragenter","dragleave","dragover","drop","click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","tree-node-children",4,"ngIf"],[1,"tree-node-children"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"node","update","updateExpanded","isDescendant","templates","dragListeners",4,"ngIf"],[3,"node","update","isDescendant","template","dragListeners",4,"ngIf"],[3,"node","update","updateExpanded","isDescendant","templates","dragListeners"],[3,"node","update","isDescendant","template","dragListeners"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.NdJ("dragstart",function(i){return n.dragstartListener(i)})("dragenter",function(i){return n.dragenterListener(i)})("dragleave",function(i){return n.dragleaveListener(i)})("dragover",function(i){return n.dragoverListener(i)})("drop",function(i){return n.dropListener(i)})("click",function(i){return n.clickListener(i)}),e.YNc(1,W,1,0,"ng-container",1),e.qZA(),e.YNc(2,S,2,4,"div",2)),2&t&&(e.ekj("drag-above","above"===n.dragoverPosition)("drag-below","below"===n.dragoverPosition)("drag-center","center"===n.dragoverPosition),e.xp6(1),e.Q6J("ngTemplateOutlet",n.templates.node)("ngTemplateOutletContext",e.VKq(9,j,n.node)),e.xp6(1),e.Q6J("ngIf",n.node.expanded))},dependencies:[_.sg,_.O5,_.tP,E,I],styles:["[_nghost-%COMP%]{display:block}.tree-node-heading[_ngcontent-%COMP%]{cursor:pointer;border-top:5px solid transparent;border-bottom:5px solid transparent}.tree-node-heading.drag-above[_ngcontent-%COMP%]{border-top-color:#3c3c3c}.tree-node-heading.drag-below[_ngcontent-%COMP%]{border-bottom-color:#3c3c3c}.tree-node-heading.drag-center[_ngcontent-%COMP%]{background-color:#3c3c3c}.tree-node-children[_ngcontent-%COMP%]{margin-left:20px;overflow:hidden}"],data:{animation:[(0,O.X$)("slide",[(0,O.eR)(":enter",[(0,O.oB)({height:0}),(0,O.jt)("225ms ease-in-out",(0,O.oB)({height:"*"}))]),(0,O.eR)(":leave",[(0,O.oB)({height:"*"}),(0,O.jt)("225ms ease-in-out",(0,O.oB)({height:0}))])])]},changeDetection:0})}}function X(a,r){if(1&a&&e._UZ(0,"app-tree-node",3),2&a){const t=e.oxw().$implicit,n=e.oxw();e.Q6J("node",t)("update",n.update)("updateExpanded",n.updateExpanded)("isDescendant",n.isDescendant)("templates",n.templates)("dragListeners",n.dragListeners)}}function z(a,r){if(1&a&&e._UZ(0,"app-tree-leaf-node",4),2&a){const t=e.oxw().$implicit,n=e.oxw();e.Q6J("node",t)("update",n.update)("isDescendant",n.isDescendant)("template",n.templates.leafNode)("dragListeners",n.dragListeners)}}function q(a,r){if(1&a&&(e.ynx(0),e.YNc(1,X,1,6,"app-tree-node",1),e.YNc(2,z,1,5,"app-tree-leaf-node",2),e.BQk()),2&a){const t=r.$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.isNode(t)),e.xp6(1),e.Q6J("ngIf",n.isLeaf(t))}}class Z extends((0,T.j)(L.A)){constructor(){super(...arguments),this.indent=20,this.indentUnits="px",this.dragListeners=[],this.outputTree=new e.vpe,this.isDescendant=(r,t)=>{if(r===t)return!0;const n=this.getNodeById(r,this.tree);if(!n)throw new Error(`Couldn't find node with id '${r}'.`);return null!==this.getNodeById(t,n.children)},this.update=(r,t,n)=>{const o=this.removeNode(r,this.tree);if(!o)throw new Error(`Could not remove node '${r}'.`);const[i,d]=o,m=this.findSiblingNodesWithIndex(t,d);if(!m)throw new Error(`Cannot find target node '${t}'.`);const[h,N]=m;switch(n){case"above":h.splice(N,0,i);break;case"below":h.splice(N+1,0,i);break;case"center":const b=h[N].children;if(!b)throw new Error("Cannot add a node inside of a leaf node.");b.push(i),h[N].expanded=!0;break;default:throw new Error(`Position type not recognized '${n}'. Should be one of 'above', 'below', 'center'.`)}this.tree=d,this.outputTree.next(d)},this.updateExpanded=(r,t)=>{const n=this.updateNodeExpanded(r,t,this.tree);if(!n)throw new Error(`Could not update node '${r}'.`);this.tree=n,this.outputTree.next(n)},this.isLeaf=r=>!r.children,this.isNode=r=>!!r.children}get templates(){return{node:this.nodeDirective.template,leafNode:this.leafNodeDirective.template}}trackById(r,t){return t.id}getNodeById(r,t){if(t)for(const n of t){if(n.id===r)return n;const o=this.getNodeById(r,n.children);if(o)return o}return null}findSiblingNodesWithIndex(r,t){if(t)for(let n=0;n<t.length;n++){if(t[n].id===r)return[t,n];const o=this.findSiblingNodesWithIndex(r,t[n].children);if(o)return o}return null}removeNode(r,t){if(t)for(let n=0;n<t.length;n++){if(t[n].id===r)return[t[n],[...t.slice(0,n),...t.slice(n+1)]];const o=this.removeNode(r,t[n].children);if(o)return[o[0],[...t.slice(0,n),{...t[n],children:o[1]},...t.slice(n+1)]]}return null}updateNodeExpanded(r,t,n){if(n)for(let o=0;o<n.length;o++){if(n[o].id===r)return[...n.slice(0,o),{...n[o],expanded:t},...n.slice(o+1)];const i=this.updateNodeExpanded(r,t,n[o].children);if(i)return[...n.slice(0,o),{...n[o],children:i},...n.slice(o+1)]}return null}static{this.\u0275fac=function(){let r;return function(n){return(r||(r=e.n5z(Z)))(n||Z)}}()}static{this.\u0275cmp=e.Xpm({type:Z,selectors:[["app-tree"]],contentQueries:function(t,n,o){if(1&t&&(e.Suo(o,A,5),e.Suo(o,R,5)),2&t){let i;e.iGM(i=e.CRH())&&(n.nodeDirective=i.first),e.iGM(i=e.CRH())&&(n.leafNodeDirective=i.first)}},inputs:{tree:"tree",indent:"indent",indentUnits:"indentUnits",dragListeners:"dragListeners"},outputs:{outputTree:"treeChange"},features:[e.qOj],decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],[3,"node","update","updateExpanded","isDescendant","templates","dragListeners",4,"ngIf"],[3,"node","update","isDescendant","template","dragListeners",4,"ngIf"],[3,"node","update","updateExpanded","isDescendant","templates","dragListeners"],[3,"node","update","isDescendant","template","dragListeners"]],template:function(t,n){1&t&&e.YNc(0,q,3,2,"ng-container",0),2&t&&e.Q6J("ngForOf",n.tree)("ngForTrackBy",n.trackById)},dependencies:[_.sg,_.O5,E,I],encapsulation:2,changeDetection:0})}}const ee=["dialogTemplate"];function te(a,r){if(1&a&&(e.TgZ(0,"mat-icon"),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.expanded?"expand_more":"chevron_right")}}function ne(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",12)(1,"button",13),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,i=e.oxw(2);return e.KtG(i.addFolder(o.id))}),e.TgZ(2,"mat-icon"),e._uU(3,"create_new_folder"),e.qZA(),e.TgZ(4,"span"),e._uU(5,"New folder"),e.qZA()(),e.TgZ(6,"button",13),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,i=e.oxw(2);return e.KtG(i.renameFolder(o))}),e.TgZ(7,"mat-icon"),e._uU(8,"edit"),e.qZA(),e.TgZ(9,"span"),e._uU(10,"Rename"),e.qZA()(),e.TgZ(11,"button",13),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,i=e.oxw(2);return e.KtG(i.deleteNode(o))}),e.TgZ(12,"mat-icon"),e._uU(13,"delete"),e.qZA(),e.TgZ(14,"span"),e._uU(15,"Delete"),e.qZA()()()}}function oe(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",7,8),e.NdJ("click",function(){const i=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.nodeClick.next(i))}),e.TgZ(2,"span")(3,"mat-icon",9),e._uU(4,"folder"),e.qZA(),e._uU(5),e.qZA(),e.TgZ(6,"button",10),e.YNc(7,te,2,1,"mat-icon",0),e.qZA(),e.YNc(8,ne,16,0,"ng-template",null,11,e.W1O),e.qZA()}if(2&a){const t=r.$implicit,n=e.MAs(9),o=e.oxw(2);e.ekj("selected",o.selectedNodeId===t.id),e.Q6J("appContextMenu",n),e.xp6(5),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf",t.children.length>0)}}function ie(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",12)(1,"button",13),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,i=e.oxw(2);return e.KtG(i.deleteNode(o))}),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA(),e.TgZ(4,"span"),e._uU(5,"Delete"),e.qZA()()()}}function re(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",14,8),e.NdJ("click",function(){const i=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.nodeClick.next(i))}),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.YNc(4,ie,6,0,"ng-template",null,11,e.W1O),e.qZA()}if(2&a){const t=r.$implicit,n=e.MAs(5),o=e.oxw(2);e.ekj("selected",o.selectedNodeId===t.id),e.Q6J("appContextMenu",n)("matTooltip",t.id),e.xp6(3),e.Oqu(t.name)}}function ae(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",15),e.NdJ("dragover",function(o){e.CHM(t);const i=e.oxw(2);return e.KtG(i.dragoverListener(o))})("drop",function(o){e.CHM(t);const i=e.oxw(2);return e.KtG(i.dropListener(o))}),e.qZA()}}const se=function(a){return["app/repository",a]},de=function(a){return[a]};function ce(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-tree",3),e.NdJ("treeChange",function(o){e.CHM(t);const i=e.oxw();return e.KtG(i.treeChanged(o))}),e.YNc(2,oe,10,5,"div",4),e.YNc(3,re,6,5,"div",5),e.qZA(),e.YNc(4,ae,1,0,"div",6),e.BQk()}if(2&a){const t=r.ngIf,n=e.oxw();e.xp6(1),e.Q6J("tree",t)("dragListeners",e.VKq(5,de,e.VKq(3,se,n.addNode))),e.xp6(3),e.Q6J("ngIf",0===t.length)}}function le(a,r){if(1&a&&(e.TgZ(0,"div",16),e._uU(1),e.qZA(),e.TgZ(2,"form",17)(3,"mat-dialog-content")(4,"mat-form-field",18)(5,"mat-label"),e._uU(6,"Name"),e.qZA(),e._UZ(7,"input",19),e.qZA()(),e.TgZ(8,"mat-dialog-actions")(9,"button",20),e._uU(10,"Cancel"),e.qZA(),e.TgZ(11,"button",21),e._uU(12,"Save"),e.qZA()()()),2&a){const t=e.oxw();e.xp6(1),e.Oqu(t.dialogTitle),e.xp6(1),e.Q6J("formGroup",t.dialogForm),e.xp6(7),e.Q6J("mat-dialog-close",null),e.xp6(2),e.Q6J("mat-dialog-close",t.dialogForm.controls.name.value)("disabled",t.dialogForm.invalid)}}const K=a=>!!a.children;let pe=(()=>{class a extends((0,T.j)(L.A)){constructor(t,n){super(),this.dialog=t,this.store=n,this.selectedNodeId=null,this.nodeClick=new e.vpe,this.tree=this.repositoryBookmarks.pipe((0,C.U)(o=>o.map(i=>this.convertBookmarkToNode(i,"")))),this.dialogTitle="New Folder",this.dialogForm=new l.cw({name:new l.NI(null)}),this.dialogRef=null,this.addNode=(o,i,d,m)=>{(0,x.D)([this.repositoryNames.pipe((0,c.q)(1)),this.repositoryBookmarks.pipe((0,c.q)(1))]).subscribe(([h,N])=>{const b={name:h[o],repositoryId:o},H=this.replaceBookmark(N,i,"",U=>{if("above"===d)return[b,U];if("below"===d)return[U,b];if(m||!this.isBookmarkFolder(U))throw new Error(`Position '${d}' not valid for drag onto tree leaf node. Should be either 'above' or 'below'.`);return[{...U,expanded:!0,children:[...U.children,b]}]});if(!H)throw new Error(`Couldn't find node with id '${i}'.`);this.store.dispatch(new u.c9(H))})},this.dragoverListener=o=>{o.dataTransfer?.types.includes("app/repository")&&(o.preventDefault(),o.dataTransfer.dropEffect="move")},this.dropListener=o=>{if(o.dataTransfer?.types.includes("app/repository")){o.preventDefault();const i=o.dataTransfer.getData("app/repository");(0,x.D)([this.repositoryNames.pipe((0,c.q)(1)),this.repositoryBookmarks.pipe((0,c.q)(1))]).subscribe(([d,m])=>{this.store.dispatch(new u.c9([{name:d[i],repositoryId:i}]))})}},this.convertBookmarkToNode=(o,i)=>this.isBookmarkFolder(o)?{id:`folder:${this.getPath(o,i)}`,name:o.name,children:o.children.map(d=>this.convertBookmarkToNode(d,this.getPath(o,i))),expanded:o.expanded}:{id:o.repositoryId,name:o.name},this.convertNodeToBookmark=o=>K(o)?{name:o.name,expanded:o.expanded??!1,children:o.children.map(this.convertNodeToBookmark)}:{name:o.name,repositoryId:o.id}}ngOnDestroy(){super.ngOnDestroy(),this.dialogRef&&this.dialogRef.close()}treeChanged(t){this.store.dispatch(new u.c9(t.map(this.convertNodeToBookmark)))}toggleMenu(t,n){t.stopPropagation();const o=t.currentTarget.getBoundingClientRect();n.toggleMenu(o.x,o.y+o.height)}addFolder(t){this.dialogRef&&this.dialogRef.close(),this.dialogTitle="New Folder",this.dialogForm.reset(),this.dialogRef=this.dialog.open(this.dialogTemplate),this.dialogRef.afterClosed().pipe((0,B.R)(this.destroyed$)).subscribe(n=>{n&&this.repositoryBookmarks.pipe((0,c.q)(1)).subscribe(o=>{const i={name:n,children:[],expanded:!1},d=t?this.replaceBookmark(o,t,"",m=>{if(!this.isBookmarkFolder(m))throw new Error(`Cannot add folder to non-folder bookmark '${t}'.`);return[{...m,children:[...m.children,i]}]}):[...o,i];if(!d)throw new Error(`Couldn't find node with id '${t}'.`);this.store.dispatch(new u.c9(d))})})}deleteNode(t){this.repositoryBookmarks.pipe((0,c.q)(1)).subscribe(n=>{const o=this.replaceBookmark(n,t.id,"",()=>[]);if(!o)throw new Error(`Couldn't find node with id '${t.id}'.`);this.store.dispatch(new u.c9(o))})}renameFolder(t){if(!K(t))throw new Error(`Cannot rename leaf node '${t.id}'.`);this.dialogTitle="Rename Folder",this.dialogForm.reset({name:t.name}),this.dialog.open(this.dialogTemplate).afterClosed().pipe((0,B.R)(this.destroyed$)).subscribe(n=>{n&&this.repositoryBookmarks.pipe((0,c.q)(1)).subscribe(o=>{const i=this.replaceBookmark(o,t.id,"",d=>[{...d,name:n}]);if(!i)throw new Error(`Couldn't find node with id '${t.id}'.`);this.store.dispatch(new u.c9(i))})})}isBookmarkFolder(t){return!!t.children}replaceBookmark(t,n,o,i){for(let d=0;d<t.length;d++){const m=t[d];if(n===(this.isBookmarkFolder(m)?`folder:${this.getPath(m,o)}`:m.repositoryId))return[...t.slice(0,d),...i(t[d]),...t.slice(d+1)];if(this.isBookmarkFolder(m)){const h=this.replaceBookmark(m.children,n,this.getPath(m,o),i);if(h)return[...t.slice(0,d),{...m,children:h},...t.slice(d+1)]}}return null}getPath(t,n){return n?`${n}///${t.name.replace("/","//")}`:t.name.replace("/","//")}static{this.\u0275fac=function(n){return new(n||a)(e.Y36(p.uw),e.Y36(P.yh))}}static{this.\u0275cmp=e.Xpm({type:a,selectors:[["app-repository-bookmarks-view"]],viewQuery:function(n,o){if(1&n&&e.Gf(ee,5),2&n){let i;e.iGM(i=e.CRH())&&(o.dialogTemplate=i.first)}},inputs:{selectedNodeId:"selectedNodeId"},outputs:{nodeClick:"nodeClick"},features:[e.qOj],decls:7,vars:3,consts:[[4,"ngIf"],["type","button","mat-stroked-button","","matTooltip","Add folder",1,"add-folder-button",3,"click"],["dialogTemplate",""],[3,"tree","dragListeners","treeChange"],["class","bookmark-node",3,"appContextMenu","selected","click",4,"appTreeNode"],["class","bookmark-node",3,"appContextMenu","selected","matTooltip","click",4,"appTreeLeafNode"],["class","first-drag-zone","draggable","true",3,"dragover","drop",4,"ngIf"],[1,"bookmark-node",3,"appContextMenu","click"],["contextMenu","appContextMenu"],[1,"folder-icon"],["type","button","mat-icon-button","",1,"expand-button","app-icon-button-md"],["menu",""],[1,"menu-panel"],[1,"menu-item",3,"click"],[1,"bookmark-node",3,"appContextMenu","matTooltip","click"],["draggable","true",1,"first-drag-zone",3,"dragover","drop"],["mat-dialog-title",""],[3,"formGroup"],["subscriptSizing","dynamic",1,"full-width"],["type","text","matInput","","required","","formControlName","name"],["mat-button","",3,"mat-dialog-close"],["mat-flat-button","","type","submit","color","primary",3,"mat-dialog-close","disabled"]],template:function(n,o){1&n&&(e.YNc(0,ce,5,7,"ng-container",0),e.ALo(1,"async"),e.TgZ(2,"button",1),e.NdJ("click",function(){return o.addFolder()}),e.TgZ(3,"mat-icon"),e._uU(4,"create_new_folder"),e.qZA()(),e.YNc(5,le,13,5,"ng-template",null,2,e.W1O)),2&n&&e.Q6J("ngIf",e.lcZ(1,1,o.tree))},dependencies:[p.ZT,p.uh,p.xY,p.H8,k.KE,k.hX,g.Nt,_.O5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.sg,l.u,f.lW,f.RK,D.Hw,w.gM,J.l,Z,A,R,_.Ov],styles:["app-tree[_ngcontent-%COMP%]{display:block;margin-left:-8px}app-tree[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{vertical-align:middle}app-tree[_ngcontent-%COMP%]   .bookmark-node[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:space-between;padding-left:10px}app-tree[_ngcontent-%COMP%]   .bookmark-node.selected[_ngcontent-%COMP%]{background:#78909c}app-tree[_ngcontent-%COMP%]   .bookmark-node[_ngcontent-%COMP%]   .folder-icon[_ngcontent-%COMP%]{margin-right:5px}.first-drag-zone[_ngcontent-%COMP%]{height:50px}.full-width[_ngcontent-%COMP%]{width:100%}.menu-panel[_ngcontent-%COMP%]{background:#424242;border-radius:4px;box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f;max-height:calc(100vh - 48px);max-width:25vw;min-height:48px;min-width:112px;overflow-x:hidden;overflow-y:auto}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{background:transparent;border:none;color:#fff;cursor:pointer;display:flex;font-family:MontserratVariable;font-size:16px;height:48px;line-height:48px;max-width:100%;outline:none;overflow:hidden;padding:0 16px;user-select:none;text-align:left;text-overflow:ellipsis;width:100%;white-space:nowrap;align-items:center}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:first-child{border-radius:4px 4px 0 0}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:last-child{border-radius:0 0 4px 4px}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:hover{background:#565656}.menu-panel[_ngcontent-%COMP%]   .menu-item[disabled][_ngcontent-%COMP%]{pointer-events:none;color:#ffffff4d}.menu-panel[_ngcontent-%COMP%]   .menu-item.bold[_ngcontent-%COMP%]{font-weight:700}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin:12px 16px 12px 0;vertical-align:middle;flex:0 0 auto}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]   .mat-icon.expand-icon[_ngcontent-%COMP%]{margin-left:auto;margin-right:0}.menu-panel[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{vertical-align:middle;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.menu-panel.sub-menu-1[_ngcontent-%COMP%]{background:#4a4a4a}.add-folder-button[_ngcontent-%COMP%]{margin-top:10px}"],changeDetection:0})}}return(0,v.gn)([(0,P.Ph)(y.E.repositoryBookmarks)],a.prototype,"repositoryBookmarks",void 0),(0,v.gn)([(0,P.Ph)(y.E.repositoryNames)],a.prototype,"repositoryNames",void 0),a})()},6093:(F,M,s)=>{s.d(M,{i:()=>c});var v=s(5412),e=s(9549),l=s(284),P=s(8255),x=s(3179),C=s(4650);class c{static{this.\u0275fac=function(L){return new(L||c)}}static{this.\u0275mod=C.oAB({type:c})}static{this.\u0275inj=C.cJS({imports:[v.Is,e.lN,l.c,P.Tx,x.I]})}}},5174:(F,M,s)=>{s.d(M,{J:()=>y});var v=s(655),e=s(4650),l=s(9867),P=s(9646),x=s(4889),C=s(6966),c=s(6895),B=s(4859),T=s(7392),L=s(266);function u(p,k){if(1&p){const g=e.EpF();e.TgZ(0,"li",1),e.NdJ("click",function(){const D=e.CHM(g).$implicit,w=e.oxw();return e.KtG(w.clicked.next(D.repositoryId))})("dblclick",function(){const D=e.CHM(g).$implicit,w=e.oxw();return e.KtG(w.openRepository(D.repositoryId))})("dragstart",function(f){const w=e.CHM(g).$implicit,J=e.oxw();return e.KtG(J.dragStarted.next([f,w.repositoryId]))}),e.ALo(1,"async"),e._uU(2),e.TgZ(3,"button",2),e.NdJ("click",function(f){const w=e.CHM(g).$implicit;return e.oxw().deleteRepository(w.repositoryId),f.preventDefault(),e.KtG(f.stopPropagation())}),e.TgZ(4,"mat-icon",3),e._uU(5,"close"),e.qZA()()()}if(2&p){const g=k.$implicit,_=e.oxw();e.ekj("selected",g.repositoryId===e.lcZ(1,5,_.selectedId)),e.Q6J("matTooltip",g.repositoryId),e.uIk("draggable",_.draggable?"true":"false"),e.xp6(2),e.hij(" ",g.name," ")}}let y=(()=>{class p{constructor(g){this.store=g,this.draggable=!0,this.selectedId=(0,P.of)(null),this.clicked=new e.vpe,this.dragStarted=new e.vpe}openRepository(g){this.store.dispatch(new x.he(g))}deleteRepository(g){this.store.dispatch(new x.eo(g))}static{this.\u0275fac=function(_){return new(_||p)(e.Y36(l.yh))}}static{this.\u0275cmp=e.Xpm({type:p,selectors:[["app-repository-history-view"]],inputs:{draggable:"draggable",selectedId:"selectedId"},outputs:{clicked:"clicked",dragStarted:"dragStarted"},decls:3,vars:3,consts:[[3,"matTooltip","selected","click","dblclick","dragstart",4,"ngFor","ngForOf"],[3,"matTooltip","click","dblclick","dragstart"],["mat-icon-button","","color","warn","matTooltip","Remove repository (all settings saved in Glint will be removed)",1,"close-icon",3,"click"],["inline",""]],template:function(_,f){1&_&&(e.TgZ(0,"ul"),e.YNc(1,u,6,7,"li",0),e.ALo(2,"async"),e.qZA()),2&_&&(e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,f.recentRepositories)))},dependencies:[c.sg,B.RK,T.Hw,L.gM,c.Ov],styles:["ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:5px 0;cursor:pointer}ul[_ngcontent-%COMP%] > li.selected[_ngcontent-%COMP%]{background:#78909c}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{float:right;width:20px;height:20px;padding:0;font-size:18px;opacity:0;transition:opacity .1s ease-in-out}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{line-height:20px}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover   .close-icon[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0})}}return(0,v.gn)([(0,l.Ph)(C.E.recentRepositories)],p.prototype,"recentRepositories",void 0),p})()},3612:(F,M,s)=>{s.d(M,{e:()=>l});var v=s(3179),e=s(4650);class l{static{this.\u0275fac=function(C){return new(C||l)}}static{this.\u0275mod=e.oAB({type:l})}static{this.\u0275inj=e.cJS({imports:[v.I]})}}}}]);